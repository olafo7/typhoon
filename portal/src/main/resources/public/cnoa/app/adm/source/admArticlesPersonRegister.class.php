<?php//decode by qq2859470class admArticlesPersonRegister extends model{    private $table = "adm_articles_register";    private $tableProduct = "adm_articles_product";    private $tableType = "adm_articles_type";    private $tableLibrary = "adm_articles_library";    private $tableRegisterPermit = "adm_articles_register_permit";    private $tableRecord = "adm_articles_record";    private $rows = 15;    public function run( )    {        $_obfuscate_M_5JJwÿÿ = getpar( $_GET, "task" );        if ( $_obfuscate_M_5JJwÿÿ == "loadPage" )        {            global $CNOA_CONTROLLER;            $GLOBALS['GLOBALS']['app']['from'] = getpar( $_GET, "from", "" );            $_obfuscate_BxoH_SjRHQÿÿ = $CNOA_CONTROLLER->appPath."/tpl/default/articles/info_articles_person_register.htm";            $CNOA_CONTROLLER->loadExtraTpl( $_obfuscate_BxoH_SjRHQÿÿ );            exit( );        }        if ( $_obfuscate_M_5JJwÿÿ == "getArticlesLibraryList" )        {            $this->_getArticlesLibraryList( );        }        else if ( $_obfuscate_M_5JJwÿÿ == "getArticlesTypelList" )        {            $this->_getArticlesTypelList( );        }        else if ( $_obfuscate_M_5JJwÿÿ == "getArticlesProductlList" )        {            $this->_getArticlesProductlList( );        }        else if ( $_obfuscate_M_5JJwÿÿ == "add" )        {            $this->_add( );        }        else if ( $_obfuscate_M_5JJwÿÿ == "list" )        {            $this->_list( );        }        else if ( $_obfuscate_M_5JJwÿÿ == "deleteApplic" )        {            $this->_deleteApplic( );        }        else if ( $_obfuscate_M_5JJwÿÿ == "finishTask" )        {            $this->_finishTask( );        }        else if ( $_obfuscate_M_5JJwÿÿ == "getAllUserListsInPermitDeptTree" )        {            $GLOBALS['GLOBALS']['user']['permitArea']['area'] = "all";            $_obfuscate_phKp89pDgwQÿ = app::loadapp( "main", "user" )->api_getAllUserListsInPermitDeptTree( );            echo json_encode( $_obfuscate_phKp89pDgwQÿ );            exit( );        }        else if ( $_obfuscate_M_5JJwÿÿ == "myProductList" )        {            $this->_myProductList;        }    }    private function _add( )    {        global $CNOA_DB;        global $CNOA_SESSION;        $_obfuscate_6RYLWQÿÿ['type'] = getpar( $_POST, "type" );        $_obfuscate_6RYLWQÿÿ['libraryID'] = getpar( $_POST, "libraryID" );        $_obfuscate_6RYLWQÿÿ['quantity'] = getpar( $_POST, "quantity" );        if ( $_obfuscate_6RYLWQÿÿ['type'] != 1 )        {            $_obfuscate_6RYLWQÿÿ['productID'] = getpar( $_POST, "productID" );            $_obfuscate_hc0nzjWpowÿÿ = $this->__getProduct( $_obfuscate_6RYLWQÿÿ['productID'] );            if ( $_obfuscate_hc0nzjWpowÿÿ['stock'] < $_obfuscate_6RYLWQÿÿ['quantity'] && $_obfuscate_6RYLWQÿÿ['type'] != 1 )            {                msg::callback( FALSE, lang( "stockNumBuZu" ) );            }        }        else        {            $_obfuscate_fdpE = getpar( $_POST, "productID" );            $_obfuscate_o5fQ1gÿÿ = $CNOA_DB->db_getone( array( "quantity", "productID" ), $this->table, "WHERE id=".$_obfuscate_fdpE );            $_obfuscate_hc0nzjWpowÿÿ = $this->__getProduct( $_obfuscate_o5fQ1gÿÿ['productID'] );            $_obfuscate_6RYLWQÿÿ['productID'] = $_obfuscate_o5fQ1gÿÿ['productID'];            $_obfuscate_Ybai = $CNOA_DB->db_sum( "quantity", $this->table, "WHERE fid=".$_obfuscate_fdpE );            $_obfuscate_lWk5hHye = $_obfuscate_o5fQ1gÿÿ['quantity'] - $_obfuscate_Ybai;            if ( $_obfuscate_lWk5hHye < $_obfuscate_6RYLWQÿÿ['quantity'] )            {                msg::callback( FALSE, lang( "numTooBig" ) );            }        }        $_obfuscate_6RYLWQÿÿ['typeID'] = getpar( $_POST, "typeID" );        $_obfuscate_6RYLWQÿÿ['signInId'] = $CNOA_SESSION->get( "UID" );        $_obfuscate__Wi6396IheAÿ = $CNOA_SESSION->get( "TRUENAME" );        $_obfuscate_6RYLWQÿÿ['checkID'] = $_obfuscate_hc0nzjWpowÿÿ['checkID'];        $_obfuscate_6RYLWQÿÿ['notes'] = getpar( $_POST, "notes" );        $_obfuscate_6RYLWQÿÿ['signInTime'] = $GLOBALS['CNOA_TIMESTAMP'];        $_obfuscate_5taMAzQRukÿ = $CNOA_DB->db_insert( $_obfuscate_6RYLWQÿÿ, $this->table );        $_obfuscate_3umuFHrAlwczOQÿÿ = notice::add( $_obfuscate_hc0nzjWpowÿÿ['checkID'], lang( "suppliesAppMgr" ), lang( "article" ).( "[".$_obfuscate_hc0nzjWpowÿÿ['name']."]" ).lang( "needYouApproval" ), "index.php?app=adm&func=articles&action=register&task=loadPage", "", 10, $_obfuscate_5taMAzQRukÿ );        $_obfuscate_uUiVF8XuCwÿÿ = $this->__getLibraryN( $_obfuscate_6RYLWQÿÿ['libraryID'] );        $_obfuscate_LeS8hwÿÿ = $this->__getTypeN( $_obfuscate_6RYLWQÿÿ['typeID'] );        $_obfuscate_gb3bCas1['touid'] = $_obfuscate_hc0nzjWpowÿÿ['checkID'];        $_obfuscate_gb3bCas1['from'] = 10;        $_obfuscate_gb3bCas1['fromid'] = $_obfuscate_5taMAzQRukÿ;        $_obfuscate_gb3bCas1['href'] = "index.php?app=adm&func=articles&action=register&task=loadPage";        $_obfuscate_gb3bCas1['title'] = "[".$_obfuscate_hc0nzjWpowÿÿ['name']."]".lang( "article" )."ï¼".lang( "needYouApproval" ).",".lang( "submitter" ).": [".$_obfuscate__Wi6396IheAÿ."]";        $_obfuscate_gb3bCas1['content'] = lang( "housr" ).( "[".$_obfuscate_uUiVF8XuCwÿÿ."] " ).lang( "sort" ).( "[".$_obfuscate_LeS8hwÿÿ."]" );        if ( !empty( $_obfuscate_6RYLWQÿÿ['notes'] ) )        {            $_obfuscate_gb3bCas1['content'] .= "  ".lang( "submitterNote" ).( ": ".$_obfuscate_6RYLWQÿÿ['notes'] );        }        $_obfuscate_gb3bCas1['funname'] = lang( "articleMgr" );        $_obfuscate_gb3bCas1['move'] = lang( "approval2" );        $_obfuscate_Z9Q9tYdcvqMÿ = notice::add2( $_obfuscate_gb3bCas1 );        $CNOA_DB->db_update( array(            "noticeid_c" => $_obfuscate_3umuFHrAlwczOQÿÿ,            "todoid_c" => $_obfuscate_Z9Q9tYdcvqMÿ        ), $this->table, "WHERE `id` = '".$_obfuscate_5taMAzQRukÿ."' " );        if ( $_obfuscate_6RYLWQÿÿ['type'] == 1 )        {            $CNOA_DB->db_update( array(                "fid" => $_obfuscate_fdpE            ), $this->table, "WHERE `id` = '".$_obfuscate_5taMAzQRukÿ."'" );        }        app::loadapp( "main", "systemLogs" )->api_addLogs( "add", 119, $_obfuscate_hc0nzjWpowÿÿ['name'], lang( "personalProRegRecord" ) );        msg::callback( TRUE, lang( "successopt" ) );    }    private function __getLibraryN( $_obfuscate_0W8ÿ )    {        global $CNOA_DB;        $_obfuscate_3gn_eQÿÿ = $CNOA_DB->db_getfield( "name", $this->tableLibrary, "WHERE `id` = '".$_obfuscate_0W8ÿ."' " );        return $_obfuscate_3gn_eQÿÿ;    }    private function __getTypeN( $_obfuscate_0W8ÿ )    {        global $CNOA_DB;        $_obfuscate_3gn_eQÿÿ = $CNOA_DB->db_getfield( "name", $this->tableType, "WHERE `id` = '".$_obfuscate_0W8ÿ."' " );        return $_obfuscate_3gn_eQÿÿ;    }    private function _list( )    {        global $CNOA_DB;        global $CNOA_SESSION;        $_obfuscate_0W8ÿ = $CNOA_SESSION->get( "UID" );        $_obfuscate_mV9HBLYÿ = getpar( $_POST, "start", 0 );        $_obfuscate_Bj089LCE6qL = getpar( $_POST, "storeType", "waiting" );        $j = getpar( $_POST, "sortType", "" );        $_obfuscate_3gn_eQÿÿ = getpar( $_POST, "name", "" );        $_obfuscate_At2mDyyhngNl = getpar( $_POST, "signstime", 0 );        $_obfuscate_PSh5j4FCb0Y = getpar( $_POST, "signetime", 0 );        $_obfuscate_BGMu_8OT43_FqQÿÿ = getpar( $_POST, "signpeople", 0 );        $_obfuscate_VG7b6OPW8T5JHwÿÿ = getpar( $_POST, "transstime", 0 );        $_obfuscate_Na6DxxoQ9g8wÿÿ = getpar( $_POST, "transetime", 0 );        $_obfuscate_EHTyrwlsoHkgrWYÿ = getpar( $_POST, "transpeople", 0 );        $_obfuscate_Bk2lGlkÿ = "WHERE 1 ";        if ( $_obfuscate_Bj089LCE6qL == "waiting" )        {            $_obfuscate_Bk2lGlkÿ .= "AND `status`=0 ";        }        else if ( $_obfuscate_Bj089LCE6qL == "pass" )        {            $_obfuscate_Bk2lGlkÿ .= "AND `status`=2 ";        }        else if ( $_obfuscate_Bj089LCE6qL == "unpass" )        {            $_obfuscate_Bk2lGlkÿ .= "AND `status`=1 ";        }        else if ( $_obfuscate_Bj089LCE6qL == "drop" )        {            $_obfuscate_Bk2lGlkÿ .= "AND `status`=3 ";        }        else if ( $_obfuscate_Bj089LCE6qL == "transing" )        {            $_obfuscate_Bk2lGlkÿ .= "AND `transportStatus`=1 ";        }        if ( $j == "borrow" )        {            $_obfuscate_Bk2lGlkÿ .= "AND `type`=2 ";        }        else if ( $j == "lead" )        {            $_obfuscate_Bk2lGlkÿ .= "AND `type`=3 ";        }        else if ( $j == "return" )        {            $_obfuscate_Bk2lGlkÿ .= "AND `type`=1 ";        }        if ( !empty( $_obfuscate_3gn_eQÿÿ ) )        {            $_obfuscate_SeV31Qÿÿ = $CNOA_DB->db_select( array( "id" ), $this->tableProduct, "WHERE `name` LIKE '%".$_obfuscate_3gn_eQÿÿ."%'" );            if ( !is_array( $_obfuscate_SeV31Qÿÿ ) )            {                $_obfuscate_SeV31Qÿÿ = array( );            }            if ( empty( $_obfuscate_SeV31Qÿÿ ) )            {                $_obfuscate_Bk2lGlkÿ .= "AND `productID`=0 ";            }            else            {                foreach ( $_obfuscate_SeV31Qÿÿ as $_obfuscate_5wÿÿ => $_obfuscate_6Aÿÿ )                {                    $_obfuscate_O6QLLacÿ[] = $_obfuscate_6Aÿÿ['id'];                }                $_obfuscate_Bk2lGlkÿ .= "AND `productID` IN (".implode( ",", $_obfuscate_O6QLLacÿ ).") ";            }        }        if ( !empty( $_obfuscate_At2mDyyhngNl ) )        {            $_obfuscate_At2mDyyhngNl = strtotime( $_obfuscate_At2mDyyhngNl." 00:00:00" );            $_obfuscate_Bk2lGlkÿ .= "AND `signInTime`>'".$_obfuscate_At2mDyyhngNl."' ";        }        if ( !empty( $_obfuscate_PSh5j4FCb0Y ) )        {            $_obfuscate_PSh5j4FCb0Y = strtotime( $_obfuscate_PSh5j4FCb0Y." 23:59:59" );            $_obfuscate_Bk2lGlkÿ .= "AND  `signInTime`<'".$_obfuscate_PSh5j4FCb0Y."' ";        }        if ( !empty( $_obfuscate_BGMu_8OT43_FqQÿÿ ) )        {            $_obfuscate_Bk2lGlkÿ .= "AND `signInID`='".$_obfuscate_BGMu_8OT43_FqQÿÿ."' ";        }        if ( !empty( $_obfuscate_VG7b6OPW8T5JHwÿÿ ) )        {            $_obfuscate_VG7b6OPW8T5JHwÿÿ = strtotime( $_obfuscate_VG7b6OPW8T5JHwÿÿ." 00:00:00" );            $_obfuscate_Bk2lGlkÿ .= "AND `transportTime`>'".$_obfuscate_VG7b6OPW8T5JHwÿÿ."' ";        }        if ( !empty( $_obfuscate_Na6DxxoQ9g8wÿÿ ) )        {            $_obfuscate_Na6DxxoQ9g8wÿÿ = strtotime( $_obfuscate_Na6DxxoQ9g8wÿÿ." 23:59:59" );            $_obfuscate_Bk2lGlkÿ .= "AND `transportTime`<'".$_obfuscate_Na6DxxoQ9g8wÿÿ."' ";        }        if ( !empty( $_obfuscate_EHTyrwlsoHkgrWYÿ ) )        {            $_obfuscate_Bk2lGlkÿ .= "AND `transportID`='".$_obfuscate_EHTyrwlsoHkgrWYÿ."' ";        }        $_obfuscate_mPAjEGLn = $CNOA_DB->db_select( "*", $this->table, $_obfuscate_Bk2lGlkÿ.( "AND `signInID`='".$_obfuscate_0W8ÿ."' ORDER BY `id` DESC LIMIT {$_obfuscate_mV9HBLYÿ}, {$this->rows}" ) );        if ( !is_array( $_obfuscate_mPAjEGLn ) )        {            $_obfuscate_mPAjEGLn = array( );        }        $_obfuscate_6RYLWQÿÿ = array( );        foreach ( $_obfuscate_mPAjEGLn as $_obfuscate_6Aÿÿ )        {            $_obfuscate_fMfsswÿÿ = $this->__getProduct( $_obfuscate_6Aÿÿ['productID'] );            $_obfuscate_fMfsswÿÿ['id'] = $_obfuscate_6Aÿÿ['id'];            $_obfuscate_fMfsswÿÿ['type'] = $this->__formatType( $_obfuscate_6Aÿÿ['type'] );            $_obfuscate_fMfsswÿÿ['quantity'] = $_obfuscate_6Aÿÿ['quantity'];            $_obfuscate_fMfsswÿÿ['status'] = $_obfuscate_6Aÿÿ['status'];            $_obfuscate_fMfsswÿÿ['statusName'] = $this->__formatStatus( $_obfuscate_6Aÿÿ['status'] );            $_obfuscate_fMfsswÿÿ['checkName'] = $this->__takeUserName( $_obfuscate_6Aÿÿ['checkID'] );            $_obfuscate_fMfsswÿÿ['transportName'] = $this->__takeUserName( $_obfuscate_6Aÿÿ['transportID'] );            $_obfuscate_fMfsswÿÿ['signInTime'] = $this->__formateDate( $_obfuscate_6Aÿÿ['signInTime'] );            $_obfuscate_fMfsswÿÿ['transportTime'] = $this->__formateDate( $_obfuscate_6Aÿÿ['transportTime'] );            $_obfuscate_fMfsswÿÿ['transportStatus'] = $_obfuscate_6Aÿÿ['transportStatus'];            $_obfuscate_fMfsswÿÿ['signInStatus'] = $_obfuscate_6Aÿÿ['signInStatus'];            $_obfuscate_fMfsswÿÿ['typect'] = $_obfuscate_6Aÿÿ['type'];            $_obfuscate_fMfsswÿÿ['explain'] = $_obfuscate_6Aÿÿ['explain'];            $_obfuscate_6RYLWQÿÿ[] = $_obfuscate_fMfsswÿÿ;        }        ( );        $_obfuscate_SUjPN94Er7yI = new dataStore( );        $_obfuscate_SUjPN94Er7yI->data = $_obfuscate_6RYLWQÿÿ;        $_obfuscate_SUjPN94Er7yI->total = $CNOA_DB->db_getcount( $this->table, $_obfuscate_Bk2lGlkÿ.( "AND `signInID`='".$_obfuscate_0W8ÿ."'" ) );        echo $_obfuscate_SUjPN94Er7yI->makeJsonData( );        exit( );    }    private function _finishTask( )    {        global $CNOA_DB;        $_obfuscate_0W8ÿ = getpar( $_POST, "id", 0 );        $_obfuscate_c6UELgÿÿ = $GLOBALS['CNOA_TIMESTAMP'];        $CNOA_DB->db_update( array(            "signInStatus" => 1,            "transportStatus" => 2,            "finishTime" => $_obfuscate_c6UELgÿÿ        ), $this->table, "WHERE `id`='".$_obfuscate_0W8ÿ."'" );        $_obfuscate_fMfsswÿÿ = $CNOA_DB->db_getone( array( "noticeid_r", "todoid_r" ), $this->table, "WHERE `id` = '".$_obfuscate_0W8ÿ."' " );        notice::donen( $_obfuscate_fMfsswÿÿ['noticeid_r'] );        notice::donet( $_obfuscate_fMfsswÿÿ['todoid_r'] );        notice::end( $_obfuscate_0W8ÿ, 10 );        $_obfuscate_fMfsswÿÿ = $CNOA_DB->db_getone( array( "noticeid_r", "todoid_r" ), $this->table, "WHERE `id` = '".$_obfuscate_0W8ÿ."' " );        notice::donen( $_obfuscate_fMfsswÿÿ['noticeid_r'] );        notice::donet( $_obfuscate_fMfsswÿÿ['todoid_r'] );        notice::end( $_obfuscate_0W8ÿ, 10 );        msg::callback( TRUE, lang( "successopt" ) );    }    private function __formateDate( $_obfuscate_VrGwowIeHgÿÿ )    {        if ( $_obfuscate_VrGwowIeHgÿÿ == 0 )        {            return "";        }        return date( "Y-m-d", $_obfuscate_VrGwowIeHgÿÿ );    }    private function _deleteApplic( )    {        global $CNOA_DB;        $_obfuscate_0W8ÿ = getpar( $_POST, "id" );        $CNOA_DB->db_update( array( "status" => 3 ), $this->table, "WHERE `id`='".$_obfuscate_0W8ÿ."'" );        $_obfuscate_Thgÿ = $CNOA_DB->db_getone( "*", $this->table, "WHERE `id` = '".$_obfuscate_0W8ÿ."' " );        notice::deletenotice( $_obfuscate_Thgÿ['noticeid_c'], $_obfuscate_Thgÿ['todoid_c'] );        $_obfuscate_3gn_eQÿÿ = $CNOA_DB->db_getfield( "name", $this->tableProduct, "WHERE `id` = '".$_obfuscate_Thgÿ['productID']."' " );        app::loadapp( "main", "systemLogs" )->api_addLogs( "del", 119, $_obfuscate_3gn_eQÿÿ, lang( "personalItemApp" ) );        msg::callback( TRUE, lang( "successopt" ) );    }    private function __getProduct( $_obfuscate_0W8ÿ )    {        global $CNOA_DB;        $_obfuscate_mPAjEGLn = $CNOA_DB->db_getone( "*", $this->tableProduct, "WHERE `id`='".$_obfuscate_0W8ÿ."'" );        return $_obfuscate_mPAjEGLn;    }    private function __formatType( $_obfuscate_VgKtFegÿ )    {        if ( $_obfuscate_VgKtFegÿ == 3 )        {            return lang( "consuming" );        }        if ( $_obfuscate_VgKtFegÿ == 2 )        {            return lang( "borrowing" );        }        if ( $_obfuscate_VgKtFegÿ == 1 )        {            return lang( "restitution" );        }    }    private function __formatStatus( $_obfuscate_VgKtFegÿ )    {        if ( $_obfuscate_VgKtFegÿ == 3 )        {            return "<span class='cnoa_color_gray'>".lang( "obsolete" )."</span>";        }        if ( $_obfuscate_VgKtFegÿ == 2 )        {            return "<span class='cnoa_color_green'>".lang( "pass" )."</span>";        }        if ( $_obfuscate_VgKtFegÿ == 1 )        {            return "<span class='cnoa_color_red'>".lang( "unPass" )."</span>";        }        return lang( "pendingTrial" );    }    private function _getArticlesLibraryList( )    {        global $CNOA_DB;        global $CNOA_SESSION;        $_obfuscate_fMfsswÿÿ = app::loadapp( "adm", "articlesLibrary" )->api_getAllArticlesLibraryList( );        if ( !is_array( $_obfuscate_fMfsswÿÿ ) )        {            $_obfuscate_fMfsswÿÿ = array( );        }        foreach ( $_obfuscate_fMfsswÿÿ as $_obfuscate_6Aÿÿ )        {            $_obfuscate_6RYLWQÿÿ[] = $_obfuscate_6Aÿÿ;        }        ( );        $_obfuscate_SUjPN94Er7yI = new dataStore( );        $_obfuscate_SUjPN94Er7yI->total = 0;        $_obfuscate_SUjPN94Er7yI->data = $_obfuscate_6RYLWQÿÿ;        echo $_obfuscate_SUjPN94Er7yI->makeJsonData( );        exit( );    }    private function _getArticlesTypelList( )    {        global $CNOA_DB;        global $CNOA_SESSION;        $_obfuscate_QZIBbNuIPMYL = getpar( $_POST, "id" );        $_obfuscate_0W8ÿ = $CNOA_SESSION->get( "UID" );        $_obfuscate_mPAjEGLn = $CNOA_DB->db_select( "*", $this->tableType, "WHERE `libraryID`='".$_obfuscate_QZIBbNuIPMYL."'" );        if ( !is_array( $_obfuscate_mPAjEGLn ) )        {            $_obfuscate_mPAjEGLn = array( );        }        foreach ( $_obfuscate_mPAjEGLn as $_obfuscate_5wÿÿ => $_obfuscate_6Aÿÿ )        {            $_obfuscate_mPAjEGLn[$_obfuscate_5wÿÿ]['typeID'] = $_obfuscate_6Aÿÿ['id'];        }        if ( !is_array( $_obfuscate_mPAjEGLn ) )        {            $_obfuscate_mPAjEGLn = array( );        }        ( );        $_obfuscate_SUjPN94Er7yI = new dataStore( );        $_obfuscate_SUjPN94Er7yI->total = 0;        $_obfuscate_SUjPN94Er7yI->data = $_obfuscate_mPAjEGLn;        echo $_obfuscate_SUjPN94Er7yI->makeJsonData( );        exit( );    }    private function _getArticlesProductlList( )    {        global $CNOA_DB;        global $CNOA_SESSION;        $_obfuscate_QZIBbNuIPMYL = getpar( $_POST, "libraryID", "" );        $_obfuscate_vRW8EuAs = getpar( $_POST, "typeID", "" );        $_obfuscate_5x8q6XPVhTPY = getpar( $_POST, "applyType", "" );        $_obfuscate_7Ri3 = $CNOA_SESSION->get( "UID" );        if ( empty( $_obfuscate_5x8q6XPVhTPY ) )        {            $_obfuscate_Bk2lGlkÿ = "WHERE 1 ";            exit( );        }        if ( $_obfuscate_5x8q6XPVhTPY == 2 || $_obfuscate_5x8q6XPVhTPY == 3 )        {            $_obfuscate_Bk2lGlkÿ = "WHERE `applyType`=".$_obfuscate_5x8q6XPVhTPY." ";            if ( !empty( $_obfuscate_QZIBbNuIPMYL ) )            {                $_obfuscate_Bk2lGlkÿ .= "AND `libraryID`='".$_obfuscate_QZIBbNuIPMYL."' ";            }            if ( !empty( $_obfuscate_vRW8EuAs ) )            {                $_obfuscate_Bk2lGlkÿ .= "AND `typeID`='".$_obfuscate_vRW8EuAs."' ";            }            $_obfuscate_mPAjEGLn = $CNOA_DB->db_select( array( "productID" ), $this->tableRegisterPermit, "WHERE `uid`=".$_obfuscate_7Ri3." OR `uid`=0" );            if ( !is_array( $_obfuscate_mPAjEGLn ) )            {                $_obfuscate_mPAjEGLn = array( );            }            $_obfuscate_Yk1fA86z6s7A = array( );            foreach ( $_obfuscate_mPAjEGLn as $_obfuscate_6Aÿÿ )            {                $_obfuscate_Yk1fA86z6s7A[] = $_obfuscate_6Aÿÿ['productID'];            }            if ( !empty( $_obfuscate_Yk1fA86z6s7A ) )            {                $_obfuscate_Yk1fA86z6s7A = implode( ",", $_obfuscate_Yk1fA86z6s7A );                $_obfuscate_Bk2lGlkÿ .= "AND `id` IN (".$_obfuscate_Yk1fA86z6s7A.") ";            }            $_obfuscate_MufWzlvl = $CNOA_DB->db_select( "*", $this->tableProduct, $_obfuscate_Bk2lGlkÿ );            if ( !is_array( $_obfuscate_MufWzlvl ) )            {                $_obfuscate_MufWzlvl = array( );            }            $_obfuscate_fMfsswÿÿ = app::loadapp( "adm", "articlesInfo" )->_formatList( $_obfuscate_MufWzlvl );            $_obfuscate_6RYLWQÿÿ = array( );            foreach ( $_obfuscate_fMfsswÿÿ as $_obfuscate_5wÿÿ => $_obfuscate_6Aÿÿ )            {                $_obfuscate_6Aÿÿ['stock'] = strip_tags( $_obfuscate_6Aÿÿ['stock'] );                $_obfuscate_6Aÿÿ['stock'] = empty( $_obfuscate_6Aÿÿ['stock'] ) ? "0" : $_obfuscate_6Aÿÿ['stock'];                $_obfuscate_6Aÿÿ['name'] = $_obfuscate_6Aÿÿ['name']." / ".lang( "stock" ).":".$_obfuscate_6Aÿÿ['stock'].$_obfuscate_6Aÿÿ['unit'];                $_obfuscate_6RYLWQÿÿ[] = array(                    "productID" => $_obfuscate_6Aÿÿ['id'],                    "name" => $_obfuscate_6Aÿÿ['name']                );            }            ( );            $_obfuscate_SUjPN94Er7yI = new dataStore( );            $_obfuscate_SUjPN94Er7yI->data = $_obfuscate_6RYLWQÿÿ;            echo $_obfuscate_SUjPN94Er7yI->makeJsonData( );            exit( );        }        if ( $_obfuscate_5x8q6XPVhTPY == 1 )        {            $_obfuscate_Bk2lGlkÿ = "WHERE `signInID`='".$_obfuscate_7Ri3."' ";            if ( !empty( $_obfuscate_QZIBbNuIPMYL ) )            {                $_obfuscate_Bk2lGlkÿ .= "AND `libraryID`='".$_obfuscate_QZIBbNuIPMYL."' ";            }            if ( !empty( $_obfuscate_vRW8EuAs ) )            {                $_obfuscate_Bk2lGlkÿ .= "AND `typeID`='".$_obfuscate_vRW8EuAs."' ";            }            $_obfuscate_1jUa = $CNOA_DB->db_select( array( "id" ), $this->tableProduct );            if ( !is_array( $_obfuscate_1jUa ) )            {                $_obfuscate_1jUa = array( );            }            $_obfuscate_Yk1fA86z6s7A = array( );            foreach ( $_obfuscate_1jUa as $_obfuscate_snMÿ )            {                $_obfuscate_Yk1fA86z6s7A[] = $_obfuscate_snMÿ['id'];            }            if ( !empty( $_obfuscate_Yk1fA86z6s7A ) )            {                $_obfuscate_Yk1fA86z6s7A = implode( ",", $_obfuscate_Yk1fA86z6s7A );                $_obfuscate_Bk2lGlkÿ .= "AND `productID` IN (".$_obfuscate_Yk1fA86z6s7A.") ";            }            $_obfuscate_MufWzlvl = $CNOA_DB->db_select( "*", $this->table, $_obfuscate_Bk2lGlkÿ );            foreach ( $_obfuscate_MufWzlvl as $_obfuscate_5wÿÿ => $_obfuscate_6Aÿÿ )            {                if ( !( $_obfuscate_6Aÿÿ['type'] != 1 ) && !( $_obfuscate_6Aÿÿ['status'] == 2 ) && !( $_obfuscate_6Aÿÿ['signInStatus'] == 1 ) && !( $_obfuscate_6Aÿÿ['transportStatus'] == 2 ) )                {                    $_obfuscate_o5fQ1gÿÿ = $CNOA_DB->db_getone( array( "name", "unit" ), $this->tableProduct, "WHERE `id`='".$_obfuscate_6Aÿÿ['productID']."'" );                    $_obfuscate_Ybai = $CNOA_DB->db_sum( "quantity", $this->table, "WHERE fid=".$_obfuscate_6Aÿÿ['id'] );                    $_obfuscate_lWk5hHye = $_obfuscate_6Aÿÿ['quantity'] - $_obfuscate_Ybai;                    $_obfuscate_3gn_eQÿÿ = $_obfuscate_o5fQ1gÿÿ['name']." /".lang( "registerTime" ).":".date( "Y-m-d", $_obfuscate_6Aÿÿ['signInTime'] )." / ".lang( "needReturn" ).":".$_obfuscate_lWk5hHye.$_obfuscate_o5fQ1gÿÿ['unit'];                    if ( $_obfuscate_lWk5hHye != 0 )                    {                        $_obfuscate_6RYLWQÿÿ[] = array(                            "productID" => $_obfuscate_6Aÿÿ['id'],                            "name" => $_obfuscate_3gn_eQÿÿ                        );                    }                }            }            ( );            $_obfuscate_SUjPN94Er7yI = new dataStore( );            $_obfuscate_SUjPN94Er7yI->data = $_obfuscate_6RYLWQÿÿ;            echo $_obfuscate_SUjPN94Er7yI->makeJsonData( );        }        exit( );    }    private function __getProductUnique( $_obfuscate_0W8ÿ )    {        global $CNOA_DB;        $_obfuscate_mPAjEGLn = $CNOA_DB->db_getone( array( "name", "stock", "unit" ), $this->tableProduct, "WHERE `id`='".$_obfuscate_0W8ÿ."'" );        return $_obfuscate_mPAjEGLn;    }    private function __takeUserName( $_obfuscate_0W8ÿ )    {        $_obfuscate_6RYLWQÿÿ = app::loadapp( "main", "user" )->api_getUserDataByUid( $_obfuscate_0W8ÿ );        return $_obfuscate_6RYLWQÿÿ['truename'];    }    public function api_getList( $_obfuscate_5x8q6XPVhTPY )    {        global $CNOA_DB;        global $CNOA_SESSION;        $_obfuscate_QZIBbNuIPMYL = getpar( $_POST, "libraryid", "" );        $_obfuscate_vRW8EuAs = getpar( $_POST, "sortid", "" );        $_obfuscate_obqvewÿÿ = getpar( $_POST, "title", "" );        $_obfuscate_mV9HBLYÿ = getpar( $_GET, "start", getpar( $_POST, "start", 0 ) );        $_obfuscate_xvYeh9Iÿ = getpagesize( "wf_engine_admarticles" );        $_obfuscate_7Ri3 = $CNOA_SESSION->get( "UID" );        $_obfuscate_Bk2lGlkÿ = empty( $_obfuscate_5x8q6XPVhTPY ) ? "WHERE 1 " : "WHERE `applyType`=".$_obfuscate_5x8q6XPVhTPY." ";        if ( !empty( $_obfuscate_obqvewAÿ ) )        {            $_obfuscate_Bk2lGlkÿ .= "AND `name` LIKE '%".$_obfuscate_obqvewÿÿ."%' ";        }        if ( !empty( $_obfuscate_QZIBbNuIPMYL ) )        {            $_obfuscate_Bk2lGlkÿ .= "AND `libraryID`='".$_obfuscate_QZIBbNuIPMYL."' ";        }        if ( !empty( $_obfuscate_vRW8EuAs ) )        {            $_obfuscate_Bk2lGlkÿ .= "AND `typeID`='".$_obfuscate_vRW8EuAs."' ";        }        $_obfuscate_mPAjEGLn = $CNOA_DB->db_select( array( "productID" ), $this->tableRegisterPermit, "WHERE `uid`=".$_obfuscate_7Ri3." || `uid`=0" );        if ( !is_array( $_obfuscate_mPAjEGLn ) )        {            $_obfuscate_mPAjEGLn = array( );        }        $_obfuscate_Yk1fA86z6s7A = array( );        foreach ( $_obfuscate_mPAjEGLn as $_obfuscate_6Aÿÿ )        {            $_obfuscate_Yk1fA86z6s7A[] = $_obfuscate_6Aÿÿ['productID'];        }        if ( !empty( $_obfuscate_Yk1fA86z6s7A ) )        {            $_obfuscate_Yk1fA86z6s7A = implode( ",", $_obfuscate_Yk1fA86z6s7A );            $_obfuscate_Bk2lGlkÿ .= "AND `id` IN (".$_obfuscate_Yk1fA86z6s7A.") ";        }        $_obfuscate_gftfagwÿ = $CNOA_DB->db_getcount( $this->tableProduct, $_obfuscate_Bk2lGlkÿ );        $_obfuscate_Bk2lGlkÿ .= "LIMIT ".$_obfuscate_mV9HBLYÿ.", {$_obfuscate_xvYeh9Iÿ}";        $_obfuscate_MufWzlvl = $CNOA_DB->db_select( "*", $this->tableProduct, $_obfuscate_Bk2lGlkÿ );        if ( !is_array( $_obfuscate_MufWzlvl ) )        {            $_obfuscate_MufWzlvl = array( );        }        $_obfuscate_fMfsswÿÿ = app::loadapp( "adm", "articlesInfo" )->_formatList( $_obfuscate_MufWzlvl );        foreach ( $_obfuscate_fMfsswÿÿ as $_obfuscate_5wÿÿ => $_obfuscate_6Aÿÿ )        {            $_obfuscate_fMfsswÿÿ[$_obfuscate_5wÿÿ]['stock'] = strip_tags( $_obfuscate_6Aÿÿ['stock'] );        }        ( );        $_obfuscate_SUjPN94Er7yI = new dataStore( );        $_obfuscate_SUjPN94Er7yI->data = $_obfuscate_fMfsswÿÿ;        $_obfuscate_SUjPN94Er7yI->total = $_obfuscate_gftfagwÿ;        echo $_obfuscate_SUjPN94Er7yI->makeJsonData( );        exit( );    }    public function api_getLibrary( )    {        global $CNOA_SESSION;        $_obfuscate_fMfsswÿÿ = app::loadapp( "adm", "articlesLibrary" )->api_getAllArticlesLibraryListByPermit( $CNOA_SESSION->get( "UID" ) );        ( );        $_obfuscate_SUjPN94Er7yI = new dataStore( );        $_obfuscate_SUjPN94Er7yI->total = 0;        $_obfuscate_SUjPN94Er7yI->data = $_obfuscate_fMfsswÿÿ;        echo $_obfuscate_SUjPN94Er7yI->makeJsonData( );        exit( );    }    public function api_getType( )    {        global $CNOA_DB;        global $CNOA_SESSION;        $_obfuscate_0W8ÿ = getpar( $_POST, "id", 0 );        if ( $_obfuscate_0W8ÿ == 0 )        {            ( );            $_obfuscate_SUjPN94Er7yI = new dataStore( );            $_obfuscate_SUjPN94Er7yI->total = 0;            $_obfuscate_SUjPN94Er7yI->data = array( );            echo $_obfuscate_SUjPN94Er7yI->makeJsonData( );            exit( );        }        $_obfuscate_mPAjEGLn = $CNOA_DB->db_select( "*", $this->tableType, "WHERE `libraryID`=".$_obfuscate_0W8ÿ );        if ( !is_array( $_obfuscate_mPAjEGLn ) )        {            $_obfuscate_mPAjEGLn = array( );        }        $_obfuscate_fMfsswÿÿ = array( );        foreach ( $_obfuscate_mPAjEGLn as $_obfuscate_5wÿÿ => $_obfuscate_6Aÿÿ )        {            $_obfuscate_fMfsswÿÿ[$_obfuscate_5wÿÿ]['typeID'] = $_obfuscate_6Aÿÿ['id'];            $_obfuscate_fMfsswÿÿ[$_obfuscate_5wÿÿ]['name'] = $_obfuscate_6Aÿÿ['name'];            $_obfuscate_fMfsswÿÿ[$_obfuscate_5wÿÿ]['libraryID'] = $_obfuscate_6Aÿÿ['libraryID'];        }        ( );        $_obfuscate_SUjPN94Er7yI = new dataStore( );        $_obfuscate_SUjPN94Er7yI->total = 0;        $_obfuscate_SUjPN94Er7yI->data = $_obfuscate_fMfsswÿÿ;        echo $_obfuscate_SUjPN94Er7yI->makeJsonData( );        exit( );    }}?>