<?php//decode by qq2859470class abutmentAbutmentDatabase extends abutmentAbutment{    public function run( )    {        global $CNOA_SESSION;        $_obfuscate_M_5JJwÿÿ = getpar( $_GET, "task", "loadPage" );        switch ( $_obfuscate_M_5JJwÿÿ )        {        case "loadPage" :            global $CNOA_CONTROLLER;            $_obfuscate_BxoH_SjRHQÿÿ = $CNOA_CONTROLLER->appPath."/tpl/default/abutment_database.htm";            $CNOA_CONTROLLER->loadExtraTpl( $_obfuscate_BxoH_SjRHQÿÿ );            break;        case "saveDatabase" :            $this->_saveDatabase( );            break;        case "getDatabase" :            $this->_getDatabase( );            break;        case "deleteAbutment" :            $this->_deleteAbutment( );            break;        case "testConnect" :            $this->testConnect( );            break;        case "createLocalDB" :            $this->_createLocalDB( );        }    }    private function _saveDatabase( )    {        global $CNOA_DB;        global $CNOA_XXTEA;        $_obfuscate_0W8ÿ = getpar( $_POST, "id" );        $_obfuscate_6RYLWQÿÿ = array( );        $_obfuscate_6RYLWQÿÿ['name'] = getpar( $_POST, "name" );        $_obfuscate_gftfagwÿ = $CNOA_DB->db_getcount( "abutment_database", "WHERE `name`=\"".$_obfuscate_6RYLWQÿÿ['name']."\"".( empty( $_obfuscate_0W8ÿ ) ? "" : " AND `id`!=".$_obfuscate_0W8ÿ ) );        if ( 0 < $_obfuscate_gftfagwÿ )        {            msg::callback( FALSE, "åç§°å·²å­å¨" );        }        $_obfuscate_6RYLWQÿÿ['host'] = getpar( $_POST, "host" );        $_obfuscate_6RYLWQÿÿ['dbname'] = getpar( $_POST, "dbname" );        $_obfuscate_gftfagwÿ = $CNOA_DB->db_getcount( "abutment_database", "WHERE `dbname`=\"".$_obfuscate_6RYLWQÿÿ['dbname']."\" AND `host`=\"".$_obfuscate_6RYLWQÿÿ['host']."\"".( empty( $_obfuscate_0W8ÿ ) ? "" : " AND `id`!=".$_obfuscate_0W8ÿ ) );        if ( 0 < $_obfuscate_gftfagwÿ )        {            msg::callback( FALSE, "æéæ°æ®åºå·²å­å¨" );        }        $_obfuscate_6RYLWQÿÿ['chart'] = getpar( $_POST, "chart" );        $_obfuscate_6RYLWQÿÿ['dbType'] = getpar( $_POST, "dbType" );        $_obfuscate_6RYLWQÿÿ['user'] = getpar( $_POST, "user" );        $_obfuscate_6RYLWQÿÿ['password'] = getpar( $_POST, "password" );        if ( empty( $_obfuscate_6RYLWQÿÿ['password'] ) )        {            unset( $_obfuscate_6RYLWQÿÿ['password'] );        }        else        {            $_obfuscate_6RYLWQÿÿ['password'] = $CNOA_XXTEA->encrypt( serialize( array(                "PASSWORD" => $_obfuscate_6RYLWQÿÿ['password'],                "TIME" => time( )            ) ) );        }        if ( !empty( $_obfuscate_0W8ÿ ) )        {            $CNOA_DB->db_update( $_obfuscate_6RYLWQÿÿ, "abutment_database", "WHERE `id`=".$_obfuscate_0W8ÿ );        }        else        {            $_obfuscate_0W8ÿ = $CNOA_DB->db_insert( $_obfuscate_6RYLWQÿÿ, "abutment_database" );        }        if ( $_obfuscate_0W8ÿ )        {            msg::callback( TRUE, "æä½æåï¼" );        }        else        {            msg::callback( FALSE, "æä½å¤±è´¥ï¼" );        }    }    private function _getDatabase( )    {        global $CNOA_DB;        global $CNOA_XXTEA;        $_obfuscate_6RYLWQÿÿ = $CNOA_DB->db_select( array( "id", "name", "dbname", "host", "dbType", "chart", "user" ), "abutment_database", "WHERE 1" );        if ( !is_array( $_obfuscate_6RYLWQÿÿ ) )        {            $_obfuscate_6RYLWQÿÿ = array( );        }        ( );        $_obfuscate_NlQÿ = new DataStore( );        $_obfuscate_NlQÿ->data = $_obfuscate_6RYLWQÿÿ;        echo $_obfuscate_NlQÿ->makeJsonData( );    }    private function _deleteAbutment( )    {        global $CNOA_DB;        $_obfuscate_0W8ÿ = getpar( $_POST, "id", 0 );        $_obfuscate_gftfagwÿ = $CNOA_DB->db_getcount( "abutment_datasheet", "WHERE `sid`=".$_obfuscate_0W8ÿ );        if ( 0 < $_obfuscate_gftfagwÿ )        {            msg::callback( FALSE, "å­å¨ä½¿ç¨æ­¤æ°æ®æºçè¡¨ï¼è¯·åå é¤" );        }        $_obfuscate_gftfagwÿ = $CNOA_DB->db_getcount( "abutment_sqldetail", "WHERE `databaseId`=".$_obfuscate_0W8ÿ );        if ( 0 < $_obfuscate_gftfagwÿ )        {            msg::callback( FALSE, "å­å¨ä½¿ç¨æ­¤æ°æ®æºçèªå®ä¹æç»è¡¨ï¼è¯·åå é¤" );        }        $_obfuscate_gftfagwÿ = $CNOA_DB->db_getcount( "abutment_sqlselector", "WHERE `databaseId`=".$_obfuscate_0W8ÿ );        if ( 0 < $_obfuscate_gftfagwÿ )        {            msg::callback( FALSE, "å­å¨ä½¿ç¨æ­¤æ°æ®æºçSQLéæ©å¨ï¼è¯·åå é¤" );        }        $CNOA_DB->db_delete( "abutment_database", "WHERE `id`=".$_obfuscate_0W8ÿ );        msg::callback( TRUE, "æä½æåï¼" );    }    private function _createLocalDB( )    {        global $CNOA_DB;        global $CNOA_XXTEA;        $_obfuscate_6RYLWQÿÿ = array(            "name" => "æ¬å°æ°æ®åº",            "dbType" => "MYSQL",            "chart" => "UTF8",            "dbname" => CNOA_DB_NAME,            "host" => CNOA_DB_HOST,            "user" => CNOA_DB_USER,            "password" => CNOA_DB_PWD        );        $_obfuscate_6RYLWQÿÿ['password'] = $CNOA_XXTEA->encrypt( serialize( array(            "PASSWORD" => $_obfuscate_6RYLWQÿÿ['password'],            "TIME" => time( )        ) ) );        $CNOA_DB->db_insert( $_obfuscate_6RYLWQÿÿ, "abutment_database" );        msg::callback( TRUE, "æä½æåï¼" );    }}?>