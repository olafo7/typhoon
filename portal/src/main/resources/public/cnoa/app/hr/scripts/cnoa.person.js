var CNOA_hr_person_field,CNOA_hr_person_fieldClass;CNOA_hr_person_fieldClass=new CNOA.Class.create();CNOA_hr_person_fieldClass.prototype={init:function(){var a=this;this.baseUrl="index.php?app=hr&func=person&action=field";this.custom=a.custom();this.mainPanel=new Ext.Panel({border:false,layout:"fit",items:[this.custom]})},custom:function(){var f=this;var b=[{name:"fieldid"},{name:"fieldvalue"},{name:"fieldtype"},{name:"items"},{name:"add"},{name:"show"},{name:"must"}];var c=Ext.id();var d=function(i){if(i==" "){return""}checked=i==1?"checked":"";return'<input type="checkbox" '+checked+"  />"};var h=new Ext.grid.CheckboxSelectionModel();var a=new Ext.grid.ColumnModel({border:false,defaults:{sortable:true,menuDisabled:true,width:130},columns:[new Ext.grid.RowNumberer(),h,{header:"fieldid",dataIndex:"fieldid",hidden:true,width:80},{header:lang("fieldName"),dataIndex:"fieldvalue"},{header:lang("type"),dataIndex:"fieldtype"},{header:lang("optionSet"),dataIndex:"items",editor:new Ext.form.TextArea({allowBlank:false}),renderer:function(j,i){i.attr='style="white-space:normal;"';return j}},{header:lang("areListDisplay"),dataIndex:"show",renderer:d},{header:lang("areEditDisplay"),dataIndex:"add",renderer:d},{header:lang("ifRequired"),dataIndex:"must",renderer:d}]});this.store=new Ext.data.Store({autoLoad:true,proxy:new Ext.data.HttpProxy({url:f.baseUrl+"&task=getJsonData",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:b}),listeners:{exception:function(n,m,o,l,j){var k=j.responseText;if(k!=""){var i=Ext.decode(k);if(i.failure){CNOA.msg.alert(i.msg)}}}}});var g=new Ext.PagingToolbar({style:"border-left-width:1px;",displayInfo:true,store:f.store,pageSize:15});var e=new Ext.grid.EditorGridPanel({border:false,region:"center",store:f.store,bodyStyle:"border-left-width:1px;",cm:a,sm:h,bbar:g,tbar:new Ext.Toolbar({items:[{xtype:"button",text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(){f.store.reload()}},{text:lang("add"),iconCls:"icon-utils-s-add",handler:function(){f.addCustom()}},{text:lang("del"),iconCls:"icon-utils-s-delete",handler:function(i){var j=e.getSelectionModel().getSelections();if(j.length==0){CNOA.miniMsg.alertShowAt(i,lang("mustSelectOneRow"))}else{CNOA.msg.cf(lang("confirmToDelete"),function(k){if(k=="yes"){var m=[];Ext.each(j,function(o,n){m.push("c"+o.json.fieldid)});var l=m.join(",");f.delCustom(l)}})}}}]}),listeners:{afteredit:function(l){var j=l.field,i=l.record.get("fieldid"),k=l.value;l.record.set("");f.editCustom(i,j,k)},cellclick:function(k,n,l){var m=k.getColumnModel().getDataIndex(l);if(m=="add"||"show"||"must"){var j=k.getStore().getAt(n),i=j.get("fieldid");oldValue=j.get(m);value=$(k.getView().getCell(n,l)).find("input").attr("checked");if(value==undefined||value==oldValue){return}value=value?1:0;f.editCustom(i,m,value)}},beforeedit:function(j){var i=j.record.json.type;if(j.field=="items"&&i!=6&&i!=8){return false}}}});return e},editCustom:function(a,d,c){var b=this;Ext.Ajax.request({url:b.baseUrl+"&task=edit",method:"POST",params:{fieldid:a,fieldname:d,value:c},success:function(e){var f=Ext.decode(e.responseText);if(f.success){CNOA.msg.notice2(f.msg)}else{CNOA.msg.alert(f.msg)}b.store.reload()}})},addCustom:function(){var b=this;var e=Ext.id();var a=new Ext.FormPanel({width:340,border:false,height:260,items:[{xtype:"fieldset",width:300,height:250,border:false,labelWidth:120,labelAlign:"right",defaults:{width:155},items:[{xtype:"textfield",allowBlank:false,fieldLabel:lang("fieldName"),name:"fieldvalue",id:e},{xtype:"combo",fieldLabel:lang("fieldType"),hiddenName:"fieldtype",typeAhead:true,triggerAction:"all",editable:false,mode:"local",allowBlank:false,valueField:"fieldtype",displayField:"fieldtypeName",store:new Ext.data.Store({autoLoad:true,proxy:new Ext.data.HttpProxy({url:b.baseUrl+"&task=getFieldType"}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:[{name:"fieldtype"},{name:"fieldtypeName"}]})}),listeners:{select:function(i,f,h){var g=i.nextSibling(),j=parseInt(f.get("fieldtype"));if(j==6||j==8){g.show();g.setDisabled(false)}else{g.hide();g.setDisabled(true)}}}},{xtype:"compositefield",fieldLabel:lang("optionSet"),hidden:true,items:[{xtype:"textarea",name:"items",allowBlank:false,width:120},{xtype:"label",html:'<span style="color:red;">'+lang("optionSeparated")+"</span>"}]},{fieldLabel:lang("areListDisplay"),xtype:"radiogroup",items:[{boxLabel:lang("yes"),name:"show",inputValue:1,checked:true},{boxLabel:lang("no"),name:"show",inputValue:0}]},{fieldLabel:lang("areEditDisplay"),xtype:"radiogroup",items:[{boxLabel:lang("yes"),name:"add",inputValue:1,checked:true},{boxLabel:lang("no"),name:"add",inputValue:0}]},{fieldLabel:lang("ifRequired"),xtype:"radiogroup",items:[{boxLabel:lang("yes"),name:"must",inputValue:1,checked:true},{boxLabel:lang("no"),name:"must",inputValue:0}]}]}]});var c=function(){if(a.getForm().isValid()){a.getForm().submit({url:b.baseUrl+"&task=addCustom",method:"POST",success:function(f,g){CNOA.msg.notice2(g.result.msg);b.store.load();d.close()},failure:function(f,g){CNOA.msg.alert(g.result.msg)}})}};var d=new Ext.Window({title:lang("addCustomField"),width:350,height:320,modal:true,items:[a],buttons:[{text:lang("submit"),handler:function(){c()}},{text:lang("cancel"),handler:function(){d.close()}}]});d.show()},delCustom:function(b){var a=this;Ext.Ajax.request({url:a.baseUrl+"&task=delete",params:{fieldids:b},success:function(c){a.store.reload()}})}};var CNOA_hr_person_fixField,CNOA_hr_person_fixFieldClass;CNOA_hr_person_fixFieldClass=new CNOA.Class.create();CNOA_hr_person_fixFieldClass.prototype={init:function(){var a=this;this.baseUrl="index.php?app=hr&func=person&action=fixfield";this.fix=this.fix();this.mainPanel=new Ext.Panel({border:false,layout:"fit",items:[this.fix]})},fix:function(){var f=this;var b=[{name:"fixid"},{name:"fixname"},{name:"show"},{name:"order"}];var c=Ext.id();var d=function(h){if(h==" "){return""}checked=h==1?"checked":"";return'<input type="checkbox" '+checked+"  />"};var a=new Ext.grid.ColumnModel({border:false,defaults:{sortable:true,menuDisabled:true,width:130},columns:[new Ext.grid.RowNumberer(),{header:"fixid",dataIndex:"fixid",hidden:true,width:80},{header:lang("fieldName"),dataIndex:"fixname"},{header:lang("areListDisplay"),dataIndex:"show",renderer:d},{header:lang("order"),dataIndex:"order",editor:true}]});this.store=new Ext.data.Store({autoLoad:true,proxy:new Ext.data.HttpProxy({url:f.baseUrl+"&task=getJsonData",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:b}),listeners:{exception:function(m,l,n,k,i){var j=i.responseText;if(j!=""){var h=Ext.decode(j);if(h.failure){CNOA.msg.alert(h.msg)}}}}});var g=new Ext.PagingToolbar({plugins:[new Ext.grid.plugins.ComboPageSize()],style:"border-left-width:1px;",displayInfo:true,emptyMsg:lang("pagingToolbarEmptyMsg"),displayMsg:lang("showDataTotal2"),store:f.store,pageSize:15});var e=new Ext.grid.EditorGridPanel({border:false,region:"center",store:f.store,bodyStyle:"border-left-width:1px;",cm:a,bbar:g,tbar:new Ext.Toolbar({items:[{xtype:"button",text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(){f.store.reload()}}]}),listeners:{cellclick:function(j,m,k){var l=j.getColumnModel().getDataIndex(k);if(l=="show"){var i=j.getStore().getAt(m),h=i.get("fixid");oldValue=i.get(l);value=$(j.getView().getCell(m,k)).find("input").attr("checked");if(value==undefined||value==oldValue){return}value=value?1:0;f.editFix(h,l,value)}},afteredit:function(i){var j=i.record.get("fixid"),h=i.record.get("order");Ext.Ajax.request({url:f.baseUrl+"&task=order",method:"POST",params:{fixid:j,value:h},success:function(k){var l=Ext.decode(k.responseText);if(l.success){CNOA.msg.notice2(l.msg)}else{CNOA.msg.alert(l.msg)}f.store.reload()}})}}});return e},editFix:function(a,d,c){var b=this;Ext.Ajax.request({url:b.baseUrl+"&task=editFix",method:"POST",params:{fixid:a,fixname:d,value:c},success:function(e){var f=Ext.decode(e.responseText);if(f.success){CNOA.msg.notice2(f.msg)}else{CNOA.msg.alert(f.msg)}b.store.reload()}})}};var CNOA_hr_person_birthdayClass,CNOA_hr_person_birthday;CNOA_hr_person_birthdayClass=CNOA.Class.create();CNOA_hr_person_birthdayClass.prototype={init:function(){var f=this;var i=Ext.id();var h=Ext.id();var c=Ext.id();var g=Ext.id();var a=Ext.id();var d=Ext.id();var b=Ext.id();var e=Ext.id();this.baseUrl="index.php?app=hr&func=person&action=waiting";this.storeBar={storeType:"month",name:"",deptid:"",gender:"",s_age:"",e_age:"",s_birthday:"",e_birthday:""};this.fields=[{name:"pid"},{name:"truename"},{name:"deptment"},{name:"birthday"},{name:"age"},{name:"gender"},{name:"workStatus"},{name:"cellPhone"},{name:"operate"}];this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getJsonData",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields}),listeners:{exception:function(o,n,p,m,l,k){var j=Ext.decode(l.responseText);if(j.failure){CNOA.msg.alert(j.msg)}}}});this.store.load();this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.pagingBar=new Ext.PagingToolbar({displayInfo:true,store:this.store,pageSize:15,listeners:{beforechange:function(j,k){Ext.apply(k,f.storeBar)}}});this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),this.sm,{header:"pid",dataIndex:"pid",hidden:true},{header:lang("truename"),dataIndex:"truename",width:100,sortable:true,menuDisabled:true},{header:lang("department"),dataIndex:"deptment",width:100,sortable:true,menuDisabled:true},{header:lang("birthdayTime"),dataIndex:"birthday",width:85,sortable:true,menuDisabled:true},{header:lang("age"),dataIndex:"age",width:120,sortable:true,menuDisabled:true},{header:lang("sex"),dataIndex:"gender",width:60,sortable:true,menuDisabled:true},{header:lang("status"),dataIndex:"workStatus",width:70,sortable:true,menuDisabled:true},{header:lang("mobile"),dataIndex:"cellPhone",width:120,sortable:true,menuDisabled:true},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.list=new Ext.grid.GridPanel({stripeRows:true,region:"center",border:false,store:this.store,loadMask:{msg:lang("waiting")},cm:this.colModel,sm:this.sm,hideBorders:true,tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(j,k){f.store.reload()}},{handler:function(j,k){f.storeBar.storeType="month";f.store.load({params:f.storeBar})}.createDelegate(this),iconCls:"icon-thisMonth",cls:"btn-blue4",enableToggle:true,pressed:true,allowDepress:false,toggleGroup:"meeting_room_check",tooltip:lang("displayTheList"),text:lang("birthdayThisMonth")},{handler:function(j,k){f.storeBar.storeType="nextmonth";f.store.load({params:f.storeBar})}.createDelegate(this),iconCls:"icon-nextMonth",cls:"btn-blue3",enableToggle:true,allowDepress:false,toggleGroup:"meeting_room_check",tooltip:lang("displayNextMonth"),text:lang("birthdayNextMonth")},{text:lang("SMScontentSet"),cls:"btn-blue4",iconCls:"icon-SMS-contentSet",handler:function(j,k){f.smsWin()}.createDelegate(this)},{text:lang("sendSms"),iconCls:"icon-phone-sound",cls:"btn-red1",handler:function(j,k){CNOA.msg.cf(lang("sureSendSMS"),function(l,m){if(l=="yes"){Ext.Ajax.request({url:f.baseUrl+"&task=sendSms",method:"POST",success:function(o){var n=Ext.decode(o.responseText);if(n.success===true){CNOA.msg.notice(n.msg,lang("hrMgr"))}else{CNOA.msg.alert(n.msg)}}})}})}.createDelegate(this)},"<span class='cnoa_color_gray'>"+lang("doubleClickEdit")+"/span>","->",{xtype:"cnoa_helpBtn",helpid:4002}]});this.mainPanel=new Ext.Panel({title:lang("toDoBirthdays"),collapsible:false,hideBorders:true,border:false,layout:"border",autoScroll:false,items:[this.list],tbar:new Ext.Toolbar({style:"border-left-width:1px;",items:[(lang("truename")+":"),{xtype:"textfield",width:100,id:i},lang("department")+":",{xtype:"departmentselectorfield",name:"deptID",id:h,multiSelect:false},lang("sex")+":",new Ext.form.ComboBox({fieldLabel:lang("sex"),name:"gender",store:new Ext.data.SimpleStore({fields:["value","gender"],data:[["1",lang("male")],["2",lang("female")]]}),width:50,id:g,hiddenName:"gender",valueField:"value",displayField:"gender",mode:"local",triggerAction:"all",forceSelection:true,editable:false}),lang("ageFrom")+":",{xtype:"panel",border:false,layout:"fit",items:[{xtype:"textfield",width:50,id:a}]},lang("to")+":",{xtype:"panel",border:false,layout:"fit",items:[{xtype:"textfield",width:50,id:d}]},lang("birthday")+":",{xtype:"panel",border:false,layout:"fit",items:[{xtype:"datefield",width:120,format:"Y-m-d",id:b}]},lang("to")+":",{xtype:"panel",border:false,layout:"fit",items:[{xtype:"datefield",width:120,format:"Y-m-d",id:e}]},{xtype:"button",text:lang("search"),style:"margin-left:5px",handler:function(){f.storeBar.name=Ext.getCmp(i).getValue();f.storeBar.deptid=Ext.getCmp(h).getValue();f.storeBar.gender=Ext.getCmp(g).getValue();f.storeBar.s_age=Ext.getCmp(a).getValue();f.storeBar.e_age=Ext.getCmp(d).getValue();f.storeBar.s_birthday=Ext.getCmp(b).getRawValue();f.storeBar.e_birthday=Ext.getCmp(e).getRawValue();f.store.load({params:f.storeBar})}},{xtype:"button",text:lang("clear"),handler:function(){f.storeBar.name=Ext.getCmp(i).setValue("");f.storeBar.deptid=Ext.getCmp(h).setValue("");f.storeBar.gender=Ext.getCmp(g).setValue("");f.storeBar.s_age=Ext.getCmp(a).setValue("");f.storeBar.e_age=Ext.getCmp(d).setValue("");f.storeBar.s_birthday=Ext.getCmp(b).setValue("");f.storeBar.e_birthday=Ext.getCmp(e).setValue("");f.storeBar.name="";f.storeBar.deptid="";f.storeBar.gender="";f.storeBar.s_age="";f.storeBar.e_age="";f.storeBar.s_birthday="";f.storeBar.e_birthday="";f.store.load({params:f.storeBar})}}]})})},smsWin:function(){var f=this;var e=function(){b.getForm().load({url:f.baseUrl+"&task=editSmsData",method:"POST",waitMsg:lang("waiting"),success:function(g,h){},failure:function(g,h){}.createDelegate(this)})};var c=function(){if(b.getForm().isValid()){b.getForm().submit({url:f.baseUrl+"&task=smscontent",waitMsg:lang("waiting"),method:"POST",success:function(h,i){var g=Ext.decode(r.responseText);if(g.success===true){CNOA.msg.notice(g.msg,lang("hrMgr"));d.close()}else{CNOA.msg.alert(g.msg)}}.createDelegate(this),failure:function(g,h){CNOA.msg.alert(h.result.msg)}.createDelegate(this)})}};var a=[{xtype:"fieldset",title:lang("jobStatusAndContact")+"：",width:400,defaults:{style:{marginBottom:"10px"},border:false},items:[{xtype:"panel",layout:"form",items:[{xtype:"textarea",width:430,fieldLabel:lang("smsContent"),allowBlank:false,name:"content"},new Ext.BoxComponent({autoEl:{tag:"div",style:"margin-left:120px;margin-top:5px;margin-bottom:5px;color:#676767;",html:lang("noteAgeSMS")+"<br /><br />"+lang("forExampleSMS")+"<br /><br />"+lang("SMScontentBirthday")}})]}]}];var b=new Ext.form.FormPanel({region:"center",layout:"fit",border:false,waitMsgTarget:true,bodyStyle:"padding:10px",labelWidth:100,labelAlign:"right",items:a});var d=new Ext.Window({layout:"border",title:lang("sengSMStoBirthday"),width:630,height:300,modal:true,resizable:false,items:[b],buttons:[{text:lang("save"),handler:function(){c()}},{text:lang("close"),handler:function(){d.close()}}]}).show();e()}};var CNOA_hr_person_contractClass,CNOA_hr_person_contract;CNOA_hr_person_contractClass=CNOA.Class.create();CNOA_hr_person_contractClass.prototype={init:function(){var g=this;this.baseUrl="index.php?app=hr&func=person&action=waiting&from=contract";var d=Ext.id();var b=Ext.id();var e=Ext.id();var a=Ext.id();var c=Ext.id();var f=Ext.id();this.storeBar={storeType:"thisOver",name:"",title:"",type:"",status:"",s_time:"",e_time:""};this.fields=[{name:"id"},{name:"contractTitle"},{name:"truename"},{name:"deptment"},{name:"contractType"},{name:"contractStatus"},{name:"contractStartTime"},{name:"contractEndTime"},{name:"operate"}];this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getJsonData",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields}),listeners:{exception:function(m,l,n,k,j,i){var h=Ext.decode(j.responseText);if(h.failure){CNOA.msg.alert(h.msg)}},load:function(i,h,j){}}});this.store.load();this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.pagingBar=new Ext.PagingToolbar({displayInfo:true,store:this.store,pageSize:15,listeners:{beforechange:function(h,i){Ext.apply(i,storeBar)}}});this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),this.sm,{header:"id",dataIndex:"id",hidden:true},{header:lang("contractName"),dataIndex:"contractTitle",width:150,sortable:true,menuDisabled:true},{header:lang("truename"),dataIndex:"truename",width:80,sortable:true,menuDisabled:true},{header:lang("department"),dataIndex:"deptment",width:100,sortable:true,menuDisabled:true},{header:lang("contractType"),dataIndex:"contractType",width:100,sortable:true,menuDisabled:true},{header:lang("contractStatus"),dataIndex:"contractStatus",width:100,sortable:true,menuDisabled:true},{header:lang("enableTime"),dataIndex:"contractStartTime",width:80,sortable:true,menuDisabled:true},{header:lang("endTime"),dataIndex:"contractEndTime",width:80,sortable:true,menuDisabled:true},{header:lang("opt"),dataIndex:"id",width:120,sortable:true,menuDisabled:true,renderer:this.operate.createDelegate(this)},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.list=new Ext.grid.GridPanel({stripeRows:true,region:"center",border:false,store:this.store,loadMask:{msg:lang("waiting")},cm:this.colModel,sm:this.sm,hideBorders:true,tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(h,i){g.store.reload()}},{handler:function(h,i){g.storeBar.storeType="thisOver";g.store.load({params:g.storeBar})}.createDelegate(this),iconCls:"icon-thisMonth",enableToggle:true,pressed:true,allowDepress:false,toggleGroup:"meeting_room_check",tooltip:lang("displayOfContracts"),cls:"btn-blue4",text:lang("dQthisMonth")},{handler:function(h,i){g.storeBar.storeType="nextOver";g.store.load({params:g.storeBar})}.createDelegate(this),iconCls:"icon-nextMonth",cls:"btn-blue3",enableToggle:true,allowDepress:false,toggleGroup:"meeting_room_check",tooltip:lang("displayOfContracts1"),text:lang("dQnextMonth")},{handler:function(h,i){g.storeBar.storeType="thisActive";g.store.load({params:g.storeBar})}.createDelegate(this),iconCls:"icon-thisMonth",cls:"btn-blue2",enableToggle:true,allowDepress:false,toggleGroup:"meeting_room_check",tooltip:lang("displayEffectThis"),text:lang("thisMonthEff")},{handler:function(h,i){g.storeBar.storeType="nextActive";g.store.load({params:g.storeBar})}.createDelegate(this),iconCls:"icon-nextMonth",cls:"btn-blue2",enableToggle:true,allowDepress:false,toggleGroup:"meeting_room_check",tooltip:lang("displayEffectNext"),text:lang("nextMonthEff")},{handler:function(h,i){g.storeBar.storeType="all";g.store.load({params:g.storeBar})}.createDelegate(this),iconCls:"icon-all-contracts",cls:"btn-red1",enableToggle:true,allowDepress:false,toggleGroup:"meeting_room_check",tooltip:lang("displayAllContracts"),text:lang("allContracts")}]});this.mainPanel=new Ext.Panel({title:lang("hrContractNotice"),collapsible:false,hideBorders:true,border:false,layout:"border",autoScroll:false,items:[this.list],tbar:new Ext.Toolbar({style:"border-left-width:1px;",items:[(lang("truename")+":"),{xtype:"textfield",width:80,id:d},lang("contractName")+":",{xtype:"textfield",width:80,id:b},lang("contractType")+":",new Ext.form.ComboBox({name:"contractType",store:new Ext.data.SimpleStore({fields:["valueType","contractType"],data:[["3",lang("laborContract")],["2",lang("bMHT")],["1",lang("other")]]}),id:e,width:135,editable:true,hiddenName:"contractType",valueField:"contractType",displayField:"contractType",mode:"local",triggerAction:"all"}),lang("contractStatus")+":",new Ext.form.ComboBox({name:"contractStatus",store:new Ext.data.SimpleStore({fields:["value","contractStatus"],data:[["3",lang("onTrial")],["2",lang("yZZ")],["1",lang("yJC")]]}),id:a,width:105,hiddenName:"contractStatus",valueField:"value",displayField:"contractStatus",mode:"local",triggerAction:"all",forceSelection:true,editable:false}),lang("contractStime"),{xtype:"datefield",width:100,format:"Y-m-d",id:c},lang("contractEtime"),{xtype:"datefield",width:100,format:"Y-m-d",id:f},{text:lang("search"),style:"margin-left:5px",handler:function(){g.storeBar.name=Ext.getCmp(d).getValue();g.storeBar.title=Ext.getCmp(b).getValue();g.storeBar.type=Ext.getCmp(e).getValue();g.storeBar.status=Ext.getCmp(a).getValue();g.storeBar.s_time=Ext.getCmp(c).getRawValue();g.storeBar.e_time=Ext.getCmp(f).getRawValue();g.store.load({params:g.storeBar})}},{text:lang("clear"),style:"margin-left:5px",handler:function(){Ext.getCmp(d).setValue("");Ext.getCmp(b).setValue("");Ext.getCmp(e).setValue("");Ext.getCmp(a).setValue("");Ext.getCmp(c).setValue("");Ext.getCmp(f).setValue("");g.storeBar.name="";g.storeBar.title="";g.storeBar.type="";g.storeBar.status="";g.storeBar.s_time="";g.storeBar.e_time="";g.store.load({params:g.storeBar})}}]})})},operate:function(a){return"<a href='javascript:void(0)' class='gridview' onclick='CNOA_hr_person_contract.viewDetails("+a+")'>"+lang("view")+"</a>"},viewDetails:function(b){var a=this;x=(screen.availWidth-850)/2;y=(screen.availHeight-600)/2;window.open(a.baseUrl+"&task=loadpage&type=viewDetails&ID="+b,"contractView","width=890,height=500,left="+x+",top="+y+",scrollbars=yes,resizable=yes,status=no")}};var CNOA_hr_person_licenseClass,CNOA_hr_person_license;CNOA_hr_person_licenseClass=CNOA.Class.create();CNOA_hr_person_licenseClass.prototype={init:function(){var g=this;this.baseUrl="index.php?app=hr&func=person&action=waiting&from=license";var d=Ext.id();var b=Ext.id();var e=Ext.id();var a=Ext.id();var c=Ext.id();var f=Ext.id();this.storeBar={storeType:"thisOver",name:"",title:"",type:"",status:"",s_time:"",e_time:""};this.fields=[{name:"id"},{name:"truename"},{name:"deptment"},{name:"licenseName"},{name:"licenseNum"},{name:"licenseType"},{name:"licenseStatus"},{name:"licenseOrg"},{name:"startLicenseDate"},{name:"endLicenseDate"},{name:"operate"}];this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getJsonData",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields}),listeners:{exception:function(m,l,n,k,j,i){var h=Ext.decode(j.responseText);if(h.failure){CNOA.msg.alert(h.msg)}}}});this.store.load();this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.pagingBar=new Ext.PagingToolbar({displayInfo:true,store:this.store,pageSize:15,listeners:{beforechange:function(h,i){Ext.apply(i,storeBar)}}});this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),this.sm,{header:"id",dataIndex:"id",hidden:true},{header:lang("certificateName"),dataIndex:"licenseName",width:150,sortable:true,menuDisabled:true},{header:lang("certificateNum"),dataIndex:"licenseNum",width:120,sortable:true,menuDisabled:true},{header:lang("truename"),dataIndex:"truename",width:80,sortable:true,menuDisabled:true},{header:lang("department"),dataIndex:"deptment",width:80,sortable:true,menuDisabled:true},{header:lang("certificateType"),dataIndex:"licenseType",width:100,sortable:true,menuDisabled:true},{header:lang("certifaicateStatus"),dataIndex:"licenseStatus",width:110,sortable:true,menuDisabled:true},{header:lang("fZdepartment"),dataIndex:"licenseOrg",width:120,sortable:true,menuDisabled:true},{header:lang("enableTime"),dataIndex:"startLicenseDate",width:100,sortable:true,menuDisabled:true},{header:lang("expireTime"),dataIndex:"endLicenseDate",width:100,sortable:true,menuDisabled:true},{header:lang("opt"),dataIndex:"id",width:120,sortable:true,menuDisabled:true,renderer:this.operate.createDelegate(this)},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.list=new Ext.grid.GridPanel({stripeRows:true,region:"center",border:false,store:this.store,loadMask:{msg:lang("waiting")},cm:this.colModel,sm:this.sm,hideBorders:true,tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(h,i){g.store.reload()}},{handler:function(h,i){g.storeBar.storeType="thisOver";g.store.load({params:g.storeBar})}.createDelegate(this),iconCls:"icon-thisMonth",enableToggle:true,pressed:true,allowDepress:false,toggleGroup:"meeting_room_check",tooltip:lang("displayCertificate1"),cls:"btn-blue4",text:lang("certificateExpires1")},{handler:function(h,i){g.storeBar.storeType="nextOver";g.store.load({params:g.storeBar})}.createDelegate(this),iconCls:"icon-nextMonth",cls:"btn-blue3",enableToggle:true,allowDepress:false,toggleGroup:"meeting_room_check",tooltip:lang("displayCertificate2"),text:lang("certificateExpires2")},{handler:function(h,i){g.storeBar.storeType="thisActive";g.store.load({params:g.storeBar})}.createDelegate(this),iconCls:"icon-thisMonth",enableToggle:true,allowDepress:false,toggleGroup:"meeting_room_check",tooltip:lang("displayEffCertificate"),cls:"btn-blue2",text:lang("certificateEff")},{handler:function(h,i){g.storeBar.storeType="nextActive";g.store.load({params:g.storeBar})}.createDelegate(this),iconCls:"icon-nextMonth",enableToggle:true,allowDepress:false,toggleGroup:"meeting_room_check",cls:"btn-blue2",tooltip:lang("displayEffCertificate1"),text:lang("certificateEff1")},{handler:function(h,i){g.storeBar.storeType="all";g.store.load({params:g.storeBar})}.createDelegate(this),iconCls:"icon-all-certificates",enableToggle:true,allowDepress:false,toggleGroup:"meeting_room_check",cls:"btn-red1",tooltip:lang("showAllCertificate"),text:lang("allCertificates")}]});this.mainPanel=new Ext.Panel({title:lang("certificateMgr"),collapsible:false,hideBorders:true,border:false,layout:"border",autoScroll:false,items:[this.list],tbar:new Ext.Toolbar({style:"border-left-width:1px;",items:[(lang("truename")+":"),{xtype:"textfield",width:80,id:d},lang("certificateName")+":",{xtype:"textfield",width:80,id:b},lang("certificateType")+":",new Ext.form.ComboBox({name:"contractType",store:new Ext.data.SimpleStore({fields:["valueType","contractType"],data:[["5",lang("driverLicense")],["4",lang("healthCertificate")],["3",lang("zZZ")],["2",lang("skillCertificate")],["1",lang("other")]]}),id:e,width:100,editable:true,hiddenName:"contractType",valueField:"contractType",displayField:"contractType",mode:"local",triggerAction:"all"}),lang("certifaicateStatus")+":",new Ext.form.ComboBox({name:"contractStatus",store:new Ext.data.SimpleStore({fields:["value","contractStatus"],data:[["3",lang("noEffect")],["2",lang("active")],["1",lang("daoqi")]]}),id:a,width:100,hiddenName:"contractStatus",valueField:"value",displayField:"contractStatus",mode:"local",triggerAction:"all",forceSelection:true,editable:false}),lang("zSSXDate"),{xtype:"datefield",width:100,format:"Y-m-d",id:c},lang("certificateSXTime"),{xtype:"datefield",width:100,format:"Y-m-d",id:f},{text:lang("search"),style:"margin-left:5px",handler:function(){g.storeBar.name=Ext.getCmp(d).getValue();g.storeBar.title=Ext.getCmp(b).getValue();g.storeBar.type=Ext.getCmp(e).getValue();g.storeBar.status=Ext.getCmp(a).getValue();g.storeBar.s_time=Ext.getCmp(c).getRawValue();g.storeBar.e_time=Ext.getCmp(f).getRawValue();g.store.load({params:g.storeBar})}},{text:lang("clear"),style:"margin-left:5px",handler:function(){Ext.getCmp(d).setValue("");Ext.getCmp(b).setValue("");Ext.getCmp(e).setValue("");Ext.getCmp(a).setValue("");Ext.getCmp(c).setValue("");Ext.getCmp(f).setValue("");g.storeBar.name="";g.storeBar.title="";g.storeBar.type="";g.storeBar.status="";g.storeBar.s_time="";g.storeBar.e_time="";g.store.load({params:g.storeBar})}}]})})},operate:function(a){return"<a href='javascript:void(0)' class='gridview' onclick='CNOA_hr_person_license.viewDetails("+a+")'>"+lang("view")+"</a>"},viewDetails:function(b){var a=this;x=(screen.availWidth-850)/2;y=(screen.availHeight-600)/2;window.open(a.baseUrl+"&task=loadpage&type=viewDetails&ID="+b,"licenseView","width=890,height=500,left="+x+",top="+y+",scrollbars=yes,resizable=yes,status=no")}};var CNOA_hr_person_chartClass,CNOA_hr_person_jobstatus,CNOA_hr_person_edBackground,CNOA_hr_person_ageBracket;CNOA_hr_person_chartClass=CNOA.Class.create();CNOA_hr_person_chartClass.prototype={init:function(c,a,e,b){var d=this;this.baseUrl="index.php?app=hr&func=person&action=waiting&from=getChartData";this.center=this.centerPanel(c,a,e,b);this.mainPanel=new Ext.Panel({title:c,layout:"border",border:false,items:[this.center]})},centerPanel:function(e,c,g,d){var f=this;var a=$(window).height()*0.9;var b=new Ext.Panel({border:false,region:"center",html:"<div style='width: 100%; height: "+a+"px;' id='"+g+"'>",listeners:{afterrender:function(){Ext.Ajax.request({url:f.baseUrl+c,success:function(h){var i=Ext.decode(h.responseText);var j=new FusionCharts("scripts/fusioncharts/"+d,"myChartId"+Math.floor(Math.random()*1000+1),"100%","100%","0","1");j.setJSONData({chart:{caption:e},baseFontSize:12,bgColor:"#FFFFFF",canvasBgColor:"#FFFFFF",canvasBgAlpha:0,showPercentValues:1,data:i.data});j.render(g)}})}}});return b}};var CNOA_hr_person_waitingClass,CNOA_hr_person_waiting;CNOA_hr_person_waitingClass=CNOA.Class.create();CNOA_hr_person_waitingClass.prototype={init:function(){var a=this;CNOA_hr_person_birthday=new CNOA_hr_person_birthdayClass();CNOA_hr_person_contract=new CNOA_hr_person_contractClass();CNOA_hr_person_license=new CNOA_hr_person_licenseClass();CNOA_hr_person_jobstatus=new CNOA_hr_person_chartClass(lang("jobStatus"),"&task=jobStatus","CNOA_JOB_STATUS_CHART","Column3D.swf");CNOA_hr_person_edBackground=new CNOA_hr_person_chartClass(lang("education1"),"&task=edBackground","CNOA_ED_BG_CHART","Pie3D.swf");CNOA_hr_person_ageBracket=new CNOA_hr_person_chartClass(lang("age"),"&task=ageBracket","CNOA_AGE_BRACKET_CHART","Pie3D.swf");this.tabPerson=new Ext.ux.VerticalTabPanel({region:"center",border:false,tabPosition:"left",tabWidth:150,activeItem:0,items:[CNOA_hr_person_birthday.mainPanel,CNOA_hr_person_contract.mainPanel,CNOA_hr_person_license.mainPanel,CNOA_hr_person_jobstatus.mainPanel,CNOA_hr_person_edBackground.mainPanel,CNOA_hr_person_ageBracket.mainPanel]});this.mainPanel=new Ext.Panel({collapsible:false,hideBorders:true,border:false,layout:"border",autoScroll:false,items:[this.tabPerson]})}};var CNOA_hr_person_recoveryManageClass,CNOA_hr_person_recoveryManage;CNOA_hr_person_recoveryManageClass=CNOA.Class.create();CNOA_hr_person_recoveryManageClass.prototype={init:function(){var a=this;this.edit_id=0;this.type="addDetails";a.baseUrl="index.php?app=hr&func=person&action=manage";this.mainPanel=this.mkMainPanel()},mkMainPanel:function(){var a=this;this.fields=[{name:"id"},{name:"job"},{name:"workType"},{name:"setRecoveryDate"},{name:"cashStartDate"},{name:"recoveryDepartment"},{name:"recovery_notes"}];this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:a.baseUrl+"&task=getList&type=recovery&personID="+CNOA.hr.person.manage.addDetails.personID,disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields})});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.store.load();this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),this.sm,{header:"id",dataIndex:"id",hidden:true},{header:lang("positions"),dataIndex:"job",width:120,sortable:true,menuDisabled:true},{header:lang("fuZhiType"),dataIndex:"workType",width:125,sortable:false,menuDisabled:true},{header:lang("nFuZhiDate"),dataIndex:"setRecoveryDate",width:155,sortable:false,menuDisabled:true},{header:lang("wageHuiFu"),dataIndex:"cashStartDate",width:125,sortable:false,menuDisabled:true},{header:lang("fuZhiDept"),dataIndex:"recoveryDepartment",width:160,sortable:false,menuDisabled:true},{header:lang("opt"),dataIndex:"id",width:65,sortable:false,menuDisabled:true,renderer:this.operation},{header:lang("remark"),dataIndex:"reovery_notes",width:120,sortable:false,menuDisabled:true},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({style:"border-left-width:1px;",displayInfo:true,store:this.store,pageSize:15});this.list=new Ext.grid.GridPanel({stripeRows:true,title:lang("fuZhiMgr"),border:false,store:this.store,loadMask:{msg:lang("waiting")},cm:this.colModel,sm:this.sm,hideBorders:true,listeners:{rowdblclick:function(b,c){var d=a.list.getSelectionModel().getSelections();a.edit_id=d[0].get("id");a.viewDetails(a.edit_id)}},tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){this.store.reload()}.createDelegate(this)},{text:lang("add"),iconCls:"icon-utils-s-add",handler:function(){a.type="addDetails";a.mkAddEditPanel()}},{handler:function(b,c){var d=a.list.getSelectionModel().getSelections();if(d.length==0){CNOA.miniMsg.alertShowAt(b,lang("mustSelectOneRow"))}else{a.type="editDetails";a.edit_id=d[0].get("id");a.mkAddEditPanel()}},iconCls:"icon-utils-s-edit",text:lang("modify")},{text:lang("del"),iconCls:"icon-utils-s-delete",handler:function(b){a.deleteList(b)}},"<span class='cnoa_color_gray'>"+lang("dblClickToView")+"</span>","->",{xtype:"cnoa_helpBtn",helpid:159}],bbar:this.pagingBar});return this.list},mkAddEditPanel:function(){this.baseField=[{xtype:"fieldset",title:lang("fuZhiMgr"),defaults:{style:{marginBottom:"5px"},border:false},items:[{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"job",fieldLabel:lang("positions"),width:190}]},{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({fieldLabel:lang("fuZhiType"),name:"workType",store:new Ext.data.SimpleStore({fields:["value","workType"],data:[["2",lang("repatriation")],["1",lang("recovery")],["0","　　　　"]]}),width:190,hiddenName:"workType",valueField:"value",displayField:"workType",mode:"local",triggerAction:"all",forceSelection:true,editable:false})]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"applicationDate",fieldLabel:lang("appDate"),width:190}]},{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"setRecoveryDate",fieldLabel:lang("nFuZhiDate"),width:190}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"actualDate",fieldLabel:lang("sJFuZhiDate"),width:190}]},{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"cashStartDate",fieldLabel:lang("wageHuiFu"),width:190}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"recoveryDepartment",fieldLabel:lang("fuZhiDept"),width:190}]}]},{xtype:"textarea",name:"recoveryNotes",fieldLabel:lang("fuZhiShouXu"),width:490},{xtype:"textarea",name:"recovery_notes",fieldLabel:lang("remark"),width:490},{xtype:"flashfile",name:"document",fieldLabel:lang("addDocument"),style:"margin-top:5px;",inputPre:"filesUpload"}]}];this.formPanel=new Ext.form.FormPanel({hideBorders:true,border:false,waitMsgTarget:true,layout:"border",labelWidth:90,bodyStyle:"border-left-width:1px;",labelAlign:"right",items:[{xtype:"panel",border:false,bodyStyle:"padding:10px",layout:"form",region:"center",autoScroll:true,items:[this.baseField]}]});this.addEditWindow=new Ext.Window({layout:"fit",width:660,height:makeWindowHeight(520),title:lang("addNewReinstatement"),resizable:false,modal:true,items:[this.formPanel],buttons:[{text:lang("save"),iconCls:"icon-btn-save",handler:function(){this.submitForm()}.createDelegate(this)},{text:lang("close"),iconCls:"icon-dialog-cancel",handler:function(){this.close()}.createDelegate(this)}]});this.addEditWindow.show();if(this.type=="editDetails"){this.loadFormData()}},deleteList:function(a){var c=this;var b=this.list.getSelectionModel().getSelections();if(b.length==0){CNOA.miniMsg.alertShowAt(a,lang("mustSelectOneRow"))}else{CNOA.msg.cf(lang("confirmToDelete"),function(e){if(e=="yes"){if(b){var f="";for(var d=0;d<b.length;d++){f+=b[d].get("id")+","}c.deleteData(f)}}})}},deleteData:function(a){var b=this;Ext.Ajax.request({url:this.baseUrl+"&task=delete&type=recovery",method:"POST",params:{ids:a},success:function(d){var c=Ext.decode(d.responseText);if(c.success===true){CNOA.msg.notice(c.msg,lang("hrMgr"));b.store.reload()}else{CNOA.msg.alert(c.msg)}}})},show:function(){this.addEditWindow.show()},close:function(){this.addEditWindow.close()},operation:function(a){return"<a href='javascript:void(0)' class='gridview' onclick='CNOA_hr_person_recoveryManage.viewDetails("+a+")'>"+lang("view")+"</a>"},viewDetails:function(a){var b=this;x=(screen.availWidth-850)/2;y=(screen.availHeight-600)/2;window.open(b.baseUrl+"&task=loadPage&from=viewDetails&type=recovery&ID="+a+"&personID="+CNOA.hr.person.manage.addDetails.personID,"recoveryView","width=890,height=500,left="+x+",top="+y+",scrollbars=yes,resizable=yes,status=no")},loadFormData:function(){var a=this;this.formPanel.getForm().load({url:a.baseUrl+"&task=getList&type=recovery&edit=modify",params:{id:a.edit_id},method:"POST",waitMsg:lang("waiting"),failure:function(b,c){CNOA.msg.alert(c.result.msg,function(){a.close()})}.createDelegate(this)})},submitForm:function(){var a=this;if(a.formPanel.getForm().isValid()){a.formPanel.getForm().submit({url:a.baseUrl+"&task="+a.type+"&type=recovery&id="+a.edit_id+"&personID="+CNOA.hr.person.manage.addDetails.personID,waitMsg:lang("waiting"),method:"POST",success:function(b,c){CNOA.msg.notice(c.result.msg);this.addEditWindow.close();a.store.reload()}.createDelegate(this),failure:function(b,c){CNOA.msg.alert(c.result.msg)}.createDelegate(this)})}}};var CNOA_hr_person_leaveManageClass,CNOA_hr_person_leaveManage;CNOA_hr_person_leaveManageClass=CNOA.Class.create();CNOA_hr_person_leaveManageClass.prototype={init:function(){var a=this;this.edit_id=0;this.type="addDetails";a.baseUrl="index.php?app=hr&func=person&action=manage";this.mainPanel=this.mkMainPanel()},mkMainPanel:function(){var a=this;this.fields=[{name:"id"},{name:"job"},{name:"unworkType"},{name:"setLeaveDate"},{name:"cashStopDate"},{name:"leaveDepartment"},{name:"goWhere"},{name:"leave_notes"}];this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:a.baseUrl+"&task=getList&type=leave&personID="+CNOA.hr.person.manage.addDetails.personID,disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields})});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.store.load();this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),this.sm,{header:"id",dataIndex:"id",hidden:true},{header:lang("positions"),dataIndex:"job",width:120,sortable:true,menuDisabled:true},{header:lang("lZType"),dataIndex:"unworkType",width:90,sortable:false,menuDisabled:true},{header:lang("nLZDate"),dataIndex:"setLeaveDate",width:140,sortable:false,menuDisabled:true},{header:lang("payDate"),dataIndex:"cashStopDate",width:110,sortable:false,menuDisabled:true},{header:lang("leaveDept"),dataIndex:"leaveDepartment",width:120,sortable:false,menuDisabled:true},{header:lang("fate"),dataIndex:"goWhere",width:100,sortable:false,menuDisabled:true},{header:lang("opt"),dataIndex:"id",width:65,sortable:false,menuDisabled:true,renderer:this.operation},{header:lang("remark"),dataIndex:"leave_notes",width:120,sortable:false,menuDisabled:true},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({style:"border-left-width:1px;",displayInfo:true,store:this.store,pageSize:15});this.list=new Ext.grid.GridPanel({stripeRows:true,title:lang("leaveMgr"),border:false,store:this.store,loadMask:{msg:lang("waiting")},cm:this.colModel,sm:this.sm,hideBorders:true,listeners:{rowdblclick:function(b,c){var d=a.list.getSelectionModel().getSelections();a.edit_id=d[0].get("id");a.viewDetails(a.edit_id)}},tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){this.store.reload()}.createDelegate(this)},{text:lang("add"),iconCls:"icon-utils-s-add",handler:function(){a.type="addDetails";a.mkAddEditPanel()}},{handler:function(b,c){var d=a.list.getSelectionModel().getSelections();if(d.length==0){CNOA.miniMsg.alertShowAt(b,lang("mustSelectOneRow"))}else{a.type="editDetails";a.edit_id=d[0].get("id");a.mkAddEditPanel()}}.createDelegate(this),iconCls:"icon-utils-s-edit",text:lang("modify")},{text:lang("del"),iconCls:"icon-utils-s-delete",handler:function(b){a.deleteList(b)}},"<span class='cnoa_color_gray'>"+lang("dblClickToView")+"</span>","->",{xtype:"cnoa_helpBtn",helpid:158}],bbar:this.pagingBar});return this.list},mkAddEditPanel:function(){this.baseField=[{xtype:"fieldset",title:lang("leaveMgr"),defaults:{style:{marginBottom:"5px"},border:false},items:[{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"job",fieldLabel:lang("positions"),width:190}]},{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({fieldLabel:lang("lZType"),name:"unworkType",store:new Ext.data.SimpleStore({fields:["value","unworkType"],data:[["4",lang("resignation")],["3",lang("retire")],["2",lang("retirement")],["1",lang("secondment")],["0","　　　　"]]}),width:190,hiddenName:"unworkType",valueField:"value",displayField:"unworkType",mode:"local",triggerAction:"all",forceSelection:true,editable:false})]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"applicationDate",fieldLabel:lang("appDate"),width:190}]},{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"setLeaveDate",fieldLabel:lang("nLZDate"),width:190}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"actualDate",fieldLabel:lang("sJLZDate"),width:190}]},{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"cashStopDate",fieldLabel:lang("payDate"),width:190}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"leaveDepartment",fieldLabel:lang("leaveDept"),width:190}]}]},{xtype:"textarea",name:"goWhere",fieldLabel:lang("fate"),width:490},{xtype:"textarea",name:"leaveNotes",fieldLabel:lang("lZSXBL"),width:490},{xtype:"textarea",name:"leave_notes",fieldLabel:lang("remark"),width:490},{xtype:"flashfile",name:"document",fieldLabel:lang("addDocument"),style:"margin-top:5px;",inputPre:"filesUpload"}]}];this.formPanel=new Ext.form.FormPanel({hideBorders:true,border:false,waitMsgTarget:true,layout:"border",labelWidth:90,bodyStyle:"border-left-width:1px;",labelAlign:"right",items:[{xtype:"panel",border:false,bodyStyle:"padding:10px",layout:"form",region:"center",autoScroll:true,items:[this.baseField]}]});this.addEditWindow=new Ext.Window({layout:"fit",width:660,height:makeWindowHeight(520),title:lang("addNewLZ"),resizable:false,modal:true,items:[this.formPanel],buttons:[{text:lang("save"),iconCls:"icon-btn-save",handler:function(){this.submitForm()}.createDelegate(this)},{text:lang("close"),iconCls:"icon-dialog-cancel",handler:function(){this.close()}.createDelegate(this)}]});this.addEditWindow.show();if(this.type=="editDetails"){this.loadFormData()}},deleteList:function(a){var c=this;var b=this.list.getSelectionModel().getSelections();if(b.length==0){CNOA.miniMsg.alertShowAt(a,lang("mustSelectOneRow"))}else{CNOA.msg.cf(lang("confirmToDelete"),function(e){if(e=="yes"){if(b){var f="";for(var d=0;d<b.length;d++){f+=b[d].get("id")+","}c.deleteData(f)}}})}},deleteData:function(a){var b=this;Ext.Ajax.request({url:this.baseUrl+"&task=delete&type=leave",method:"POST",params:{ids:a},success:function(d){var c=Ext.decode(d.responseText);if(c.success===true){CNOA.msg.notice(c.msg,lang("hrMgr"));b.store.reload()}else{CNOA.msg.alert(c.msg)}}})},show:function(){this.addEditWindow.show()},close:function(){this.addEditWindow.close()},operation:function(a){return"<a href='javascript:void(0)' class='gridview' onclick='CNOA_hr_person_leaveManage.viewDetails("+a+")'>"+lang("view")+"</a>"},viewDetails:function(a){var b=this;x=(screen.availWidth-850)/2;y=(screen.availHeight-600)/2;window.open(b.baseUrl+"&task=loadPage&from=viewDetails&type=leave&ID="+a+"&personID="+CNOA.hr.person.manage.addDetails.personID,"leaveView","width=890,height=500,left="+x+",top="+y+",scrollbars=yes,resizable=yes,status=no")},loadFormData:function(){var a=this;this.formPanel.getForm().load({url:a.baseUrl+"&task=getList&type=leave&edit=modify",params:{id:a.edit_id},method:"POST",waitMsg:lang("waiting"),failure:function(b,c){CNOA.msg.alert(c.result.msg,function(){a.close()})}.createDelegate(this)})},submitForm:function(){var a=this;if(a.formPanel.getForm().isValid()){a.formPanel.getForm().submit({url:a.baseUrl+"&task="+a.type+"&type=leave&id="+a.edit_id+"&personID="+CNOA.hr.person.manage.addDetails.personID,waitMsg:lang("waiting"),method:"POST",success:function(b,c){CNOA.msg.notice(c.result.msg,lang("hrMgr"));this.addEditWindow.close();a.store.reload()}.createDelegate(this),failure:function(b,c){CNOA.msg.alert(c.result.msg)}.createDelegate(this)})}}};var CNOA_hr_person_changeManageClass,CNOA_hr_person_changeManage;CNOA_hr_person_changeManageClass=CNOA.Class.create();CNOA_hr_person_changeManageClass.prototype={init:function(){var a=this;this.edit_id=0;this.type="addDetails";a.baseUrl="index.php?app=hr&func=person&action=manage";this.mainPanel=this.mkMainPanel()},mkMainPanel:function(){var a=this;this.fields=[{name:"id"},{name:"changeLevelType"},{name:"changeDate"},{name:"changeStartDate"},{name:"changeAfterCompany"},{name:"changeAfterDept"},{name:"changeAfterJobType"},{name:"change_notes"}];this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:a.baseUrl+"&task=getList&type=change&personID="+CNOA.hr.person.manage.addDetails.personID,disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields})});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.store.load();this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),this.sm,{header:"id",dataIndex:"id",hidden:true},{header:lang("mobilizeType"),dataIndex:"changeLevelType",width:90,sortable:true,menuDisabled:true},{header:lang("monilizeDate"),dataIndex:"changeDate",width:110,sortable:false,menuDisabled:true},{header:lang("monilizeEffDate"),dataIndex:"changeStartDate",width:135,sortable:false,menuDisabled:true},{header:lang("mobilizeUnit"),dataIndex:"changeAfterCompany",width:100,sortable:false,menuDisabled:true},{header:lang("mobilizeDept"),dataIndex:"changeAfterDept",width:150,sortable:false,menuDisabled:true},{header:lang("mobilizeJob"),dataIndex:"changeAfterJobType",width:140,sortable:false,menuDisabled:true},{header:lang("opt"),dataIndex:"id",width:65,sortable:false,menuDisabled:true,renderer:this.operation},{header:lang("remark"),dataIndex:"change_notes",width:120,sortable:false,menuDisabled:true},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({style:"border-left-width:1px;",displayInfo:true,store:this.store,pageSize:15});this.list=new Ext.grid.GridPanel({stripeRows:true,title:lang("personDDGL"),border:false,store:this.store,loadMask:{msg:lang("waiting")},cm:this.colModel,sm:this.sm,hideBorders:true,listeners:{rowdblclick:function(b,c){var d=a.list.getSelectionModel().getSelections();a.edit_id=d[0].get("id");a.viewDetails(a.edit_id)}},tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){this.store.reload()}.createDelegate(this)},{text:lang("add"),iconCls:"icon-utils-s-add",handler:function(){a.type="addDetails";a.mkAddEditPanel()}},{handler:function(b,c){var d=a.list.getSelectionModel().getSelections();if(d.length==0){CNOA.miniMsg.alertShowAt(b,lang("mustSelectOneRow"))}else{a.type="editDetails";a.edit_id=d[0].get("id");a.mkAddEditPanel()}},iconCls:"icon-utils-s-edit",text:lang("modify")},{text:lang("del"),iconCls:"icon-utils-s-delete",handler:function(b){a.deleteList(b)}},"<span class='cnoa_color_gray'>"+lang("dblClickToView")+"</span>","->",{xtype:"cnoa_helpBtn",helpid:157}],bbar:this.pagingBar});return this.list},mkAddEditPanel:function(){this.baseField=[{xtype:"fieldset",title:lang("personTransfer"),defaults:{style:{marginBottom:"5px"},border:false},items:[{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({fieldLabel:lang("mobilizeType"),name:"changeLevelType",store:new Ext.data.SimpleStore({fields:["value","changeLevelType"],data:[["4",lang("promotion")],["3",lang("personTransfer")],["2",lang("demote")],["1",lang("other")],["0","　　　　"]]}),width:190,hiddenName:"changeLevelType",valueField:"changeLevelType",displayField:"changeLevelType",mode:"local",triggerAction:"all"})]},{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"changeReason",fieldLabel:lang("mobilizeReason"),width:190}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"changeDate",fieldLabel:lang("monilizeDate"),width:190}]},{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"changeStartDate",fieldLabel:lang("monilizeEffDate"),width:190}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"changeBeforCompany",fieldLabel:lang("mobilizeQianUnit"),width:190}]},{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"changeAfterCompany",fieldLabel:lang("mobilizeUnit"),width:190}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"changeBeforJobType",fieldLabel:lang("mobilizeDuties1"),width:190}]},{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"changeAfterJobType",fieldLabel:lang("mobilizeTheJob"),width:190}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"changeBeforDept",fieldLabel:lang("mobilizeDept1"),width:190}]},{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"changeAfterDept",fieldLabel:lang("mobilizeDept"),width:190}]}]},{xtype:"textarea",name:"changeNotes",fieldLabel:lang("mobilizeFormalities"),width:490},{xtype:"textarea",name:"change_notes",fieldLabel:lang("remark"),width:490},{xtype:"flashfile",name:"document",fieldLabel:lang("addDocument"),style:"margin-top:5px;",inputPre:"filesUpload"}]}];this.formPanel=new Ext.form.FormPanel({hideBorders:true,border:false,waitMsgTarget:true,layout:"border",labelWidth:90,bodyStyle:"border-left-width:1px;",labelAlign:"right",items:[{xtype:"panel",border:false,bodyStyle:"padding:10px",layout:"form",region:"center",autoScroll:true,items:[this.baseField]}]});this.addEditWindow=new Ext.Window({layout:"fit",width:660,height:makeWindowHeight(500),title:lang("addNewPersonTransfer"),resizable:false,modal:true,items:[this.formPanel],buttons:[{text:lang("save"),iconCls:"icon-btn-save",handler:function(){this.submitForm()}.createDelegate(this)},{text:lang("close"),iconCls:"icon-dialog-cancel",handler:function(){this.close()}.createDelegate(this)}]});this.addEditWindow.show();if(this.type=="editDetails"){this.loadFormData()}},deleteList:function(a){var c=this;var b=this.list.getSelectionModel().getSelections();if(b.length==0){CNOA.miniMsg.alertShowAt(a,lang("mustSelectOneRow"))}else{CNOA.msg.cf(lang("confirmToDelete"),function(e){if(e=="yes"){if(b){var f="";for(var d=0;d<b.length;d++){f+=b[d].get("id")+","}c.deleteData(f)}}})}},deleteData:function(a){var b=this;Ext.Ajax.request({url:this.baseUrl+"&task=delete&type=change",method:"POST",params:{ids:a},success:function(d){var c=Ext.decode(d.responseText);if(c.success===true){CNOA.msg.notice(c.msg,lang("hrMgr"));b.store.reload()}else{CNOA.msg.alert(c.msg)}}})},show:function(){this.addEditWindow.show()},close:function(){this.addEditWindow.close()},operation:function(a){return"<a href='javascript:void(0)' class='gridview' onclick='CNOA_hr_person_changeManage.viewDetails("+a+")'>"+lang("view")+"</a>"},viewDetails:function(a){var b=this;x=(screen.availWidth-850)/2;y=(screen.availHeight-600)/2;window.open(b.baseUrl+"&task=loadPage&from=viewDetails&type=change&ID="+a+"&personID="+CNOA.hr.person.manage.addDetails.personID,"changeView","width=890,height=500,left="+x+",top="+y+",scrollbars=yes,resizable=yes,status=no")},loadFormData:function(){var a=this;this.formPanel.getForm().load({url:a.baseUrl+"&task=getList&type=change&edit=modify",params:{id:a.edit_id},method:"POST",waitMsg:lang("waiting"),success:function(b,c){},failure:function(b,c){CNOA.msg.alert(c.result.msg,function(){a.close()})}.createDelegate(this)})},submitForm:function(){var a=this;if(a.formPanel.getForm().isValid()){a.formPanel.getForm().submit({url:a.baseUrl+"&task="+a.type+"&type=change&id="+a.edit_id+"&personID="+CNOA.hr.person.manage.addDetails.personID,waitMsg:lang("waiting"),method:"POST",success:function(b,c){CNOA.msg.notice(c.result.msg,lang("hrMgr"));this.addEditWindow.close();a.store.reload()}.createDelegate(this),failure:function(b,c){CNOA.msg.alert(c.result.msg)}.createDelegate(this)})}}};var CNOA_hr_person_relationshipManageClass,CNOA_hr_person_relationshipManage;CNOA_hr_person_relationshipManageClass=CNOA.Class.create();CNOA_hr_person_relationshipManageClass.prototype={init:function(){var a=this;this.edit_id=0;this.type="addDetails";a.baseUrl="index.php?app=hr&func=person&action=manage";this.mainPanel=this.mkMainPanel()},mkMainPanel:function(){var a=this;this.fields=[{name:"id"},{name:"name"},{name:"relationship"},{name:"job"},{name:"jobType"},{name:"telephone"},{name:"companyPhone"},{name:"company"},{name:"relationship_notes"}];this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:a.baseUrl+"&task=getList&type=relationship&personID="+CNOA.hr.person.manage.addDetails.personID,disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields})});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.store.load();this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),this.sm,{header:"id",dataIndex:"id",hidden:true},{header:lang("truename"),dataIndex:"name",width:80,sortable:true,menuDisabled:true},{header:lang("relationshipMe"),dataIndex:"relationship",width:150,sortable:false,menuDisabled:true},{header:lang("career"),dataIndex:"job",width:80,sortable:false,menuDisabled:true},{header:lang("positions"),dataIndex:"jobType",width:80,sortable:false,menuDisabled:true},{header:lang("personPhone"),dataIndex:"telephone",width:130,sortable:false,menuDisabled:true},{header:lang("unitPhone"),dataIndex:"companyPhone",width:130,sortable:false,menuDisabled:true},{header:lang("unitName"),dataIndex:"company",width:155,sortable:false,menuDisabled:true},{header:lang("opt"),dataIndex:"id",width:65,sortable:false,menuDisabled:true,renderer:this.operation},{header:lang("remark"),dataIndex:"relationship_notes",width:120,sortable:false,menuDisabled:true},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({style:"border-left-width:1px;",displayInfo:true,store:this.store,pageSize:15});this.list=new Ext.grid.GridPanel({stripeRows:true,title:lang("relationshioMgr"),border:false,store:this.store,loadMask:{msg:lang("waiting")},cm:this.colModel,sm:this.sm,hideBorders:true,listeners:{rowdblclick:function(b,c){var d=a.list.getSelectionModel().getSelections();a.edit_id=d[0].get("id");a.viewDetails(a.edit_id)}},tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){this.store.reload()}.createDelegate(this)},{text:lang("add"),iconCls:"icon-utils-s-add",handler:function(){a.type="addDetails";a.mkAddEditPanel()}},{handler:function(b,c){var d=a.list.getSelectionModel().getSelections();if(d.length==0){CNOA.miniMsg.alertShowAt(b,lang("mustSelectOneRow"))}else{a.type="editDetails";a.edit_id=d[0].get("id");a.mkAddEditPanel()}},iconCls:"icon-utils-s-edit",text:lang("modify")},{text:lang("del"),iconCls:"icon-utils-s-delete",handler:function(b){a.deleteList(b)}},"<span class='cnoa_color_gray'>"+lang("dblClickToView")+"</span>","->",{xtype:"cnoa_helpBtn",helpid:156}],bbar:this.pagingBar});return this.list},mkAddEditPanel:function(){this.baseField=[{xtype:"fieldset",title:lang("socialRelations"),defaults:{style:{marginBottom:"5px"},border:false},items:[{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"name",fieldLabel:lang("truename"),width:190}]},{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({fieldLabel:lang("relationshipMe"),name:"relationship",store:new Ext.data.SimpleStore({fields:["value","relationship"],data:[["6",lang("motherAndSon")],["5",lang("fatherAndSon")],["4",lang("brotherAndSister")],["3",lang("sisters")],["2",lang("brothers")],["1",lang("other")],["0","　　　　"]]}),width:190,hiddenName:"relationship",valueField:"value",displayField:"relationship",mode:"local",triggerAction:"all",forceSelection:true,editable:false})]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"birthday",fieldLabel:lang("birthday"),width:190}]},{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({fieldLabel:lang("zZMM"),name:"politics",store:new Ext.data.SimpleStore({fields:["value","politics"],data:[["5",lang("masses")],["4",lang("gQTY")],["3",lang("CCP")],["2",lang("CCPPro")],["1",lang("withoutParty")],["0","　　　　"]]}),width:190,hiddenName:"politics",valueField:"value",displayField:"politics",mode:"local",triggerAction:"all",forceSelection:true,editable:false})]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"job",fieldLabel:lang("career"),width:190}]},{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"jobType",fieldLabel:lang("positions"),width:190}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"telephone",fieldLabel:lang("personPhone"),width:190}]},{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"companyPhone",fieldLabel:lang("unitPhone"),width:190}]}]},{xtype:"cnoa_textfield",name:"company",fieldLabel:lang("workUnit"),width:490},{xtype:"cnoa_textfield",name:"companyPosition",fieldLabel:lang("workAddr"),width:490},{xtype:"cnoa_textfield",name:"homePosition",fieldLabel:lang("homeAddress"),width:490},{xtype:"textarea",name:"relationship_notes",fieldLabel:lang("remark"),width:490},{xtype:"flashfile",name:"document",fieldLabel:lang("addDocument"),style:"margin-top:5px;",inputPre:"filesUpload"}]}];this.formPanel=new Ext.form.FormPanel({hideBorders:true,border:false,waitMsgTarget:true,layout:"border",labelWidth:90,bodyStyle:"border-left-width:1px;",labelAlign:"right",items:[{xtype:"panel",border:false,bodyStyle:"padding:10px",layout:"form",region:"center",autoScroll:true,items:[this.baseField]}]});this.addEditWindow=new Ext.Window({layout:"fit",width:660,height:makeWindowHeight(480),title:lang("addNewSocialRelatons"),resizable:false,modal:true,items:[this.formPanel],buttons:[{text:lang("save"),iconCls:"icon-btn-save",handler:function(){this.submitForm()}.createDelegate(this)},{text:lang("close"),iconCls:"icon-dialog-cancel",handler:function(){this.close()}.createDelegate(this)}]});this.addEditWindow.show();if(this.type=="editDetails"){this.loadFormData()}},deleteList:function(a){var c=this;var b=this.list.getSelectionModel().getSelections();if(b.length==0){CNOA.miniMsg.alertShowAt(a,lang("mustSelectOneRow"))}else{CNOA.msg.cf(lang("confirmToDelete"),function(e){if(e=="yes"){if(b){var f="";for(var d=0;d<b.length;d++){f+=b[d].get("id")+","}c.deleteData(f)}}})}},deleteData:function(a){var b=this;Ext.Ajax.request({url:this.baseUrl+"&task=delete&type=relationship",method:"POST",params:{ids:a},success:function(d){var c=Ext.decode(d.responseText);if(c.success===true){CNOA.msg.notice(c.msg,lang("hrMgr"));b.store.reload()}else{CNOA.msg.alert(c.msg)}}})},show:function(){this.addEditWindow.show()},close:function(){this.addEditWindow.close()},operation:function(a){return"<a href='javascript:void(0)' class='gridview' onclick='CNOA_hr_person_relationshipManage.viewDetails("+a+")'>"+lang("view")+"</a>"},viewDetails:function(a){var b=this;x=(screen.availWidth-850)/2;y=(screen.availHeight-600)/2;window.open(b.baseUrl+"&task=loadPage&from=viewDetails&type=relationship&ID="+a+"&personID="+CNOA.hr.person.manage.addDetails.personID,"relationshipView","width=890,height=500,left="+x+",top="+y+",scrollbars=yes,resizable=yes,status=no")},loadFormData:function(){var a=this;this.formPanel.getForm().load({url:a.baseUrl+"&task=getList&type=relationship&edit=modify",params:{id:a.edit_id},method:"POST",waitMsg:lang("waiting"),failure:function(b,c){CNOA.msg.alert(c.result.msg,function(){a.close()})}.createDelegate(this)})},submitForm:function(){var a=this;if(a.formPanel.getForm().isValid()){a.formPanel.getForm().submit({url:a.baseUrl+"&task="+a.type+"&type=relationship&id="+a.edit_id+"&personID="+CNOA.hr.person.manage.addDetails.personID,waitMsg:lang("waiting"),method:"POST",success:function(b,c){CNOA.msg.notice(c.result.msg,lang("hrMgr"));this.addEditWindow.close();a.store.reload()}.createDelegate(this),failure:function(b,c){CNOA.msg.alert(c.result.msg)}.createDelegate(this)})}}};var CNOA_hr_person_skillManageClass,CNOA_hr_person_skillManage;CNOA_hr_person_skillManageClass=CNOA.Class.create();CNOA_hr_person_skillManageClass.prototype={init:function(){var a=this;this.edit_id=0;this.type="addDetails";a.baseUrl="index.php?app=hr&func=person&action=manage";this.mainPanel=this.mkMainPanel()},mkMainPanel:function(){var a=this;this.fields=[{name:"id"},{name:"skillName"},{name:"specialSkill"},{name:"level"},{name:"skillLicense"},{name:"skillStartDate"},{name:"endDate"},{name:"skillDepartment"},{name:"skill_notes"}];this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:a.baseUrl+"&task=getList&type=skill&personID="+CNOA.hr.person.manage.addDetails.personID,disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields})});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.store.load();this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),this.sm,{header:"id",dataIndex:"id",hidden:true},{header:lang("skillName"),dataIndex:"skillName",width:100,sortable:true,menuDisabled:true},{header:lang("specoalSkills"),dataIndex:"specialSkill",width:90,sortable:false,menuDisabled:true},{header:lang("level"),dataIndex:"level",width:100,sortable:false,menuDisabled:true},{header:lang("skillCertificate"),dataIndex:"skillLicense",width:50,sortable:false,menuDisabled:true},{header:lang("startTime"),dataIndex:"skillStartDate",width:110,sortable:false,menuDisabled:true},{header:lang("endTime"),dataIndex:"endDate",width:110,sortable:false,menuDisabled:true},{header:lang("certificationUnit"),dataIndex:"skillDepartment",width:155,sortable:false,menuDisabled:true},{header:lang("opt"),dataIndex:"id",width:65,sortable:false,menuDisabled:true,renderer:this.operation},{header:lang("remark"),dataIndex:"skill_notes",width:120,sortable:false,menuDisabled:true},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({style:"border-left-width:1px;",displayInfo:true,store:this.store,pageSize:15});this.list=new Ext.grid.GridPanel({stripeRows:true,title:lang("jobSkillManage"),border:false,store:this.store,loadMask:{msg:lang("waiting")},cm:this.colModel,sm:this.sm,hideBorders:true,listeners:{rowdblclick:function(b,c){var d=a.list.getSelectionModel().getSelections();a.edit_id=d[0].get("id");a.viewDetails(a.edit_id)}},tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){this.store.reload()}.createDelegate(this)},{text:lang("add"),iconCls:"icon-utils-s-add",handler:function(){a.type="addDetails";a.mkAddEditPanel()}},{handler:function(b,c){var d=a.list.getSelectionModel().getSelections();if(d.length==0){CNOA.miniMsg.alertShowAt(b,lang("mustSelectOneRow"))}else{a.type="editDetails";a.edit_id=d[0].get("id");a.mkAddEditPanel()}},iconCls:"icon-utils-s-edit",text:lang("modify")},{text:lang("del"),iconCls:"icon-utils-s-delete",handler:function(b){a.deleteList(b)}},"<span class='cnoa_color_gray'>"+lang("dblClickToView")+"</span>","->",{xtype:"cnoa_helpBtn",helpid:155}],bbar:this.pagingBar});return this.list},mkAddEditPanel:function(){this.baseField=[{xtype:"fieldset",title:lang("laborSkill"),defaults:{style:{marginBottom:"5px"},border:false},items:[{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"skillName",fieldLabel:lang("skillName"),width:190}]},{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({fieldLabel:lang("specoalSkills"),name:"specialSkill",store:new Ext.data.SimpleStore({fields:["value","specialSkill"],data:[["2",lang("yes")],["1",lang("no")],["0","　　　　"]]}),width:190,hiddenName:"specialSkill",valueField:"value",displayField:"specialSkill",mode:"local",triggerAction:"all",forceSelection:true,editable:false})]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"level",fieldLabel:lang("level"),width:190}]},{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({fieldLabel:lang("skillCertificate"),name:"skillLicense",store:new Ext.data.SimpleStore({fields:["value","skillLicense"],data:[["2",lang("have")],["1",lang("nothing")],["0","　　　　"]]}),width:190,hiddenName:"skillLicense",valueField:"value",displayField:"skillLicense",mode:"local",triggerAction:"all",forceSelection:true,editable:false})]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"skillStartDate",fieldLabel:lang("certificationDate"),width:190}]},{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"endDate",fieldLabel:lang("endTime"),width:190}]}]},{xtype:"cnoa_textfield",name:"skillDepartment",fieldLabel:lang("certificationUnit"),width:495},{xtype:"textarea",name:"skill_notes",fieldLabel:lang("remark"),width:495},{xtype:"flashfile",name:"document",fieldLabel:lang("addDocument"),style:"margin-top:5px;",inputPre:"filesUpload"}]}];this.formPanel=new Ext.form.FormPanel({hideBorders:true,border:false,waitMsgTarget:true,layout:"border",labelWidth:90,bodyStyle:"border-left-width:1px;",labelAlign:"right",items:[{xtype:"panel",border:false,bodyStyle:"padding:10px",layout:"form",region:"center",autoScroll:true,items:[this.baseField]}]});this.addEditWindow=new Ext.Window({layout:"fit",width:660,height:makeWindowHeight(430),title:lang("addNewLabor"),resizable:false,modal:true,items:[this.formPanel],buttons:[{text:lang("save"),iconCls:"icon-btn-save",handler:function(){this.submitForm()}.createDelegate(this)},{text:lang("close"),iconCls:"icon-dialog-cancel",handler:function(){this.close()}.createDelegate(this)}]});this.addEditWindow.show();if(this.type=="editDetails"){this.loadFormData()}},deleteList:function(a){var c=this;var b=this.list.getSelectionModel().getSelections();if(b.length==0){CNOA.miniMsg.alertShowAt(a,lang("mustSelectOneRow"))}else{CNOA.msg.cf(lang("confirmToDelete"),function(e){if(e=="yes"){if(b){var f="";for(var d=0;d<b.length;d++){f+=b[d].get("id")+","}c.deleteData(f)}}})}},deleteData:function(a){var b=this;Ext.Ajax.request({url:this.baseUrl+"&task=delete&type=skill",method:"POST",params:{ids:a},success:function(d){var c=Ext.decode(d.responseText);if(c.success===true){CNOA.msg.notice(c.msg,lang("hrMgr"));b.store.reload()}else{CNOA.msg.alert(c.msg)}}})},show:function(){this.addEditWindow.show()},close:function(){this.addEditWindow.close()},operation:function(a){return"<a href='javascript:void(0)' class='gridview' onclick='CNOA_hr_person_skillManage.viewDetails("+a+")'>"+lang("view")+"</a>"},viewDetails:function(a){var b=this;x=(screen.availWidth-850)/2;y=(screen.availHeight-600)/2;window.open(b.baseUrl+"&task=loadPage&from=viewDetails&type=skill&ID="+a+"&personID="+CNOA.hr.person.manage.addDetails.personID,"skillView","width=890,height=500,left="+x+",top="+y+",scrollbars=yes,resizable=yes,status=no")},loadFormData:function(){var a=this;this.formPanel.getForm().load({url:a.baseUrl+"&task=getList&type=skill&edit=modify",params:{id:a.edit_id},method:"POST",waitMsg:lang("waiting"),failure:function(b,c){CNOA.msg.alert(c.result.msg,function(){a.close()})}.createDelegate(this)})},submitForm:function(){var a=this;if(a.formPanel.getForm().isValid()){a.formPanel.getForm().submit({url:a.baseUrl+"&task="+a.type+"&type=skill&id="+a.edit_id+"&personID="+CNOA.hr.person.manage.addDetails.personID,waitMsg:lang("waiting"),method:"POST",success:function(b,c){CNOA.msg.notice(c.result.msg,lang("hrMgr"));this.addEditWindow.close();a.store.reload()}.createDelegate(this),failure:function(b,c){CNOA.msg.alert(c.result.msg)}.createDelegate(this)})}}};var CNOA_hr_person_workManageClass,CNOA_hr_person_workManage;CNOA_hr_person_workManageClass=CNOA.Class.create();CNOA_hr_person_workManageClass.prototype={init:function(){var a=this;this.edit_id=0;this.type="addDetails";a.baseUrl="index.php?app=hr&func=person&action=manage";this.mainPanel=this.mkMainPanel()},mkMainPanel:function(){var a=this;this.fields=[{name:"id"},{name:"stayJob"},{name:"stayDepartment"},{name:"startDate"},{name:"endDate"},{name:"workDepartment"},{name:"jobType"},{name:"work_notes"}];this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:a.baseUrl+"&task=getList&type=work&personID="+CNOA.hr.person.manage.addDetails.personID,disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields})});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.store.load();this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),this.sm,{header:"id",dataIndex:"id",hidden:true},{header:lang("positions"),dataIndex:"stayJob",width:100,sortable:true,menuDisabled:true},{header:lang("inDepartment"),dataIndex:"stayDepartment",width:110,sortable:false,menuDisabled:true},{header:lang("startTime"),dataIndex:"startDate",width:110,sortable:false,menuDisabled:true},{header:lang("endTime"),dataIndex:"endDate",width:110,sortable:false,menuDisabled:true},{header:lang("industrySector"),dataIndex:"jobType",width:85,sortable:false,menuDisabled:true},{header:lang("workUnit"),dataIndex:"workDepartment",width:150,sortable:false,menuDisabled:true},{header:lang("opt"),dataIndex:"id",width:65,sortable:false,menuDisabled:true,renderer:this.operation},{header:lang("remark"),dataIndex:"work_notes",width:120,sortable:false,menuDisabled:true},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({style:"border-left-width:1px;",displayInfo:true,store:this.store,pageSize:15,listeners:{beforechange:function(b,c){Ext.apply(c,a.storeBar)}}});this.list=new Ext.grid.GridPanel({stripeRows:true,title:lang("workExpManage"),border:false,store:this.store,loadMask:{msg:lang("waiting")},cm:this.colModel,sm:this.sm,hideBorders:true,listeners:{rowdblclick:function(b,c){var d=a.list.getSelectionModel().getSelections();a.edit_id=d[0].get("id");a.viewDetails(a.edit_id)}},tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){this.store.reload()}.createDelegate(this)},{text:lang("add"),iconCls:"icon-utils-s-add",handler:function(){a.type="addDetails";a.mkAddEditPanel()}},{handler:function(b,c){var d=a.list.getSelectionModel().getSelections();if(d.length==0){CNOA.miniMsg.alertShowAt(b,lang("mustSelectOneRow"))}else{a.type="editDetails";a.edit_id=d[0].get("id");a.mkAddEditPanel()}},iconCls:"icon-utils-s-edit",text:lang("modify")},{text:lang("del"),iconCls:"icon-utils-s-delete",handler:function(b){a.deleteList(b)}},"<span class='cnoa_color_gray'>"+lang("dblClickToView")+"</span>","->",{xtype:"cnoa_helpBtn",helpid:154}],bbar:this.pagingBar});return this.list},mkAddEditPanel:function(){this.baseField=[{xtype:"fieldset",title:lang("workExperience"),defaults:{style:{marginBottom:"5px"},border:false},items:[{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"stayJob",fieldLabel:lang("positions"),width:190}]},{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"stayDepartment",fieldLabel:lang("inDepartment"),width:190}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"zhengMingRen",fieldLabel:lang("provePeople"),width:190}]},{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"jobType",fieldLabel:lang("industrySector"),width:190}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"startDate",fieldLabel:lang("startDate"),width:190}]},{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"endDate",fieldLabel:lang("endDate"),width:190}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"workDepartment",fieldLabel:lang("workUnit"),width:190}]},{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"workContact",fieldLabel:lang("contacts1"),width:190}]}]},{xtype:"textarea",name:"workContent",fieldLabel:lang("workContent"),width:490},{xtype:"textarea",name:"leaveReason",fieldLabel:lang("leavingReason"),width:490},{xtype:"textarea",name:"work_notes",fieldLabel:lang("remark"),width:490},{xtype:"flashfile",name:"document",fieldLabel:lang("addDocument"),style:"margin-top:5px;",inputPre:"filesUpload"}]}];this.formPanel=new Ext.form.FormPanel({hideBorders:true,border:false,waitMsgTarget:true,layout:"border",labelWidth:90,bodyStyle:"border-left-width:1px;",labelAlign:"right",items:[{xtype:"panel",border:false,bodyStyle:"padding:10px",layout:"form",region:"center",autoScroll:true,items:[this.baseField]}]});this.addEditWindow=new Ext.Window({layout:"fit",width:660,height:makeWindowHeight(520),title:lang("addNewWorkExp"),resizable:false,modal:true,items:[this.formPanel],buttons:[{text:lang("save"),iconCls:"icon-btn-save",handler:function(){this.submitForm()}.createDelegate(this)},{text:lang("close"),iconCls:"icon-dialog-cancel",handler:function(){this.close()}.createDelegate(this)}]});this.addEditWindow.show();if(this.type=="editDetails"){this.loadFormData()}},deleteList:function(a){var c=this;var b=this.list.getSelectionModel().getSelections();if(b.length==0){CNOA.miniMsg.alertShowAt(a,lang("mustSelectOneRow"))}else{CNOA.msg.cf(lang("confirmToDelete"),function(e){if(e=="yes"){if(b){var f="";for(var d=0;d<b.length;d++){f+=b[d].get("id")+","}c.deleteData(f)}}})}},deleteData:function(a){var b=this;Ext.Ajax.request({url:this.baseUrl+"&task=delete&type=work",method:"POST",params:{ids:a},success:function(d){var c=Ext.decode(d.responseText);if(c.success===true){CNOA.msg.notice(c.msg,lang("hrMgr"));b.store.reload()}else{CNOA.msg.alert(c.msg)}}})},show:function(){this.addEditWindow.show()},close:function(){this.addEditWindow.close()},operation:function(a){return"<a href='javascript:void(0)' class='gridview' onclick='CNOA_hr_person_workManage.viewDetails("+a+")'>"+lang("view")+"</a>"},viewDetails:function(a){var b=this;x=(screen.availWidth-850)/2;y=(screen.availHeight-600)/2;window.open(b.baseUrl+"&task=loadPage&from=viewDetails&type=work&ID="+a+"&personID="+CNOA.hr.person.manage.addDetails.personID,"workView","width=890,height=500,left="+x+",top="+y+",scrollbars=yes,resizable=yes,status=no")},loadFormData:function(){var a=this;this.formPanel.getForm().load({url:a.baseUrl+"&task=getList&type=work&edit=modify",params:{id:a.edit_id},method:"POST",waitMsg:lang("waiting"),failure:function(b,c){CNOA.msg.alert(c.result.msg,function(){a.close()})}.createDelegate(this)})},submitForm:function(){var a=this;if(a.formPanel.getForm().isValid()){a.formPanel.getForm().submit({url:a.baseUrl+"&task="+a.type+"&type=work&id="+a.edit_id+"&personID="+CNOA.hr.person.manage.addDetails.personID,waitMsg:lang("waiting"),method:"POST",success:function(b,c){CNOA.msg.notice(c.result.msg,lang("hrMgr"));this.addEditWindow.close();a.store.reload()}.createDelegate(this),failure:function(b,c){CNOA.msg.alert(c.result.msg)}.createDelegate(this)})}}};var CNOA_hr_person_studyManageClass,CNOA_hr_person_studyManage;CNOA_hr_person_studyManageClass=CNOA.Class.create();CNOA_hr_person_studyManageClass.prototype={init:function(){var g=this;this.edit_id=0;this.type="addDetails";g.baseUrl="index.php?app=hr&func=person&action=manage";this.storeBar={title:"",school:"",education:"",stime:"",etime:""};var d=Ext.id();var b=Ext.id();var f=Ext.id();var a=Ext.id();var c=Ext.id();var e=Ext.id();this.mainPanel=new Ext.Panel({title:lang("LEmaneage"),layout:"border",border:false,items:this.mkMainPanel(),tbar:[lang("profession")+": ",{xtype:"textfield",id:d,width:100},lang("school")+": ",{xtype:"textfield",id:b,width:100},lang("degree")+": ",new Ext.form.ComboBox({fieldLabel:lang("degree"),name:"studySituation",store:this.getDropStore(),id:e,width:100,hiddenName:"studySituation",valueField:"id",displayField:"value",mode:"local",triggerAction:"all",forceSelection:true,editable:false}),lang("startTime")+": ",{xtype:"datefield",width:100,format:"Y-m-d",id:a},lang("endTime")+": ",{xtype:"datefield",width:100,format:"Y-m-d",id:c},{xtype:"button",text:lang("search"),style:"margin-left:5px",handler:function(){g.storeBar.title=Ext.getCmp(d).getValue();g.storeBar.school=Ext.getCmp(b).getValue();g.storeBar.education=Ext.getCmp(e).getValue();g.storeBar.stime=Ext.getCmp(a).getRawValue();g.storeBar.etime=Ext.getCmp(c).getRawValue();g.store.load({params:g.storeBar})}},{xtype:"button",text:lang("clear"),handler:function(){Ext.getCmp(d).setValue("");Ext.getCmp(b).setValue("");Ext.getCmp(e).setValue("");Ext.getCmp(a).setValue("");Ext.getCmp(c).setValue("");g.storeBar.title="";g.storeBar.school="";g.storeBar.education="";g.storeBar.stime="";g.storeBar.etime="";g.store.load({params:g.storeBar})}}]})},getDropStore:function(){var a=this;a.dropdownstore=new Ext.data.Store({autoLoad:true,proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getList&type=getdropstore&id=5"}),reader:new Ext.data.JsonReader({root:"data",fields:[{name:"id"},{name:"value"}]})});return a.dropdownstore},mkMainPanel:function(){var a=this;this.fields=[{name:"id"},{name:"perfessor"},{name:"startDate"},{name:"endDate"},{name:"education"},{name:"studySituation"},{name:"banGan"},{name:"zhengMingRen"},{name:"school"},{name:"schoolPosition"},{name:"schoolConnect"},{name:"study_notes"}];this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:a.baseUrl+"&task=getList&type=study&personID="+CNOA.hr.person.manage.addDetails.personID,disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields})});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.store.load();this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),this.sm,{header:"id",dataIndex:"id",hidden:true},{header:lang("profession"),dataIndex:"perfessor",width:150,sortable:true,menuDisabled:true},{header:lang("startTime"),dataIndex:"startDate",width:110,sortable:false,menuDisabled:true},{header:lang("endTime"),dataIndex:"endDate",width:110,sortable:false,menuDisabled:true},{header:lang("sHXL"),dataIndex:"education",width:135,sortable:false,menuDisabled:true},{header:lang("degree"),dataIndex:"studySituation",width:85,sortable:false,menuDisabled:true},{header:lang("cRclassCadre"),dataIndex:"banGan",width:135,sortable:false,menuDisabled:true},{header:lang("graSchool"),dataIndex:"school",width:150,sortable:false,menuDisabled:true},{header:lang("opt"),dataIndex:"id",width:65,sortable:false,menuDisabled:true,renderer:this.operation},{header:lang("remark"),dataIndex:"study_notes",width:120,sortable:false,menuDisabled:true},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({style:"border-left-width:1px;",displayInfo:true,store:this.store,pageSize:15,listeners:{beforechange:function(b,c){Ext.apply(c,a.storeBar)}}});this.list=new Ext.grid.GridPanel({stripeRows:true,layout:"fit",region:"center",border:false,store:this.store,loadMask:{msg:lang("waiting")},cm:this.colModel,sm:this.sm,hideBorders:true,listeners:{rowdblclick:function(b,c){var d=a.list.getSelectionModel().getSelections();a.edit_id=d[0].get("id");a.viewDetails(a.edit_id)}},tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){this.store.reload()}.createDelegate(this)},{text:lang("add"),iconCls:"icon-utils-s-add",handler:function(){a.type="addDetails";a.mkAddEditPanel()}},{handler:function(b,c){var d=a.list.getSelectionModel().getSelections();if(d.length==0){CNOA.miniMsg.alertShowAt(b,lang("mustSelectOneRow"))}else{a.type="editDetails";a.edit_id=d[0].get("id");a.mkAddEditPanel()}}.createDelegate(this),iconCls:"icon-utils-s-edit",text:lang("modify")},{text:lang("del"),iconCls:"icon-utils-s-delete",handler:function(b){a.deleteList(b)}},"<span class='cnoa_color_gray'>"+lang("dblClickToView")+"</span>","->",{xtype:"cnoa_helpBtn",helpid:153}],bbar:this.pagingBar});return this.list},mkAddEditPanel:function(){this.baseField=[{xtype:"fieldset",title:lang("LearninExpericen"),defaults:{style:{marginBottom:"5px"},border:false},items:[{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"perfessor",fieldLabel:lang("profession"),width:190}]},{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"education",fieldLabel:lang("sHXL"),width:190}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"startDate",fieldLabel:lang("startDate"),width:190}]},{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"endDate",fieldLabel:lang("endDate"),width:190}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({fieldLabel:lang("degree"),name:"studySituation",store:this.getDropStore(),width:190,hiddenName:"studySituation",valueField:"id",displayField:"value",mode:"local",triggerAction:"all",forceSelection:true,editable:false})]},{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"banGan",fieldLabel:lang("cRclassCadre"),width:190}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"zhengMingRen",fieldLabel:lang("provePeople"),width:190}]}]},{xtype:"cnoa_textfield",name:"school",fieldLabel:lang("whereCollege"),width:490},{xtype:"cnoa_textfield",name:"schoolPosition",fieldLabel:lang("schoolIsIN"),width:490},{xtype:"cnoa_textfield",name:"schoolConnect",fieldLabel:lang("yXLXFS"),width:490},{xtype:"textarea",name:"study_notes",fieldLabel:lang("remark"),width:490},{xtype:"flashfile",name:"document",fieldLabel:lang("addDocument"),style:"margin-top:5px;",inputPre:"filesUpload"}]}];this.formPanel=new Ext.form.FormPanel({hideBorders:true,border:false,waitMsgTarget:true,layout:"border",labelWidth:90,bodyStyle:"border-left-width:1px;",labelAlign:"right",items:[{xtype:"panel",border:false,bodyStyle:"padding:10px",layout:"form",region:"center",autoScroll:true,items:[this.baseField]}]});this.addEditWindow=new Ext.Window({layout:"fit",width:660,height:makeWindowHeight(460),title:lang("addNewLE"),resizable:false,modal:true,items:[this.formPanel],buttons:[{text:lang("save"),iconCls:"icon-btn-save",handler:function(){this.submitForm()}.createDelegate(this)},{text:lang("close"),iconCls:"icon-dialog-cancel",handler:function(){this.close()}.createDelegate(this)}]});this.addEditWindow.show();if(this.type=="editDetails"){this.loadFormData()}},deleteList:function(a){var c=this;var b=this.list.getSelectionModel().getSelections();if(b.length==0){CNOA.miniMsg.alertShowAt(a,lang("mustSelectOneRow"))}else{CNOA.msg.cf(lang("confirmToDelete"),function(e){if(e=="yes"){if(b){var f="";for(var d=0;d<b.length;d++){f+=b[d].get("id")+","}c.deleteData(f)}}})}},deleteData:function(a){var b=this;Ext.Ajax.request({url:this.baseUrl+"&task=delete&type=study",method:"POST",params:{ids:a},success:function(d){var c=Ext.decode(d.responseText);if(c.success===true){CNOA.msg.notice(c.msg,lang("hrMgr"));b.store.reload()}else{CNOA.msg.alert(c.msg)}}})},show:function(){this.addEditWindow.show()},close:function(){this.addEditWindow.close()},operation:function(a){return"<a href='javascript:void(0)' class='gridview' onclick='CNOA_hr_person_studyManage.viewDetails("+a+")'>"+lang("view")+"</a>"},viewDetails:function(a){var b=this;x=(screen.availWidth-850)/2;y=(screen.availHeight-600)/2;window.open(b.baseUrl+"&task=loadPage&from=viewDetails&type=study&ID="+a+"&personID="+CNOA.hr.person.manage.addDetails.personID,"studyView","width=890,height=500,left="+x+",top="+y+",scrollbars=yes,resizable=yes,status=no")},loadFormData:function(){var a=this;this.formPanel.getForm().load({url:a.baseUrl+"&task=getList&type=study&edit=modify",params:{id:a.edit_id},method:"POST",waitMsg:lang("waiting"),failure:function(b,c){CNOA.msg.alert(c.result.msg,function(){a.close()})}.createDelegate(this)})},submitForm:function(){var a=this;if(a.formPanel.getForm().isValid()){a.formPanel.getForm().submit({url:a.baseUrl+"&task="+a.type+"&type=study&id="+a.edit_id+"&personID="+CNOA.hr.person.manage.addDetails.personID,waitMsg:lang("waiting"),method:"POST",success:function(b,c){CNOA.msg.notice(c.result.msg,lang("hrMgr"));this.addEditWindow.close();a.store.reload()}.createDelegate(this),failure:function(b,c){CNOA.msg.alert(c.result.msg)}.createDelegate(this)})}}};var CNOA_hr_person_peixunManage,CNOA_hr_person_peixunManageClass;CNOA_hr_person_peixunManageClass=CNOA.Class.create();CNOA_hr_person_peixunManageClass.prototype={init:function(){var e=this;this.edit_id=0;this.type="addDetails";e.baseUrl="index.php?app=hr&func=person&action=manage";this.storeBar={property:"",s_money:"",e_money:"",type:""};var a=Ext.id();var c=Ext.id();var b=Ext.id();var d=Ext.id();this.mainPanel=new Ext.Panel({title:lang("trainManagement"),layout:"border",border:false,items:this.mkMainPanel()})},mkMainPanel:function(){var a=this;this.fields=[{name:"id"},{name:"title"},{name:"content"},{name:"stime"},{name:"etime"},{name:"price"},{name:"place"},{name:"type"},{name:"way"},{name:"license"},{name:"notes"}];this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:a.baseUrl+"&task=getList&type=peixun&personID="+CNOA.hr.person.manage.addDetails.personID,disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields})});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.store.load();this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),this.sm,{header:"id",dataIndex:"id",hidden:true},{header:lang("peixunZT"),dataIndex:"title",width:220,sortable:true,menuDisabled:true},{header:lang("peixunContent"),dataIndex:"content",width:110,sortable:false,menuDisabled:true},{header:lang("startDate"),dataIndex:"stime",width:80,sortable:false,menuDisabled:true},{header:lang("endDate"),dataIndex:"etime",width:80,sortable:false,menuDisabled:true},{header:lang("TrainingCosts"),dataIndex:"price",width:90,sortable:false,menuDisabled:true},{header:lang("trainLocation"),dataIndex:"place",width:110,sortable:false,menuDisabled:true},{header:lang("trainingType"),dataIndex:"type",width:100,sortable:false,menuDisabled:true},{header:lang("trainingMethods"),dataIndex:"way",width:110,sortable:false,menuDisabled:true},{header:lang("trainingCertificate"),dataIndex:"license",width:120,sortable:false,menuDisabled:true},{header:lang("remark"),dataIndex:"notes",width:110,sortable:false,menuDisabled:true},{header:lang("opt"),dataIndex:"id",width:65,sortable:false,menuDisabled:true,renderer:this.operation},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({style:"border-left-width:1px;",displayInfo:true,store:this.store,pageSize:15,listeners:{beforechange:function(b,c){Ext.apply(c,a.storeBar)}}});this.list=new Ext.grid.GridPanel({stripeRows:true,region:"center",layout:"fit",border:false,store:this.store,loadMask:{msg:lang("waiting")},cm:this.colModel,sm:this.sm,hideBorders:true,listeners:{rowdblclick:function(b,c){var d=a.list.getSelectionModel().getSelections();a.edit_id=d[0].get("id");a.viewDetails(a.edit_id)}},tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){this.store.reload()}.createDelegate(this)},{text:lang("add"),iconCls:"icon-utils-s-add",handler:function(){a.type="addDetails";a.mkAddEditPanel()}},{handler:function(b,c){var d=a.list.getSelectionModel().getSelections();if(d.length==0){CNOA.miniMsg.alertShowAt(b,lang("mustSelectOneRow"))}else{a.type="editDetails";a.edit_id=d[0].get("id");a.mkAddEditPanel()}}.createDelegate(this),iconCls:"icon-utils-s-edit",text:lang("modify")},{text:lang("del"),iconCls:"icon-utils-s-delete",handler:function(b){a.deleteList(b)}},"<span class='cnoa_color_gray'>"+lang("dblClickToView")+"</span>","->",{xtype:"cnoa_helpBtn",helpid:151}],bbar:this.pagingBar});return this.list},mkAddEditPanel:function(){this.baseField=[{xtype:"fieldset",title:lang("trainManagement"),defaults:{style:{marginBottom:"5px"},border:false},items:[{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"textfield",name:"title",fieldLabel:lang("peixunZT"),width:190}]},{xtype:"panel",layout:"form",items:[{xtype:"textfield",name:"price",fieldLabel:lang("TrainingCosts"),width:190}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"stime",fieldLabel:lang("startDate"),width:190}]},{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"etime",fieldLabel:lang("endDate"),width:190}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"textfield",name:"type",fieldLabel:lang("trainingType"),width:190}]},{xtype:"panel",layout:"form",items:[{xtype:"textfield",name:"way",fieldLabel:lang("trainingMethods"),width:190}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"textfield",name:"license",fieldLabel:lang("trainingCertificate"),width:190}]}]},{xtype:"textarea",width:490,name:"place",fieldLabel:lang("trainLocation")},{xtype:"textarea",width:490,name:"content",fieldLabel:lang("peixunContent")},{xtype:"textarea",width:490,name:"notes",fieldLabel:lang("remark")},{xtype:"flashfile",name:"document",fieldLabel:lang("addDocument"),style:"margin-top:5px;",inputPre:"filesUpload"}]}];this.formPanel=new Ext.form.FormPanel({hideBorders:true,border:false,waitMsgTarget:true,layout:"border",labelWidth:90,bodyStyle:"border-left-width:1px;",labelAlign:"right",items:[{xtype:"panel",border:false,bodyStyle:"padding:10px",layout:"form",region:"center",autoScroll:true,items:[this.baseField]}]});this.addEditWindow=new Ext.Window({layout:"fit",width:660,height:makeWindowHeight(520),title:"添加培训记录",resizable:false,modal:true,items:[this.formPanel],buttons:[{text:lang("save"),iconCls:"icon-btn-save",handler:function(){this.submitForm()}.createDelegate(this)},{text:lang("close"),iconCls:"icon-dialog-cancel",handler:function(){this.close()}.createDelegate(this)}]});this.addEditWindow.show();if(this.type=="editDetails"){this.loadFormData()}},deleteList:function(a){var c=this;var b=this.list.getSelectionModel().getSelections();if(b.length==0){CNOA.miniMsg.alertShowAt(a,lang("mustSelectOneRow"))}else{CNOA.msg.cf(lang("confirmToDelete"),function(e){if(e=="yes"){if(b){var f="";for(var d=0;d<b.length;d++){f+=b[d].get("id")+","}c.deleteData(f)}}})}},deleteData:function(a){var b=this;Ext.Ajax.request({url:this.baseUrl+"&task=delete&type=peixun",method:"POST",params:{ids:a},success:function(d){var c=Ext.decode(d.responseText);if(c.success===true){CNOA.msg.notice(c.msg,lang("hrMgr"));b.store.reload()}else{CNOA.msg.alert(c.msg)}}})},show:function(){this.addEditWindow.show()},close:function(){this.addEditWindow.close()},operation:function(a){return"<a href='javascript:void(0)' class='gridview' onclick='CNOA_hr_person_peixunManage.viewDetails("+a+")'>"+lang("view")+"</a>"},viewDetails:function(a){var b=this;x=(screen.availWidth-850)/2;y=(screen.availHeight-600)/2;window.open(b.baseUrl+"&task=loadPage&from=viewDetails&type=peixun&ID="+a+"&personID="+CNOA.hr.person.manage.addDetails.personID,"peixunView","width=890,height=500,left="+x+",top="+y+",scrollbars=yes,resizable=yes,status=no")},loadFormData:function(){var a=this;this.formPanel.getForm().load({url:a.baseUrl+"&task=getList&type=peixun&edit=modify",params:{id:a.edit_id},method:"POST",waitMsg:lang("waiting"),failure:function(b,c){CNOA.msg.alert(c.result.msg,function(){a.close()})}.createDelegate(this)})},submitForm:function(){var a=this;if(a.formPanel.getForm().isValid()){a.formPanel.getForm().submit({url:a.baseUrl+"&task="+a.type+"&type=peixun&id="+a.edit_id+"&personID="+CNOA.hr.person.manage.addDetails.personID,waitMsg:lang("waiting"),method:"POST",success:function(b,c){CNOA.msg.notice(c.result.msg,lang("hrMgr"));this.addEditWindow.close();a.store.reload()}.createDelegate(this),failure:function(b,c){CNOA.msg.alert(c.result.msg)}.createDelegate(this)})}}};var CNOA_hr_person_licenseManageClass,CNOA_hr_person_licenseManage;CNOA_hr_person_licenseManageClass=CNOA.Class.create();CNOA_hr_person_licenseManageClass.prototype={init:function(){var g=this;this.edit_id=0;this.type="addDetails";g.baseUrl="index.php?app=hr&func=person&action=manage";this.storeBar={title:"",number:"",type:"",stime:"",etime:"",status:""};var e=Ext.id();var d=Ext.id();var f=Ext.id();var b=Ext.id();var c=Ext.id();var a=Ext.id();this.mainPanel=new Ext.Panel({title:lang("certificateMgr"),layout:"border",border:false,items:this.mkMainPanel(),tbar:[lang("name")+": ",{xtype:"textfield",id:e,width:100},lang("bianHao")+": ",{xtype:"textfield",id:d,width:100},lang("certificateType")+": ",new Ext.form.ComboBox({id:f,name:"licenseType",store:new Ext.data.SimpleStore({fields:["value","licenseType"],data:[["5",lang("driverLicense")],["4",lang("healthCertificate")],["3",lang("zZZ")],["2",lang("skillCertificate")],["1",lang("other")]]}),width:160,hiddenName:"licenseType",valueField:"licenseType",displayField:"licenseType",mode:"local",triggerAction:"all"}),lang("certifaicateStatus"),new Ext.form.ComboBox({fieldLabel:lang("IDproperties"),name:"licenseStatus",store:new Ext.data.SimpleStore({fields:["value","licenseStatus"],data:[["3",lang("noEffect")],["2",lang("active")],["1",lang("daoqi")]]}),id:a,width:80,hiddenName:"licenseStatus",valueField:"licenseStatus",displayField:"licenseStatus",mode:"local",triggerAction:"all"}),lang("enableTime")+": ",{xtype:"datefield",width:100,format:"Y-m-d",id:b},lang("expireTime")+": ",{xtype:"datefield",width:100,format:"Y-m-d",id:c},{xtype:"button",text:lang("search"),style:"margin-left:5px",handler:function(){g.storeBar.title=Ext.getCmp(e).getValue();g.storeBar.number=Ext.getCmp(d).getValue();g.storeBar.type=Ext.getCmp(f).getValue();g.storeBar.status=Ext.getCmp(a).getValue();g.storeBar.stime=Ext.getCmp(b).getRawValue();g.storeBar.etime=Ext.getCmp(c).getRawValue();g.store.load({params:g.storeBar})}},{xtype:"button",text:lang("clear"),handler:function(){Ext.getCmp(e).setValue("");Ext.getCmp(d).setValue("");Ext.getCmp(f).setValue("");Ext.getCmp(a).setValue("");Ext.getCmp(b).setValue("");Ext.getCmp(c).setValue("");g.storeBar.title="";g.storeBar.number="";g.storeBar.type="";g.storeBar.status="";g.storeBar.stime="";g.storeBar.etime="";g.store.load({params:g.storeBar})}}]})},mkMainPanel:function(){var a=this;this.fields=[{name:"id"},{name:"licenseNum"},{name:"licenseType"},{name:"licenseName"},{name:"getLicenseDate"},{name:"startLicenseDate"},{name:"endLicenseDate"},{name:"licenseStatus"},{name:"licenseOrg"},{name:"license_notes"}];this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:a.baseUrl+"&task=getList&type=license&personID="+CNOA.hr.person.manage.addDetails.personID,disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields})});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.store.load();this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),this.sm,{header:"id",dataIndex:"id",hidden:true},{header:lang("certificateNum"),dataIndex:"licenseNum",width:120,sortable:true,menuDisabled:true},{header:lang("certificateType"),dataIndex:"licenseType",width:120,sortable:false,menuDisabled:true},{header:lang("certificateName"),dataIndex:"licenseName",width:120,sortable:false,menuDisabled:true},{header:lang("getCertificateDate"),dataIndex:"getLicenseDate",width:145,sortable:false,menuDisabled:true},{header:lang("zSSXDate"),dataIndex:"startLicenseDate",width:150,sortable:false,menuDisabled:true},{header:lang("zSJS"),dataIndex:"endLicenseDate",width:125,sortable:false,menuDisabled:true},{header:lang("certifaicateStatus"),dataIndex:"licenseStatus",width:100,sortable:false,menuDisabled:true},{header:lang("fZdepartment"),dataIndex:"licenseOrg",width:125,sortable:false,menuDisabled:true},{header:lang("opt"),dataIndex:"id",width:65,sortable:false,menuDisabled:true,renderer:this.operation},{header:lang("remark"),dataIndex:"license_notes",width:80,sortable:false,menuDisabled:true},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({style:"border-left-width:1px;",displayInfo:true,store:this.store,pageSize:15,listeners:{beforechange:function(b,c){Ext.apply(c,a.storeBar)}}});this.list=new Ext.grid.GridPanel({stripeRows:true,layout:"fit",region:"center",border:false,store:this.store,loadMask:{msg:lang("waiting")},cm:this.colModel,sm:this.sm,hideBorders:true,listeners:{rowdblclick:function(b,c){var d=a.list.getSelectionModel().getSelections();a.edit_id=d[0].get("id");a.viewDetails(a.edit_id)}},tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){this.store.reload()}.createDelegate(this)},{text:lang("add"),iconCls:"icon-utils-s-add",handler:function(){a.type="addDetails";a.mkAddEditPanel()}},{handler:function(b,c){var d=a.list.getSelectionModel().getSelections();if(d.length==0){CNOA.miniMsg.alertShowAt(b,lang("mustSelectOneRow"))}else{a.type="editDetails";a.edit_id=d[0].get("id");a.mkAddEditPanel()}},iconCls:"icon-utils-s-edit",text:lang("modify")},{text:lang("del"),iconCls:"icon-utils-s-delete",handler:function(b){a.deleteList(b)}},"<span class='cnoa_color_gray'>"+lang("doubleClick")+"</span>","->",{xtype:"cnoa_helpBtn",helpid:152}],bbar:this.pagingBar});return this.list},mkAddEditPanel:function(){this.baseField=[{xtype:"fieldset",title:lang("IDPhotoMar"),defaults:{style:{marginBottom:"5px"},border:false},items:[{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"licenseNum",fieldLabel:lang("IDPhotoNum"),width:200}]},{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({fieldLabel:lang("IDPhotoType"),name:"licenseType",store:new Ext.data.SimpleStore({fields:["value","licenseType"],data:[["5",lang("driverLicense")],["4",lang("healthCertificate")],["3",lang("zZZ")],["2",lang("skillCertificate")],["1",lang("other")],["0","　　　　"]]}),width:200,hiddenName:"licenseType",valueField:"licenseType",displayField:"licenseType",mode:"local",triggerAction:"all"})]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"licenseName",fieldLabel:lang("IDPhotoName"),width:200}]},{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"getLicenseDate",fieldLabel:lang("qZDAte"),width:200}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"startLicenseDate",fieldLabel:lang("enableTime"),width:200}]},{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"endLicenseDate",fieldLabel:lang("endDate"),width:200}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({fieldLabel:lang("IDproperties"),name:"licenseStatus",store:new Ext.data.SimpleStore({fields:["value","licenseStatus"],data:[["3",lang("noEffect")],["2",lang("active")],["1",lang("daoqi")],["0","　　　　"]]}),width:200,hiddenName:"licenseStatus",valueField:"licenseStatus",displayField:"licenseStatus",mode:"local",triggerAction:"all"})]}]},{xtype:"textarea",name:"licenseOrg",fieldLabel:lang("fZJG"),width:495},{xtype:"textarea",name:"license_notes",fieldLabel:lang("remark"),width:495},{xtype:"flashfile",name:"document",fieldLabel:lang("addDocument"),style:"margin-top:5px;",inputPre:"filesUpload"}]}];this.formPanel=new Ext.form.FormPanel({hideBorders:true,border:false,waitMsgTarget:true,layout:"border",labelWidth:90,bodyStyle:"border-left-width:1px;",labelAlign:"right",items:[{xtype:"panel",border:false,bodyStyle:"padding:10px",layout:"form",region:"center",autoScroll:true,items:[this.baseField]}]});this.addEditWindow=new Ext.Window({layout:"fit",width:660,height:makeWindowHeight(480),title:lang("hrMgr"),resizable:false,modal:true,items:[this.formPanel],buttons:[{text:lang("save"),iconCls:"icon-btn-save",handler:function(){this.submitForm()}.createDelegate(this)},{text:lang("close"),iconCls:"icon-dialog-cancel",handler:function(){this.close()}.createDelegate(this)}]});this.addEditWindow.show();if(this.type=="editDetails"){this.loadFormData()}},deleteList:function(a){var c=this;var b=this.list.getSelectionModel().getSelections();if(b.length==0){CNOA.miniMsg.alertShowAt(a,lang("mustSelectOneRow"))}else{CNOA.msg.cf(lang("confirmToDelete"),function(e){if(e=="yes"){if(b){var f="";for(var d=0;d<b.length;d++){f+=b[d].get("id")+","}c.deleteData(f)}}})}},deleteData:function(a){var b=this;Ext.Ajax.request({url:this.baseUrl+"&task=delete&type=license",method:"POST",params:{ids:a},success:function(d){var c=Ext.decode(d.responseText);if(c.success===true){CNOA.msg.notice(c.msg,lang("hrMgr"));b.store.reload()}else{CNOA.msg.alert(c.msg)}}})},show:function(){this.addEditWindow.show()},close:function(){this.addEditWindow.close()},operation:function(a){return"<a href='javascript:void(0)' class='gridview' onclick='CNOA_hr_person_licenseManage.viewDetails("+a+")'>"+lang("view")+"</a>"},viewDetails:function(a){var b=this;x=(screen.availWidth-850)/2;y=(screen.availHeight-600)/2;window.open(b.baseUrl+"&task=loadPage&from=viewDetails&type=license&ID="+a+"&personID="+CNOA.hr.person.manage.addDetails.personID,"licenseView","width=890,height=500,left="+x+",top="+y+",scrollbars=yes,resizable=yes,status=no")},loadFormData:function(){var a=this;this.formPanel.getForm().load({url:a.baseUrl+"&task=getList&type=license&edit=modify",params:{id:a.edit_id},method:"POST",waitMsg:lang("waiting"),success:function(b,c){},failure:function(b,c){CNOA.msg.alert(c.result.msg,function(){a.close()})}.createDelegate(this)})},submitForm:function(){var a=this;if(a.formPanel.getForm().isValid()){a.formPanel.getForm().submit({url:a.baseUrl+"&task="+a.type+"&type=license&id="+a.edit_id+"&personID="+CNOA.hr.person.manage.addDetails.personID,waitMsg:lang("waiting"),method:"POST",success:function(b,c){CNOA.msg.notice(c.result.msg,lang("hrMgr"));this.addEditWindow.close();a.store.reload()}.createDelegate(this),failure:function(b,c){CNOA.msg.alert(c.result.msg)}.createDelegate(this)})}}};var CNOA_hr_person_prizeManageClass,CNOA_hr_person_prizeManage;CNOA_hr_person_prizeManageClass=CNOA.Class.create();CNOA_hr_person_prizeManageClass.prototype={init:function(){var e=this;this.edit_id=0;this.type="addDetails";e.baseUrl="index.php?app=hr&func=person&action=manage";this.storeBar={property:"",s_money:"",e_money:"",type:""};var a=Ext.id();var c=Ext.id();var b=Ext.id();var d=Ext.id();this.mainPanel=new Ext.Panel({title:lang("awardAndPunishment"),layout:"border",border:false,items:this.mkMainPanel(),tbar:[lang("aAndPproject")+": ",new Ext.form.ComboBox({name:"prizeType",store:new Ext.data.SimpleStore({fields:["value","prizeType"],data:[["4",lang("activeJoinWork")],["3",lang("notBeLateAndEarly")],["2",lang("weiGui")],["1",lang("oftenLateAndLeave")]]}),id:d,width:180,hiddenName:"prizeType",valueField:"prizeType",displayField:"prizeType",mode:"local",triggerAction:"all"}),lang("amountFrom")+": ",{xtype:"textfield",id:c,width:80},lang("to")+": ",{xtype:"textfield",id:b,width:80},lang("jFSX")+": ",new Ext.form.ComboBox({name:"prizeProperty",store:new Ext.data.SimpleStore({fields:["value","prizeProperty"],data:[["2",lang("jFSX")],["1",lang("punishment")]]}),id:a,width:200,hiddenName:"prizeProperty",valueField:"value",displayField:"prizeProperty",mode:"local",triggerAction:"all",forceSelection:true,editable:false}),{xtype:"button",text:lang("search"),style:"margin-left:5px",handler:function(){e.storeBar.property=Ext.getCmp(a).getValue();e.storeBar.s_money=Ext.getCmp(c).getValue();e.storeBar.e_money=Ext.getCmp(b).getValue();e.storeBar.type=Ext.getCmp(d).getValue();e.store.load({params:e.storeBar})}},{xtype:"button",text:lang("clear"),handler:function(){Ext.getCmp(a).setValue("");Ext.getCmp(c).setValue("");Ext.getCmp(b).setValue("");Ext.getCmp(d).setValue("");e.storeBar.property="";e.storeBar.s_money="";e.storeBar.e_money="";e.storeBar.type="";e.store.load({params:e.storeBar})}}]})},mkMainPanel:function(){var a=this;this.fields=[{name:"id"},{name:"prizeType"},{name:"prizeDate"},{name:"prizeWorkDate"},{name:"prizeProperty"},{name:"prizeValue"},{name:"prizeNotes"},{name:"prize_notes"}];this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:a.baseUrl+"&task=getList&type=prize&personID="+CNOA.hr.person.manage.addDetails.personID,disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields})});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.store.load();this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),this.sm,{header:"id",dataIndex:"id",hidden:true},{header:lang("aAndPproject"),dataIndex:"prizeType",width:220,sortable:true,menuDisabled:true},{header:lang("awardDate"),dataIndex:"prizeDate",width:110,sortable:false,menuDisabled:true},{header:lang("takeEffectWages"),dataIndex:"prizeWorkDate",width:130,sortable:false,menuDisabled:true},{header:lang("winProperty"),dataIndex:"prizeProperty",width:110,sortable:false,menuDisabled:true},{header:lang("jFamount"),dataIndex:"prizeValue",width:200,sortable:false,menuDisabled:true},{header:lang("jFexplain"),dataIndex:"prizeNotes",width:180,sortable:false,menuDisabled:true},{header:lang("opt"),dataIndex:"id",width:65,sortable:false,menuDisabled:true,renderer:this.operation},{header:lang("remark"),dataIndex:"prize_notes",width:120,sortable:false,menuDisabled:true},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({style:"border-left-width:1px;",displayInfo:true,store:this.store,pageSize:15,listeners:{beforechange:function(b,c){Ext.apply(c,a.storeBar)}}});this.list=new Ext.grid.GridPanel({stripeRows:true,region:"center",layout:"fit",border:false,store:this.store,loadMask:{msg:lang("waiting")},cm:this.colModel,sm:this.sm,hideBorders:true,listeners:{rowdblclick:function(b,c){var d=a.list.getSelectionModel().getSelections();a.edit_id=d[0].get("id");a.viewDetails(a.edit_id)}},tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){this.store.reload()}.createDelegate(this)},{text:lang("add"),iconCls:"icon-utils-s-add",handler:function(){a.type="addDetails";a.mkAddEditPanel()}},{handler:function(b,c){var d=a.list.getSelectionModel().getSelections();if(d.length==0){CNOA.miniMsg.alertShowAt(b,lang("mustSelectOneRow"))}else{a.type="editDetails";a.edit_id=d[0].get("id");a.mkAddEditPanel()}}.createDelegate(this),iconCls:"icon-utils-s-edit",text:lang("modify")},{text:lang("del"),iconCls:"icon-utils-s-delete",handler:function(b){a.deleteList(b)}},"<span class='cnoa_color_gray'>"+lang("dblClickToView")+"</span>","->",{xtype:"cnoa_helpBtn",helpid:151}],bbar:this.pagingBar});return this.list},mkAddEditPanel:function(){this.baseField=[{xtype:"fieldset",title:lang("awardAndPunishment"),defaults:{style:{marginBottom:"5px"},border:false},items:[{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({fieldLabel:lang("aAndPproject"),name:"prizeType",store:new Ext.data.SimpleStore({fields:["value","prizeType"],data:[["4",lang("activeJoinWork")],["3",lang("notBeLateAndEarly")],["2",lang("weiGui")],["1",lang("oftenLateAndLeave")],["0","　　　　"]]}),width:190,hiddenName:"prizeType",valueField:"prizeType",displayField:"prizeType",mode:"local",triggerAction:"all"})]},{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"prizeDate",fieldLabel:lang("jFdate"),width:190}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"prizeWorkDate",fieldLabel:lang("takeEffectWages"),width:190}]},{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({fieldLabel:lang("winProperty"),name:"prizeProperty",store:new Ext.data.SimpleStore({fields:["value","prizeProperty"],data:[["2",lang("reward")],["1",lang("punishment")],["0","　　　　"]]}),width:190,hiddenName:"prizeProperty",valueField:"value",displayField:"prizeProperty",mode:"local",triggerAction:"all",forceSelection:true,editable:false})]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"prizeValue",fieldLabel:lang("jFamount"),width:190}]}]},{xtype:"textarea",name:"prizeNotes",fieldLabel:lang("jFexplain"),width:490},{xtype:"textarea",name:"prize_notes",fieldLabel:lang("remark"),width:490},{xtype:"flashfile",name:"document",fieldLabel:lang("addDocument"),style:"margin-top:5px;",inputPre:"filesUpload"}]}];this.formPanel=new Ext.form.FormPanel({hideBorders:true,border:false,waitMsgTarget:true,layout:"border",labelWidth:90,bodyStyle:"border-left-width:1px;",labelAlign:"right",items:[{xtype:"panel",border:false,bodyStyle:"padding:10px",layout:"form",region:"center",autoScroll:true,items:[this.baseField]}]});this.addEditWindow=new Ext.Window({layout:"fit",width:660,height:makeWindowHeight(450),title:lang("addNewRewardAndPunish"),resizable:false,modal:true,items:[this.formPanel],buttons:[{text:lang("save"),iconCls:"icon-btn-save",handler:function(){this.submitForm()}.createDelegate(this)},{text:lang("close"),iconCls:"icon-dialog-cancel",handler:function(){this.close()}.createDelegate(this)}]});this.addEditWindow.show();if(this.type=="editDetails"){this.loadFormData()}},deleteList:function(a){var c=this;var b=this.list.getSelectionModel().getSelections();if(b.length==0){CNOA.miniMsg.alertShowAt(a,lang("mustSelectOneRow"))}else{CNOA.msg.cf(lang("confirmToDelete"),function(e){if(e=="yes"){if(b){var f="";for(var d=0;d<b.length;d++){f+=b[d].get("id")+","}c.deleteData(f)}}})}},deleteData:function(a){var b=this;Ext.Ajax.request({url:this.baseUrl+"&task=delete&type=prize",method:"POST",params:{ids:a},success:function(d){var c=Ext.decode(d.responseText);if(c.success===true){CNOA.msg.notice(c.msg,lang("hrMgr"));b.store.reload()}else{CNOA.msg.alert(c.msg)}}})},show:function(){this.addEditWindow.show()},close:function(){this.addEditWindow.close()},operation:function(a){return"<a href='javascript:void(0)' class='gridview' onclick='CNOA_hr_person_prizeManage.viewDetails("+a+")'>"+lang("view")+"</a>"},viewDetails:function(a){var b=this;x=(screen.availWidth-850)/2;y=(screen.availHeight-600)/2;window.open(b.baseUrl+"&task=loadPage&from=viewDetails&type=prize&ID="+a+"&personID="+CNOA.hr.person.manage.addDetails.personID,"prizeView","width=890,height=500,left="+x+",top="+y+",scrollbars=yes,resizable=yes,status=no")},loadFormData:function(){var a=this;this.formPanel.getForm().load({url:a.baseUrl+"&task=getList&type=prize&edit=modify",params:{id:a.edit_id},method:"POST",waitMsg:lang("waiting"),failure:function(b,c){CNOA.msg.alert(c.result.msg,function(){a.close()})}.createDelegate(this)})},submitForm:function(){var a=this;if(a.formPanel.getForm().isValid()){a.formPanel.getForm().submit({url:a.baseUrl+"&task="+a.type+"&type=prize&id="+a.edit_id+"&personID="+CNOA.hr.person.manage.addDetails.personID,waitMsg:lang("waiting"),method:"POST",success:function(b,c){CNOA.msg.notice(c.result.msg,lang("hrMgr"));this.addEditWindow.close();a.store.reload()}.createDelegate(this),failure:function(b,c){CNOA.msg.alert(c.result.msg)}.createDelegate(this)})}}};var CNOA_hr_person_contractManageClass,CNOA_hr_person_contractManage;CNOA_hr_person_contractManageClass=CNOA.Class.create();CNOA_hr_person_contractManageClass.prototype={init:function(){var f=this;this.edit_id=0;this.type="addDetails";this.baseUrl="index.php?app=hr&func=person&action=manage";this.storeBar={title:"",number:"",type:"",stime:"",etime:""};var d=Ext.id();var c=Ext.id();var e=Ext.id();var a=Ext.id();var b=Ext.id();this.mainPanel=new Ext.Panel({title:lang("contractMgr"),layout:"border",border:false,items:this.mkMainPanel(),tbar:[lang("title")+": ",{xtype:"textfield",id:d,width:100},lang("bianHao")+": ",{xtype:"textfield",id:c,width:100},lang("contractType")+": ",new Ext.form.ComboBox({id:e,name:"contractType",store:new Ext.data.SimpleStore({fields:["valueType","contractType"],data:[["3",lang("laborContract")],["2",lang("bMHT")],["1",lang("other")]]}),width:150,hiddenName:"contractType",valueField:"contractType",displayField:"contractType",mode:"local",triggerAction:"all"}),lang("enableTime")+": ",{xtype:"datefield",width:100,format:"Y-m-d",id:a},lang("expireTime")+": ",{xtype:"datefield",width:100,format:"Y-m-d",id:b},{xtype:"button",text:lang("search"),style:"margin-left:5px",handler:function(){f.storeBar.title=Ext.getCmp(d).getValue();f.storeBar.number=Ext.getCmp(c).getValue();f.storeBar.type=Ext.getCmp(e).getValue();f.storeBar.stime=Ext.getCmp(a).getRawValue();f.storeBar.etime=Ext.getCmp(b).getRawValue();f.store.load({params:f.storeBar})}},{xtype:"button",text:lang("clear"),handler:function(){f.storeBar.title=Ext.getCmp(d).setValue("");f.storeBar.number=Ext.getCmp(c).setValue("");f.storeBar.type=Ext.getCmp(e).setValue("");f.storeBar.stime=Ext.getCmp(a).setValue("");f.storeBar.etime=Ext.getCmp(b).setValue("");f.storeBar.title="";f.storeBar.number="";f.storeBar.type="";f.storeBar.stime="";f.storeBar.etime="";f.store.load({params:f.storeBar})}}]})},mkMainPanel:function(){var a=this;this.fields=[{name:"id"},{name:"contractTitle"},{name:"contractNum"},{name:"contractType"},{name:"contractProperty"},{name:"contractStatus"},{name:"contractStartTime"},{name:"contractEndTime"},{name:"signedNum"},{name:"contract_notes"}];this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:a.baseUrl+"&task=getList&type=contract&personID="+CNOA.hr.person.manage.addDetails.personID,disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields})});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.store.load();this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),this.sm,{header:"id",dataIndex:"id",hidden:true},{header:lang("contractTitle"),dataIndex:"contractTitle",width:160,sortable:true,menuDisabled:true},{header:lang("contractNO"),dataIndex:"contractNum",width:150,sortable:false,menuDisabled:true},{header:lang("contractType"),dataIndex:"contractType",width:90,sortable:false,menuDisabled:true},{header:lang("hTshuXing"),dataIndex:"contractProperty",width:125,sortable:false,menuDisabled:true},{header:lang("contractStatus"),dataIndex:"contractStatus",width:100,sortable:false,menuDisabled:true},{header:lang("contractEffTime"),dataIndex:"contractStartTime",width:130,sortable:false,menuDisabled:true},{header:lang("contractEtime"),dataIndex:"contractEndTime",width:110,sortable:false,menuDisabled:true},{header:lang("contractNum"),dataIndex:"signedNum",width:105,sortable:false,menuDisabled:true},{header:lang("opt"),dataIndex:"id",width:65,sortable:false,menuDisabled:true,renderer:this.operation},{header:lang("remark"),dataIndex:"contract_notes",width:120,sortable:false,menuDisabled:true},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({style:"border-left-width:1px;",displayInfo:true,store:this.store,pageSize:15,listeners:{beforechange:function(b,c){Ext.apply(c,a.storeBar)}}});this.list=new Ext.grid.GridPanel({stripeRows:true,region:"center",layout:"fit",border:false,store:this.store,loadMask:{msg:lang("waiting")},cm:this.colModel,sm:this.sm,hideBorders:true,listeners:{rowdblclick:function(b,c){var d=a.list.getSelectionModel().getSelections();a.edit_id=d[0].get("id");a.viewDetails(a.edit_id)}},tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){this.store.reload()}.createDelegate(this)},{text:lang("add"),iconCls:"icon-utils-s-add",handler:function(){a.type="addDetails";a.mkAddEditPanel()}},{handler:function(b,c){var d=a.list.getSelectionModel().getSelections();if(d.length==0){CNOA.miniMsg.alertShowAt(b,lang("mustSelectOneRow"))}else{a.type="editDetails";a.edit_id=d[0].get("id");a.mkAddEditPanel()}},iconCls:"icon-utils-s-edit",text:lang("modify")},{text:lang("del"),iconCls:"icon-utils-s-delete",handler:function(b){a.deleteList(b)}},"<span class='cnoa_color_gray'>"+lang("dblClickToView")+"</span>","->",{xtype:"cnoa_helpBtn",helpid:150}],bbar:this.pagingBar});return this.list},mkAddEditPanel:function(){this.baseField=[{xtype:"fieldset",title:lang("contractMgr"),defaults:{style:{marginBottom:"5px"},border:false},items:[{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"contractTitle",fieldLabel:lang("contractTitle"),width:195}]},{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"contractNum",fieldLabel:lang("contractNO"),width:195}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({fieldLabel:lang("contractType"),name:"contractType",store:new Ext.data.SimpleStore({fields:["valueType","contractType"],data:[["3",lang("laborContract")],["2",lang("bMHT")],["1",lang("other")],["0","　　　　"]]}),width:195,hiddenName:"contractType",valueField:"contractType",displayField:"contractType",mode:"local",triggerAction:"all"})]},{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({fieldLabel:lang("hTshuXing"),name:"contractProperty",store:new Ext.data.SimpleStore({fields:["value","contractProperty"],data:[["2",lang("wGDDate")],["1",lang("yGDDate")],["0","　　　　"]]}),width:195,hiddenName:"contractProperty",valueField:"value",displayField:"contractProperty",mode:"local",triggerAction:"all",forceSelection:true,editable:false})]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({fieldLabel:lang("contractStatus"),name:"contractStatus",store:new Ext.data.SimpleStore({fields:["value","contractStatus"],data:[["3",lang("onTrial")],["2",lang("yZZ")],["1",lang("yJC")],["0","　　　　"]]}),width:195,hiddenName:"contractStatus",valueField:"value",displayField:"contractStatus",mode:"local",triggerAction:"all",forceSelection:true,editable:false})]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"contractStartTime",fieldLabel:lang("contractEffTime"),width:195}]},{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"contractEndTime",fieldLabel:lang("contractEtime"),width:195}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"contractDeadTime",fieldLabel:lang("hTJCSJ"),width:195}]},{xtype:"panel",layout:"form",items:[{xtype:"checkbox",boxLabel:lang("sFDQTX"),name:"notice",width:195,style:"margin-left:5px;margin-top:3px;",checked:true}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",autoWidth:true,defaults:{border:false},layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"signedNum",fieldLabel:lang("contractNum"),width:195}]}]},{xtype:"textarea",name:"contract_notes",fieldLabel:lang("remark"),width:490},{xtype:"flashfile",name:"document",fieldLabel:lang("addDocument"),style:"margin-top:5px;",inputPre:"filesUpload"}]}];this.formPanel=new Ext.form.FormPanel({hideBorders:true,border:false,waitMsgTarget:true,layout:"border",labelWidth:90,bodyStyle:"border-left-width:1px;",labelAlign:"right",items:[{xtype:"panel",border:false,bodyStyle:"padding:10px",layout:"form",region:"center",autoScroll:true,items:[this.baseField]}]});this.addEditWindow=new Ext.Window({layout:"fit",width:660,height:makeWindowHeight(460),title:lang("addContravt"),resizable:false,modal:true,items:[this.formPanel],buttons:[{text:lang("save"),iconCls:"icon-btn-save",handler:function(){this.submitForm()}.createDelegate(this)},{text:lang("close"),iconCls:"icon-dialog-cancel",handler:function(){this.close()}.createDelegate(this)}]});this.addEditWindow.show();if(this.type=="editDetails"){this.loadFormData()}},deleteList:function(a){var c=this;var b=this.list.getSelectionModel().getSelections();if(b.length==0){CNOA.miniMsg.alertShowAt(a,lang("mustSelectOneRow"))}else{CNOA.msg.cf(lang("confirmToDelete"),function(e){if(e=="yes"){if(b){var f="";for(var d=0;d<b.length;d++){f+=b[d].get("id")+","}c.deleteData(f)}}})}},deleteData:function(a){var b=this;Ext.Ajax.request({url:this.baseUrl+"&task=delete&type=contract",method:"POST",params:{ids:a},success:function(d){var c=Ext.decode(d.responseText);if(c.success===true){CNOA.msg.notice(c.msg,lang("hrMgr"));b.store.reload()}else{CNOA.msg.alert(c.msg)}}})},show:function(){this.addEditWindow.show()},close:function(){this.addEditWindow.close()},operation:function(a){return"<a href='javascript:void(0)' class='gridview' onclick='CNOA_hr_person_contractManage.viewDetails("+a+")'>"+lang("view")+"</a>"},viewDetails:function(a){var b=this;x=(screen.availWidth-850)/2;y=(screen.availHeight-600)/2;window.open(b.baseUrl+"&task=loadPage&from=viewDetails&type=contract&ID="+a+"&personID="+CNOA.hr.person.manage.addDetails.personID,"contractView","width=890,height=500,left="+x+",top="+y+",scrollbars=yes,resizable=yes,status=no")},loadFormData:function(){var a=this;this.formPanel.getForm().load({url:a.baseUrl+"&task=getList&type=contract&edit=modify",params:{id:a.edit_id},method:"POST",waitMsg:lang("waiting"),success:function(b,c){},failure:function(b,c){CNOA.msg.alert(c.result.msg,function(){a.close()})}.createDelegate(this)})},submitForm:function(){var a=this;if(a.formPanel.getForm().isValid()){a.formPanel.getForm().submit({url:a.baseUrl+"&task="+a.type+"&type=contract&id="+a.edit_id+"&personID="+CNOA.hr.person.manage.addDetails.personID,waitMsg:lang("waiting"),method:"POST",success:function(b,c){CNOA.msg.notice(c.result.msg,lang("hrMgr"));this.addEditWindow.close();a.store.reload()}.createDelegate(this),failure:function(b,c){CNOA.msg.alert(c.result.msg)}.createDelegate(this)})}}};var CNOA_hr_person_newPersonDataManageClass,CNOA_hr_person_newPersonDataManage;CNOA_hr_person_newPersonDataManageClass=CNOA.Class.create();CNOA_hr_person_newPersonDataManageClass.prototype={init:function(){var a=this;this.edit_id=0;this.ID_PERSON_GROUP=Ext.id();this.ID_KZ_SEARCH=Ext.id();this.ID_KZ_FIELD=Ext.id();this.ID_BIRTHDAY=Ext.id();this.ID_AGE=Ext.id();this.type="addDetails";this.view="hidden";a.baseUrl="index.php?app=hr&func=person&action=manage";this.TYPE_ZAIZHI=0;this.TYPE_YUANGONG=1;this.TYPE_HUNYIN=2;this.TYPE_HUKOU=3;this.TYPE_XUELI=4;this.TYPE_XUEWEI=5;this.TYPE_ZHICHENG=6;this.searchPar={truename:"",searchStationid:"0",deptID:0,deptName:"",systemOA:0,gender:"",status:"",marrage:"",politics:"",huKouType:"",workType:"",highestSchool:"",ruZhiTime:"",ruZhiTimeEnd:"",actualDate:"",actualDateEnd:"",workStatus:""};this.mainPanel=this.mkMainPanel()},getDropStore:function(a){var b=this;b.dropdownstore=new Ext.data.Store({autoLoad:true,proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getList&type=getdropstore&id="+a}),reader:new Ext.data.JsonReader({root:"data",fields:[{name:"id"},{name:"value"}]})});return b.dropdownstore},mkMainPanel:function(){var a=this;this.fields=[{name:"pid"},{name:"truename"},{name:"system"},{name:"gender"},{name:"deptName"},{name:"stationName"},{name:"cellPhone"},{name:"email"},{name:"qqNum"},{name:"ruZhiTime"},{name:"workStatus"}];this.pagingBar=new Ext.PagingToolbar({displayInfo:true,store:this.store,pageSize:15});this.list=new Ext.grid.CustomGridPanel({searchStore:a.searchPar,border:false,customFiledUrl:this.baseUrl+"&task=getList&type=getCustomField",storeUrl:this.baseUrl+"&task=getList&type=personBaseData",otherField:[{header:lang("add"),dataIndex:"pid",width:110,sortable:false,menuDisabled:true,renderer:this.manage},{header:lang("opt"),dataIndex:"pid",width:60,sortable:false,menuDisabled:true,renderer:this.operation.createDelegate(this)}],listeners:{rowdblclick:function(b,c){var d=a.list.getSelectionModel().getSelections();a.edit_id=d[0].json.pid;a.viewDetails(a.edit_id)},destroy:function(){if(a.searchWindow){a.searchWindow.destroy()}}},tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){a.list.store.reload()}},{text:lang("addNewYuan"),iconCls:"icon-utils-s-add",cls:"btn-blue4",handler:function(){a.type="addDetails";a.mkAddEditPanel()}},{handler:function(b,c){var d=a.list.getSelectionModel().getSelections();if(d.length==0){CNOA.miniMsg.alertShowAt(b,lang("mustSelectOneRow"))}else{a.type="editDetails";a.edit_id=d[0].json.pid;a.mkAddEditPanel()}},iconCls:"icon-utils-s-edit",text:lang("modify")},{text:lang("del"),iconCls:"icon-utils-s-delete",handler:function(b){a.deleteList(b)}},{text:lang("search"),iconCls:"icon-hr-search",handler:function(b){a.showSearch()}},{xtype:"importButton",browseTitle:lang("hrMgr"),cls:"btn-blue3",url:a.baseUrl+"&task=import_preson"},{handler:function(b,d){rows=a.list.getSelectionModel().getSelections();var c=[];Ext.each(rows,function(f,e){c.push(f.json.pid)});a.openExportExcelWindow(c.join(","))}.createDelegate(this),iconCls:"icon-excel",cls:"btn-blue3",tooltip:lang("exportExcel"),text:lang("export2")},"<span class='cnoa_color_gray'>"+lang("doubleClick")+"</span>"],bbar:this.pagingBar});return this.list},openExportExcelWindow:function(b){var f=this;var c=function(h,g){if(a.getForm().isValid()){a.getForm().submit({url:f.baseUrl+"&task=exportExcel&step=1",waitMsg:lang("waiting"),params:{ids:h,deptID:g},method:"POST",success:function(i,j){ajaxDownload(f.baseUrl+"&task=exportExcel&file="+j.result.msg+"&step=2")},failure:function(i,j){CNOA.msg.alert(j.result.msg)}})}};var e=new Ext.form.SelectorForm({multiselect:true,selectorType:"dept",hiddenName:"deptID",fieldLabel:lang("inDepartment")});var a=new Ext.form.FormPanel({border:false,bodyStyle:"padding:10px;",waitMsgTarget:true,labelWidth:110,items:[e,{xtype:"displayfield",hideLabel:true,value:"<span style='color: red'>说明:导出所在部门的所有人事信息</span>"},{xtype:"checkbox",fieldLabel:"导出部分数据",name:"check"},{xtype:"displayfield",hideLabel:true,value:"<span style='color: red'>说明:请先选择需要导出的部分数据,导出部分数据请不要选择所在部门</span>"}]});var d=new Ext.Window({width:320,height:250,title:lang("exportPerson"),resizable:false,modal:true,layout:"fit",items:a,buttons:[{text:lang("export2"),iconCls:"icon-excel",cls:"btn-blue3",handler:function(){if(e.getValue()==" "&&a.getForm().findField("check").checked==" "){CNOA.msg.alert("请确认需要导出的数据")}else{var g=e.getValue();c(b,g)}}.createDelegate(this)},{text:lang("cancel"),iconCls:"icon-dialog-cancel",handler:function(){d.close()}.createDelegate(this)}]}).show()},openDownloadExcelWindow:function(a){var b=new Ext.Window({width:320,height:150,title:lang("downExcel"),resizable:false,modal:true,layout:"fit",bodyStyle:"padding:10px;background-color: #FFF;",html:lang("clickToDownload")+"：<br/>"+a,buttons:[{text:lang("close"),iconCls:"icon-dialog-cancel",handler:function(){b.close()}.createDelegate(this)}]}).show()},mkAddEditPanel:function(){var f=this;var a=Ext.id();this.firstCheck=true;this.uploadPhoto=[{columnWidth:0.21,bodyStyle:"text-align:center;margin-top:7px;",hideBorders:true,border:false,items:[{html:'<div style="border:1px solid #CCC;width:134px;height:134px;padding:1px;display: table-cell;vertical-align: middle;"><img style="border: 0px;overflow:hidden;max-width: 130px; max-height: 130px;" src="./resources/images/default.jpg" id="CNOA_HR_PERSONPHOTO_INFO_FACEBOX"></div>'},{xtype:"button",width:138,style:"margin-top: 20px;",text:lang("editFace"),handler:function(){new Ext.EditpicWindow({width:130,height:130,orderAttr:"orderAttr",listeners:{comfirmpic:function(h,g){$("#CNOA_HR_PERSONPHOTO_INFO_FACEBOX").attr("src",g);Ext.getCmp(a).setValue(g)}}})}}]}];var b=Ext.id();var c=Ext.id();var e=Ext.id();this.stationComboBoxDataStore=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:f.baseUrl+"&task=getList&type=status"}),reader:new Ext.data.JsonReader({root:"data",fields:[{name:"stationid"},{name:"name"}]})});this.stationComboBoxDataStore.load();this.in_dept=new Ext.form.SelectorForm({fieldLabel:lang("inDepartment"),hiddenName:"deptID",name:"dept",selectorType:"dept",multiselect:false});this.baseField=[{xtype:"fieldset",title:lang("basicInformation")+"：",width:800,layout:"table",layoutConfig:{columns:3},defaults:{layout:"form",border:false,defaults:{xtype:"textfield",width:200}},items:[{items:[{fieldLabel:lang("truename"),name:"truename",allowBlank:false},{xtype:"combo",fieldLabel:lang("birthplace"),name:"jiGuan",store:new Ext.data.SimpleStore({fields:["value","jiGuan"],data:[[0,"　"],[35,"北京"],[34,"天津"],[33,"河北"],[32,"山西"],[31,"内蒙古"],[30,"辽宁"],[29,"吉林"],[28,"黑龙江"],[27,"上海"],[26,"江苏"],[25,"浙江"],[24,"安徽"],[23,"福建"],[22,"江西"],[21,"山东"],[20,"河南"],[19,"湖北"],[18,"湖南"],[17,"广东"],[16,"广西"],[15,"海南"],[14,"重庆"],[13,"四川"],[12,"贵州"],[11,"云南"],[10,"西藏"],[9,"陕西"],[8,"甘肃"],[7,"青海"],[6,"宁夏"],[5,"新疆"],[4,"台湾"],[3,"香港"],[2,"澳门"],[1,"国外"]]}),hiddenName:"jiGuan",valueField:"jiGuan",displayField:"jiGuan",mode:"local",triggerAction:"all",forceSelection:true,editable:false},{xtype:"checkbox",boxLabel:lang("sFBind"),name:"needexamapp",width:200,style:"margin-top:3px;",listeners:{check:function(h,g){if(g){Ext.getCmp(b).setDisabled(false);f.in_dept.setDisabled(true);Ext.getCmp(e).setDisabled(true);if(f.type=="editDetails"&&f.firstCheck){f.firstCheck=false}else{f.firstCheck=false;f.in_dept.setValue("");Ext.getCmp(e).setValue("")}}else{f.firstCheck=false;Ext.getCmp(b).setDisabled(true);f.in_dept.setDisabled(false);Ext.getCmp(e).setDisabled(false);Ext.getCmp(b).setValue("")}}}},this.in_dept,{xtype:"combo",fieldLabel:lang("jobStatus"),store:this.getDropStore(this.TYPE_ZAIZHI),hiddenName:"workStatus",valueField:"id",displayField:"value",mode:"local",triggerAction:"all",forceSelection:true,editable:false},{fieldLabel:lang("bianHao"),name:"bianHao"},{fieldLabel:lang("idCardHaoMa"),allowBlank:false,name:"idCard",vtype:"idCard",vtypeText:lang("idCardHaoMaWrong")},{fieldLabel:lang("birthday"),name:"birthday",id:this.ID_BIRTHDAY,xtype:"datefield",format:"Y-m-d",listeners:{select:function(l,i){var g=l.getValue();var n=g.getTime();var h=new Date();var j=h.getTime();var k=parseInt((j-n)/1000/60/60/24);var m=parseInt(k/365);if(k-365<0){Ext.getCmp(f.ID_AGE).setValue("0")}else{Ext.getCmp(f.ID_AGE).setValue(m)}}}},{fieldLabel:"年龄",id:this.ID_AGE,readOnly:true,xtype:"textfield"},{fieldLabel:lang("vacation"),name:"vacation"},{xtype:"combo",fieldLabel:lang("huKouType"),name:"huKouType",store:this.getDropStore(this.TYPE_HUKOU),hiddenName:"huKouType",valueField:"id",displayField:"value",mode:"local",triggerAction:"all",forceSelection:true,editable:false},{xtype:"combo",fieldLabel:lang("zZMM"),name:"politics",store:new Ext.data.SimpleStore({fields:["value","politics"],data:[[0,"　"],[5,lang("masses")],[4,lang("gQTY")],[3,lang("CCP")],[2,lang("CCPPro")],[1,lang("withoutParty")]]}),hiddenName:"politics",valueField:"value",displayField:"politics",mode:"local",triggerAction:"all",forceSelection:true,editable:false},{fieldLabel:lang("profession"),name:"professor"},{xtype:"combo",fieldLabel:lang("education1"),name:"highestSchool",store:this.getDropStore(this.TYPE_XUELI),hiddenName:"highestSchool",valueField:"id",displayField:"value",mode:"local",triggerAction:"all",forceSelection:true,editable:false}]},{items:[{xtype:"combo",fieldLabel:lang("sex"),name:"gender",store:new Ext.data.SimpleStore({fields:["value","gender"],data:[[0,"　"],[1,lang("male")],[2,lang("female")]]}),hiddenName:"gender",valueField:"value",displayField:"gender",mode:"local",triggerAction:"all",forceSelection:true,editable:false},{fieldLabel:lang("national"),name:"nation"},{xtype:"userselectorfield",id:b,fieldLabel:lang("assUser"),disabled:true,hiddenName:"uid",multiSelector:false,listeners:{confirm:function(i,g,h){Ext.Ajax.request({url:f.baseUrl+"&task=loadSystemData",method:"POST",params:{uid:i.getValue()},success:function(k){var j=Ext.decode(k.responseText);if(j.success===true){f.in_dept.setValue(j.data.deptName);f.in_dept.hiddenField.setValue(j.data.deptId);Ext.getCmp(e).setValue(j.data.stationid)}else{CNOA.msg.alert(j.msg,function(){})}}})}}},{xtype:"combo",fieldLabel:lang("post"),id:e,name:"jobID",store:this.stationComboBoxDataStore,hiddenName:"stationid",valueField:"stationid",displayField:"name",mode:"local",triggerAction:"all",forceSelection:true,editable:false},{xtype:"combo",fieldLabel:lang("emploType"),name:"workType",store:this.getDropStore(this.TYPE_YUANGONG),hiddenName:"workType",valueField:"id",displayField:"value",mode:"local",triggerAction:"all",forceSelection:true,editable:false},{fieldLabel:lang("workNum"),name:"workNumber"},{fieldLabel:lang("englishName"),name:"englishName"},{xtype:"combo",fieldLabel:lang("maritalStatus"),name:"marrage",store:this.getDropStore(this.TYPE_HUNYIN),hiddenName:"marrage",valueField:"id",displayField:"value",mode:"local",triggerAction:"all",forceSelection:true,editable:false},{fieldLabel:lang("healthStatus"),name:"health"},{xtype:"datefield",fieldLabel:lang("joinPartyTime"),name:"partyTime",format:"Y-m-d"},{xtype:"datefield",fieldLabel:lang("graduationTime"),name:"graduateTime",format:"Y-m-d"},{xtype:"combo",fieldLabel:lang("degree"),name:"studySituation",store:this.getDropStore(this.TYPE_XUEWEI),hiddenName:"studySituation",valueField:"id",displayField:"value",mode:"local",triggerAction:"all",forceSelection:true,editable:false}]},{style:"padding-left:20px;padding-bottom:120px",defaults:{xtype:"panel",border:false},items:[{items:[this.uploadPhoto]},{xtype:"hidden",name:"photo",id:a}]},{colspan:3,defaults:{xtype:"textfield",width:487},items:[{fieldLabel:lang("accLocation"),name:"huKouLocation"},{fieldLabel:lang("graSchool"),name:"graduateSchool"},{xtype:"flashfile",fieldLabel:lang("addDocument"),name:"document",style:"margin-top:5px;",inputPre:"filesUpload"}]}]},{xtype:"fieldset",title:lang("linkInfo")+"：",width:800,layout:"column",defaults:{layout:"form",columnWidth:0.37,border:false,defaults:{xtype:"textfield",width:200}},items:[{items:[{fieldLabel:lang("phoneNumber"),name:"cellPhone"},{fieldLabel:lang("qqNum"),name:"qqNum"}]},{items:[{fieldLabel:lang("tel"),name:"telephone"},{fieldLabel:"MSN",name:"MSN"}]},{items:[{xtype:"datefield",fieldLabel:"起薪时间",name:"qiXinTime",format:"Y-m-d"},{xtype:"datefield",fieldLabel:"参加工作时间",name:"workStartTime",format:"Y-m-d"}]},{columnWidth:1,defaults:{xtype:"textfield",width:487},items:[{fieldLabel:lang("email"),name:"email"},{fieldLabel:lang("homeAddress"),name:"location"},{fieldLabel:lang("otherAddresss"),name:"otherContact"}]}]},{xtype:"fieldset",title:lang("personKZ"),width:800,items:[{xtype:"panel",id:f.ID_PERSON_GROUP,hideBorders:true,border:false,layout:"column",autoWidth:true,defaults:{style:{marginBottom:"5px"},border:false}},new Ext.BoxComponent({autoEl:{tag:"div",style:"margin-left:80px;margin-top:5px;margin-bottom:5px;color:#676767;",html:lang("noteHR")}})]},{xtype:"fieldset",title:lang("otherInformatin")+"：",width:800,defaults:{style:{marginBottom:"5px"},border:false},items:[{xtype:"panel",hideBorders:true,border:false,layout:"table",layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"jobType",fieldLabel:lang("duty"),width:200}]},{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({fieldLabel:lang("jobTitle"),name:"zhiCheng",store:this.getDropStore(this.TYPE_ZHICHENG),width:200,hiddenName:"zhiCheng",valueField:"id",displayField:"value",mode:"local",triggerAction:"all",forceSelection:true,editable:false})]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"datefield",format:"Y-m-d",name:"ruZhiTime",fieldLabel:lang("hiredate"),width:200,listeners:{select:function(l,i){var g=l.getValue();var n=g.getTime();var h=new Date();var j=h.getTime();var k=parseInt((j-n)/1000/60/60/24);var m=parseInt(k/365);if(k-365<0){f.formPanel.getForm().findField("workAge").setValue("0")}else{f.formPanel.getForm().findField("workAge").setValue(m)}}}}]},{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"workAge",fieldLabel:lang("GLyear"),width:200}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"totalWorkAge",fieldLabel:lang("totalAge"),width:200}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"computStand",fieldLabel:lang("computerSkills"),width:200}]},{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"language1",fieldLabel:lang("language1"),width:200}]}]},{xtype:"panel",hideBorders:true,border:false,layout:"table",layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"language2",fieldLabel:lang("language2"),width:200}]},{xtype:"panel",layout:"form",items:[{xtype:"cnoa_textfield",name:"language3",fieldLabel:lang("language3"),width:200}]}]},{xtype:"textarea",name:"specialty",fieldLabel:lang("eatures"),width:485},{xtype:"textarea",name:"jobSituation",fieldLabel:lang("jobSituation"),width:485},{xtype:"textarea",name:"sheBaoSituation",fieldLabel:lang("paymentOfSocial"),width:485},{xtype:"textarea",name:"tiJianRecorde",fieldLabel:lang("medicalRecords"),width:485},{xtype:"textarea",name:"notes",fieldLabel:lang("remark"),width:485}]}];this.formPanel=new Ext.form.FormPanel({border:false,waitMsgTarget:true,layout:"border",labelWidth:80,labelAlign:"right",items:[{xtype:"panel",border:false,bodyStyle:"padding:10px",layout:"form",region:"center",autoScroll:true,items:[this.baseField]}],listeners:{render:function(g){f.loadFormData2()}}});var d=f.type=="addDetails"?lang("addNewPerson"):lang("editStaffData");this.addEditWindow=new Ext.Window({layout:"fit",width:860,height:makeWindowHeight(600),title:d,resizable:false,modal:true,items:[this.formPanel],buttons:[{text:lang("save"),iconCls:"icon-btn-save",handler:function(){f.submitForm()}},{text:lang("close"),iconCls:"icon-dialog-cancel",handler:function(){f.close()}}]});this.addEditWindow.show();if(this.type=="editDetails"){this.loadFormData()}},deleteList:function(a){var c=this;var b=this.list.getSelectionModel().getSelections();if(b.length==0){CNOA.miniMsg.alertShowAt(a,lang("mustSelectOneRow"))}else{CNOA.msg.cf(lang("delRecordWill")+"<span class='cnoa_color_red'>"+lang("allStaff1")+"</br>"+lang("personnelData")+"</span>，"+lang("areYouDelete"),function(e){if(e=="yes"){if(b){var f="";for(var d=0;d<b.length;d++){f+=b[d].json.pid+","}c.deleteData(f)}}})}},deleteData:function(a){var b=this;Ext.Ajax.request({url:this.baseUrl+"&task=delete&type=personBaseData",method:"POST",params:{ids:a},success:function(d){var c=Ext.decode(d.responseText);if(c.success===true){CNOA.msg.notice(c.msg,lang("hrMgr"));b.list.store.reload()}else{CNOA.msg.alert(c.msg)}}})},show:function(){var a=this;this.addEditWindow.show()},close:function(){var a=this;this.addEditWindow.close()},operation:function(d,c,a){var b=a.json.pid;return"<a href='javascript:void(0)' class='gridview' onclick='CNOA_hr_person_newPersonDataManage.viewDetails("+b+")'>"+lang("view")+"</a>"},viewDetails:function(a){var b=this;x=(screen.availWidth-850)/2;y=(screen.availHeight-600)/2;window.open(b.baseUrl+"&task=loadPage&from=viewDetails&type=personBaseData&ID="+a,"personView","width=900,height=500,left="+x+",top="+y+",scrollbars=yes,resizable=yes,status=no")},loadFormData:function(){var a=this;this.formPanel.getForm().load({url:a.baseUrl+"&task=getList&type=personBaseData&edit=modify",params:{personID:a.edit_id},method:"POST",waitMsg:lang("waiting"),success:function(b,e){var g=e.result.data,c=g.needexamapp;var k=Ext.getCmp(a.ID_BIRTHDAY).getValue();if(k){var j=k.getTime();var h=new Date();var d=h.getTime();var i=parseInt((d-j)/1000/60/60/24);var f=parseInt(i/365);if(i-365<0){Ext.getCmp(a.ID_AGE).setValue("0")}else{Ext.getCmp(a.ID_AGE).setValue(f)}}a.in_dept.setValue(g.deptName);a.in_dept.hiddenField.setValue(g.deptID);if(!c){a.firstCheck=false}if(e.result.data.photo!=""){Ext.fly("CNOA_HR_PERSONPHOTO_INFO_FACEBOX").dom.src=e.result.data.photo}},failure:function(b,c){CNOA.msg.alert(c.result.msg,function(){a.close()})}})},loadFormData3:function(){var c=this;var a=Ext.id();var b=function(n){var o=n.label;var d="person_"+n.name;var g=n.xtype;var f=n.valueField;var p=n.valueField;var l=n.displayField;if(g=="combo"){var e={xtype:g,width:150,fieldLabel:o,hiddenName:f,valueField:p,displayField:l,typeAhead:true,triggerAction:"all",mode:"local",editable:false,store:new Ext.data.Store({autoLoad:true,baseParams:{key:d},proxy:new Ext.data.HttpProxy({url:c.baseUrl+"&task=addDetails&type=getComboStore",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:[{name:p},{name:l}]})})};return e}else{if(g=="user"){var m={xtype:"userselectorfield",name:p,fieldLabel:o};return m}else{if(g=="datefield"){var i={xtype:g,width:150,fieldLabel:o,name:d,format:"Y-m-d"};return i}else{if(g=="checkbox"){var j=[];Ext.each(n.columns,function(s,q){j.push({boxLabel:s.name,name:p+"["+s.id+"]"})});var k={xtype:"checkboxgroup",width:150,columns:2,items:j};return k}else{var h={xtype:g,width:150,fieldLabel:o,name:d};return h}}}}};this.findFormPanel.getForm().load({url:c.baseUrl+"&task=addDetails&type=personinfo",method:"POST",waitMsg:lang("waiting"),success:function(f,g){var e=Ext.getCmp(c.ID_KZ_SEARCH);var h="";var d="";Ext.each(g.result.data,function(m,k,l){var j=m.label;var i="person_"+m.name;var n=m.xtype;c.content_start++;e.add([{xtype:"panel",hideBorders:true,border:false,layout:"form",items:[b(m)]}]);e.doLayout()})},failure:function(d,e){CNOA.msg.alert(lang("wrong"),function(){c.close()})}})},loadFormData2:function(){var c=this;var a=Ext.id();var b=function(o){var p=o.label;var d="person_"+o.name;var h=o.xtype;var f=o.valueField;var q=o.valueField;var m=o.displayField;var g=o.allowBlank==1?false:true;if(h=="combo"){var e={xtype:h,width:200,fieldLabel:p,allowBlank:g,hiddenName:f,valueField:q,displayField:m,typeAhead:true,triggerAction:"all",mode:"local",editable:false,store:new Ext.data.Store({autoLoad:true,baseParams:{key:d},proxy:new Ext.data.HttpProxy({url:c.baseUrl+"&task=addDetails&type=getComboStore",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:[{name:q},{name:m}]}),listeners:{load:function(t){var t=c.formPanel.getForm().findField(o.valueField),s=t.getValue();t.setValue(s)}}})};return e}else{if(h=="user"){var n={xtype:"userselectorfield",name:q,fieldLabel:p};return n}else{if(h=="datefield"){var j={xtype:h,width:200,fieldLabel:p,name:d,format:"Y-m-d",allowBlank:g};return j}else{if(h=="checkbox"){var k=[];Ext.each(o.columns,function(t,s){k.push({boxLabel:t.name,name:q+"["+t.id+"]"})});var l={xtype:"checkboxgroup",width:200,columns:2,allowBlank:g,items:k};return l}else{var i={xtype:h,width:200,fieldLabel:p,name:d,allowBlank:g};return i}}}}};this.formPanel.getForm().load({url:c.baseUrl+"&task=addDetails&type=personinfo",method:"POST",waitMsg:lang("waiting"),success:function(f,g){var e=Ext.getCmp(c.ID_PERSON_GROUP);var h="";var d="";Ext.each(g.result.data,function(m,k,l){var j=m.label;var i="person_"+m.name;var n=m.xtype;c.content_start++;e.add([{xtype:"panel",hideBorders:true,border:false,layout:"form",items:[b(m)]}]);e.doLayout()});if(this.type=="editDetails"){this.loadFormData()}},failure:function(d,e){CNOA.msg.alert(lang("wrong"),function(){c.close()})}})},submitForm:function(){var b=this;var a=b.in_dept.getValue();if(b.formPanel.getForm().isValid()){b.formPanel.getForm().submit({url:b.baseUrl+"&task="+b.type+"&type=personBaseData&id="+b.edit_id,waitMsg:lang("waiting"),method:"POST",params:{deptID:a},success:function(c,d){CNOA.msg.notice(d.result.msg,lang("hrMgr"));b.addEditWindow.close();b.list.store.load()},failure:function(c,d){CNOA.msg.alert(d.result.msg)}})}},manage:function(e,c,a,f,b,d){var e=a.json.pid;return"<a href='javascript:void(0);' class='gridview3' onclick='CNOA_hr_person_newPersonDataManage.addNewData("+e+");'>"+lang("improveData")+"</a>"},addNewData:function(a){mainPanel.closeTab("CNOA_HR_PERSON_MANAGE_ADDDETAILS");mainPanel.loadClass("index.php?app=hr&func=person&action=manage&task=loadPage&from=addDetails&personID="+a,"CNOA_HR_PERSON_MANAGE_ADDDETAILS",lang("addDetail"),"icon-page-view")},showUpdateFaceDialog:function(){var a=this;this.FACE_WINDOW_FORMPANEL=new Ext.FormPanel({fileUpload:true,autoHeight:true,autoScroll:false,waitMsgTarget:true,hideBorders:true,border:false,bodyStyle:"padding: 5px;",buttonAlign:"right",items:[{xtype:"fileuploadfield",name:"face",allowBlank:false,blankText:lang("updateFaceBlankText"),buttonCfg:{text:lang("browse")},hideLabel:true,width:370}],buttons:[{text:lang("save"),handler:function(){if(a.FACE_WINDOW_FORMPANEL.getForm().isValid()){a.FACE_WINDOW_FORMPANEL.getForm().submit({url:a.baseUrl+"&task=upFace",waitMsg:lang("waiting"),params:{},success:function(b,c){a.formPanel.getForm().findField("photo").setValue(c.result.msg);Ext.fly("CNOA_HR_PERSONPHOTO_INFO_FACEBOX").dom.src=c.result.msg;a.FACE_WINDOW.close()},failure:function(b,c){CNOA.msg.alert(c.result.msg,function(){a.FACE_WINDOW.close()})}})}}},{text:lang("close"),handler:function(){a.FACE_WINDOW.close()}}]});this.FACE_WINDOW=new Ext.Window({width:398,height:130,autoScroll:false,modal:true,resizable:false,title:lang("upload")+lang("photo"),items:[this.FACE_WINDOW_FORMPANEL]}).show()},showSearch:function(){if(!this.searchWindow){this.searchWindow=this.createSearchWindow()}this.searchWindow.show()},createSearchWindow:function(){var f=this;this.searchStationComboBoxDataStore=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:f.baseUrl+"&task=getList&type=status"}),reader:new Ext.data.JsonReader({root:"data",fields:[{name:"searchStationid",mapping:"sid"},{name:"name"}]}),listeners:{load:function(){if(f.searchPar.searchStationid!=="0"){f.findFormPanel.getForm().findField("searchStationid").setValue(f.searchPar.searchStationid)}}}});this.searchStationComboBoxDataStore.load();var e=Ext.id();var d=[{xtype:"fieldset",title:lang("officerSearch"),defaults:{style:{marginBottom:"10px"},border:false},items:[{xtype:"panel",hideBorders:true,border:false,layout:"table",layoutConfig:{columns:2},items:[{xtype:"panel",layout:"form",width:260,defaults:{style:{marginBottom:"10px"},border:false},items:[{xtype:"cnoa_textfield",fieldLabel:lang("truename"),name:"truename",width:150},{xtype:"departmentselectorfield",fieldLabel:lang("inDepartment"),width:150,name:"deptID",multiSelector:false},{xtype:"combo",fieldLabel:lang("status"),id:e,name:"status",store:this.getDropStore(this.TYPE_ZAIZHI),width:150,hiddenName:"status",valueField:"id",displayField:"value",mode:"local",triggerAction:"all",forceSelection:true,editable:false},{xtype:"combo",fieldLabel:lang("zZMM"),name:"politics",store:new Ext.data.SimpleStore({fields:["value","politics"],data:[["5",lang("masses")],["4",lang("gQTY")],["3",lang("CCP")],["2",lang("CCPPro")],["1",lang("withoutParty")],["0","　　　"]]}),width:150,hiddenName:"politics",valueField:"value",displayField:"politics",mode:"local",triggerAction:"all",forceSelection:true,editable:false},{xtype:"combo",fieldLabel:lang("emploType"),name:"workType",store:this.getDropStore(this.TYPE_YUANGONG),width:150,hiddenName:"workType",valueField:"id",displayField:"value",mode:"local",triggerAction:"all",forceSelection:true,editable:false},{xtype:"datefield",format:"Y-m-d",name:"ruZhiTime",fieldLabel:lang("entryTime"),width:150},{xtype:"datefield",format:"Y-m-d",name:"ruZhiTimeEnd",fieldLabel:lang("to"),width:150},{xtype:"datefield",format:"Y-m-d",name:"actualDate",fieldLabel:"离职时间从",width:150},{xtype:"datefield",format:"Y-m-d",name:"actualDateEnd",fieldLabel:lang("to"),width:150}]},{xtype:"panel",layout:"form",width:"260",defaults:{style:{marginBottom:"10px"},border:false},items:[{xtype:"combo",fieldLabel:lang("post"),name:"searchStationid",store:this.searchStationComboBoxDataStore,hiddenName:"searchStationid",valueField:"searchStationid",displayField:"name",mode:"local",width:150,triggerAction:"all",forceSelection:true,editable:false},{xtype:"combo",fieldLabel:lang("sysUser"),name:"systemOA",store:new Ext.data.SimpleStore({fields:["value","systemOA"],data:[["2",lang("yes")],["1",lang("no")],["0","　　　"]]}),width:150,hiddenName:"systemOA",valueField:"value",displayField:"systemOA",mode:"local",triggerAction:"all",forceSelection:true,editable:false},{xtype:"combo",fieldLabel:lang("sex"),name:"gender",store:new Ext.data.SimpleStore({fields:["value","gender"],data:[["1",lang("male")],["2",lang("female")],["0","　　　"]]}),width:150,hiddenName:"gender",valueField:"value",displayField:"gender",mode:"local",triggerAction:"all",forceSelection:true,editable:false},{xtype:"combo",fieldLabel:lang("maritalStatus"),name:"marrage",store:this.getDropStore(this.TYPE_HUNYIN),width:150,hiddenName:"marrage",valueField:"id",displayField:"value",mode:"local",triggerAction:"all",forceSelection:true,editable:false},{xtype:"combo",fieldLabel:lang("huKouType"),name:"huKouType",store:this.getDropStore(this.TYPE_HUKOU),width:150,hiddenName:"huKouType",valueField:"id",displayField:"value",mode:"local",triggerAction:"all",forceSelection:true,editable:false},{xtype:"combo",fieldLabel:lang("education1"),name:"highestSchool",store:this.getDropStore(this.TYPE_XUELI),width:150,hiddenName:"highestSchool",valueField:"id",displayField:"value",mode:"local",triggerAction:"all",forceSelection:true,editable:false},{xtype:"combo",fieldLabel:lang("onOffPerson"),name:"workStatus",store:new Ext.data.SimpleStore({fields:["workStatus","name"],data:[[1,lang("inJob")],[2,lang("leaveJob")]]}),width:150,hiddenName:"workStatus",valueField:"workStatus",displayField:"name",mode:"local",triggerAction:"all",forceSelection:true,editable:false}]}]}]},{xtype:"fieldset",id:f.ID_KZ_FIELD,title:lang("personKZ"),items:[{xtype:"panel",border:false,id:f.ID_KZ_SEARCH,hideBorders:true,border:false,layout:"column",autoWidth:true,defaults:{style:{marginBottom:"5px"},border:false}}]}];this.findFormPanel=new Ext.form.FormPanel({hideBorders:true,border:false,waitMsgTarget:true,layout:"border",labelWidth:80,labelAlign:"right",items:[{xtype:"panel",border:false,bodyStyle:"padding:10px",layout:"form",region:"center",autoScroll:true,items:[d]}],listeners:{afterrender:function(){this.getForm().findField("truename").setValue(f.searchPar.truename);this.getForm().findField("deptID").setValue(f.searchPar.deptID);this.getForm().findField("systemOA").setValue(f.searchPar.systemOA);this.getForm().findField("gender").setValue(f.searchPar.gender);this.getForm().findField("politics").setValue(f.searchPar.politics);this.getForm().findField("ruZhiTime").setValue(f.searchPar.ruZhiTime);this.getForm().findField("ruZhiTimeEnd").setValue(f.searchPar.ruZhiTimeEnd);this.getForm().findField("actualDate").setValue(f.searchPar.actualDate);this.getForm().findField("actualDateEnd").setValue(f.searchPar.actualDateEnd);this.getForm().findField("workStatus").setValue(f.searchPar.workStatus);this.getForm().findField("workType").setValue(f.searchPar.workType);this.getForm().findField("highestSchool").setValue(f.searchPar.highestSchool);this.getForm().findField("huKouType").setValue(f.searchPar.huKouType);this.getForm().findField("marrage").setValue(f.searchPar.marrage);this.getForm().findField("status").setValue(f.searchPar.status)},render:function(){Ext.Ajax.request({url:f.baseUrl+"&task=addDetails&type=getSearchKZ",success:function(h){var g=Ext.decode(h.responseText);if(g==0){Ext.getCmp(f.ID_KZ_FIELD).hide()}}});f.loadFormData3()}}});var c=function(){var h=f.findFormPanel.getForm().getValues();for(var g in h){f.searchPar[g]=h[g]}f.list.store.reload({params:f.searchPar});f.list.searchStore=f.searchPar};var b=function(){var h=f.findFormPanel.getForm().getValues();for(var g in h){f.searchPar[g]=""}f.list.searchStore=f.searchPar;f.findFormPanel.getForm().reset()};var a=new Ext.Window({title:lang("searchCompany"),width:600,height:600,modal:true,layout:"fit",resizable:false,border:false,items:[this.findFormPanel],closeAction:"hide",buttons:[{text:lang("clear"),handler:function(){b()}},{text:lang("search"),iconCls:"icon-hr-search",handler:function(){c();a.hide()}},{text:lang("close"),iconCls:"icon-dialog-cancel",handler:function(){a.hide()}}]});return a}};var CNOA_hr_person_manageIndexClass,CNOA_hr_person_manageIndex;CNOA_hr_person_manageIndexClass=CNOA.Class.create();CNOA_hr_person_manageIndexClass.prototype={init:function(){var a=this;this.ID_btn_delete=Ext.id();CNOA_hr_person_newPersonDataManage=new CNOA_hr_person_newPersonDataManageClass();this.baseUrl="index.php?app=hr&func=person&action=manage";this.personList=new Ext.Panel({region:"center",layout:"fit",items:[CNOA_hr_person_newPersonDataManage.mainPanel]});this.mainPanel=new Ext.Panel({collapsible:false,hideBorders:true,border:false,layout:"border",autoScroll:false,items:[this.personList]})}};CNOA_hr_person_manage_addDetailsClass=CNOA.Class.create();CNOA_hr_person_manage_addDetailsClass.prototype={init:function(){var a=this;CNOA_hr_person_contractManage=new CNOA_hr_person_contractManageClass();CNOA_hr_person_prizeManage=new CNOA_hr_person_prizeManageClass();CNOA_hr_person_licenseManage=new CNOA_hr_person_licenseManageClass();CNOA_hr_person_peixunManage=new CNOA_hr_person_peixunManageClass();CNOA_hr_person_studyManage=new CNOA_hr_person_studyManageClass();CNOA_hr_person_workManage=new CNOA_hr_person_workManageClass();CNOA_hr_person_skillManage=new CNOA_hr_person_skillManageClass();CNOA_hr_person_relationshipManage=new CNOA_hr_person_relationshipManageClass();CNOA_hr_person_changeManage=new CNOA_hr_person_changeManageClass();CNOA_hr_person_leaveManage=new CNOA_hr_person_leaveManageClass();CNOA_hr_person_recoveryManage=new CNOA_hr_person_recoveryManageClass();this.baseUrl="index.php?app=hr&func=person&action=manage";this.tabPerson=new Ext.ux.VerticalTabPanel({region:"center",border:false,tabPosition:"left",tabWidth:200,activeItem:0,items:[CNOA_hr_person_contractManage.mainPanel,CNOA_hr_person_prizeManage.mainPanel,CNOA_hr_person_licenseManage.mainPanel,CNOA_hr_person_peixunManage.mainPanel,CNOA_hr_person_studyManage.mainPanel,CNOA_hr_person_workManage.mainPanel,CNOA_hr_person_skillManage.mainPanel,CNOA_hr_person_relationshipManage.mainPanel,CNOA_hr_person_changeManage.mainPanel,CNOA_hr_person_leaveManage.mainPanel,CNOA_hr_person_recoveryManage.mainPanel]});this.mainPanel=new Ext.Panel({collapsible:false,hideBorders:true,border:false,layout:"border",autoScroll:false,items:[this.tabPerson]})}};var CNOA_hr_person_dropdownClass,CNOA_hr_person_dropdown;CNOA_hr_person_dropdownClass=CNOA.Class.create();CNOA_hr_person_dropdownClass.prototype={init:function(){var a=this;this.baseUrl="index.php?app=hr&func=person&action=dropdown";this.TYPE_ZAIZHI=0;this.TYPE_YUANGONG=1;this.TYPE_HUNYIN=2;this.TYPE_HUKOU=3;this.TYPE_XUELI=4;this.TYPE_XUEWEI=5;this.TYPE_ZHICHEN=6;this.zaizhiPanel=this.getDropdownPanel(this.TYPE_ZAIZHI,lang("jobStatus"));this.yuangongPanel=this.getDropdownPanel(this.TYPE_YUANGONG,lang("emploType"));this.hunyinPanel=this.getDropdownPanel(this.TYPE_HUNYIN,lang("maritalStatus"));this.hukouPanel=this.getDropdownPanel(this.TYPE_HUKOU,lang("huKouType"));this.xueliPanel=this.getDropdownPanel(this.TYPE_XUELI,lang("education1"));this.xueweiPanel=this.getDropdownPanel(this.TYPE_XUEWEI,lang("degree"));this.zhichenPanel=this.getDropdownPanel(this.TYPE_ZHICHEN,lang("jobTitle"));this.mainPanel=new Ext.ux.VerticalTabPanel({region:"center",border:false,tabPosition:"left",tabWidth:100,activeItem:0,deferredRender:true,layoutOnTabChange:true,items:[this.zaizhiPanel,this.yuangongPanel,this.hunyinPanel,this.hukouPanel,this.xueliPanel,this.xueweiPanel,this.zhichenPanel]})},getDropdownPanel:function(f,g){var e=this;var c=[{name:"id"},{name:"value"}];var h=new Ext.data.Store({autoLoad:true,proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getdrop&type="+f}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:c}),listeners:{update:function(m,l,n){if(n==Ext.data.Record.EDIT){Ext.Ajax.request({url:e.baseUrl+"&task=add",params:{type:f,value:l.get("value"),id:l.get("id")},success:function(o){var p=Ext.decode(o.responseText);CNOA.msg.notice2(p.msg);switch(f){case 0:e.zaizhiPanel.store.reload();break;case 1:e.yuangongPanel.store.reload();break;case 2:e.hunyinPanel.store.reload();break;case 3:e.hukouPanel.store.reload();break;case 4:e.xueliPanel.store.reload();break;case 5:e.xueweiPanel.store.reload();break;case 6:e.zhichenPanel.store.reload();break}}})}}}});var b=new Ext.grid.CheckboxSelectionModel({singleSelect:true});var i=new Ext.grid.ColumnModel({defaults:{sortable:true},columns:[new Ext.grid.RowNumberer(),b,{header:lang("name"),dataIndex:"value",width:150,editor:new Ext.form.TextField({allowBlank:false})},{header:lang("order"),dataIndex:"id",width:100,menuDisabled:true}]});var d=new Ext.ux.grid.RowEditor({saveText:lang("ok"),cancelText:lang("cancel")});var a=new Ext.grid.GridPanel({title:g,stripeRows:true,store:h,sm:b,height:661,colModel:i,plugins:[d],tbar:new Ext.Toolbar({items:[{iconCls:"icon-system-refresh",tooltip:lang("refresh"),text:lang("refresh"),handler:function(){h.reload()}},{text:lang("add"),iconCls:"icon-utils-s-add",handler:k},{text:lang("del"),iconCls:"icon-utils-s-delete",handler:j},("<span style='color:#999'>"+lang("dblclickToEdit")+"</span>"),"->",{xtype:"cnoa_helpBtn",helpid:41}]})});function k(){var l=new h.recordType({id:"",value:""});d.stopEditing();a.store.insert(0,l);d.startEditing(0)}function j(){var l=a.getSelectionModel().getSelected();if(!l){return false}Ext.Ajax.request({url:e.baseUrl+"&task=delete",params:{id:l.get("id")},success:function(m){h.remove(l);var n=Ext.decode(m.responseText);CNOA.msg.notice2(n.msg)}})}return a}};var hr_person_file=1;