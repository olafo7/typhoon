var CNOA_hr_attendance_agent,CNOA_hr_attendance_agentClass;CNOA_hr_attendance_agent_Class=CNOA.Class.create();CNOA_hr_attendance_agent_Class.prototype={init:function(){var d=this;this.ID_allUserButton=Ext.id();this.ID_allUserField=Ext.id();this.baseUrl="index.php?app=hr&func=attendance&action=agent";this.uid=0;var a=Ext.id();var c=function(e){d.mainPanel.getForm().load({url:d.baseUrl+"&task=agent_info",method:"POST",params:{agente:e},success:function(f,g){},failure:function(f,g){CNOA.msg.alert(g.result.msg)}})};var b=function(h,e){var g=this.mainPanel.getForm();if(g.isValid()){g.submit({url:d.baseUrl+"&task=agent_update",method:"POST",params:{agente:h,uids:e},success:function(f,i){CNOA.msg.notice(i.result.msg,lang("hrMgr"))},failure:function(f,i){CNOA.msg.alert(i.result.msg)}})}else{CNOA.miniMsg.alertShowAt(a,lang("formValid"))}}.createDelegate(this);this.mainPanel=new Ext.form.FormPanel({border:false,bodyStyle:"border-left-width:1px",layout:"fit",header:true,region:"center",tbar:new Ext.Toolbar({style:"border-left-width:1px",items:[{text:lang("setAgency"),id:a,iconCls:"icon-btn-save",handler:function(){b(d.uid,d.mainPanel.getForm().findField("allUids").getValue())}.createDelegate(this)},'<span style="color:gray;"><<<'+lang("clickSaveData")+"</span>",{xtype:"button",text:lang("emptyPerson"),iconCls:"icon-customes-change",handler:function(){CNOA.msg.cf(lang("afterEmptyPerson"),function(e){if(e=="yes"){d.mainPanel.getForm().findField("allUserNames").setValue("");d.mainPanel.getForm().findField("allUids").setValue("")}})}},"->",{xtype:"cnoa_helpBtn",helpid:3018}]}),items:[{xtype:"fieldset",style:"margin: 10px 0 0 0; padding: 0",width:500,border:false,labelAlign:"right",id:d.ID_allUserField,items:[{xtype:"textarea",style:"margin: 0; padding: 0;",height:130,width:400,readOnly:true,fieldLabel:lang("proxyPerson"),name:"allUserNames"},{xtype:"hidden",name:"allUids",listeners:{afterrender:function(){c(d.uid)}}},{xtype:"btnForPoepleSelector",id:d.ID_allUserButton,style:"margin: 0; padding: 0",autoWidth:true,dataUrl:d.baseUrl+"&task=getAllUserListsInPermitDeptTree",style:"margin-left:105px;",text:lang("selectPeople"),listeners:{selected:function(g,h){var j=new Array();var f=new Array();if(h.length>0){for(var e=0;e<h.length;e++){j.push(h[e].uname);f.push(h[e].uid)}}d.mainPanel.getForm().findField("allUserNames").setValue(j.join(","));d.mainPanel.getForm().findField("allUids").setValue(f.join(","))},onrender:function(e){e.setSelectedUids(d.mainPanel.getForm().findField("allUids").getValue().split(","))}}}]}]})},show:function(b,a){var d=this;var c=lang("set2")+"“"+a+"”"+lang("proxyAttPerson");d.mainPanel.setTitle(c);d.uid=b;return d.mainPanel}};CNOA_hr_attendance_agentClass=CNOA.Class.create();CNOA_hr_attendance_agentClass.prototype={init:function(){var a=this;this.baseUrl="index.php?app=hr&func=attendance&action=agent";this.panel=new Ext.Panel({region:"center",border:false,bodyStyle:"border-left-width:1px"});this.treeRoot=new Ext.tree.AsyncTreeNode({text:lang("companyPerson"),expanded:true});this.treeLoader=new Ext.tree.TreeLoader({dataUrl:this.baseUrl+"&task=getUsersTree",preloadChildren:true,clearOnLoad:false,listeners:{load:function(b){this.deptTree.expandAll();this.deptTree.getEl().unmask()}.createDelegate(this)}});this.deptTree=new Ext.tree.TreePanel({hideBorders:true,border:false,rootVisible:false,lines:true,animCollapse:false,animate:false,loader:this.treeLoader,root:this.treeRoot,autoScroll:true,listeners:{click:function(f){var b=f.attributes;var d=b.uid;var c=b.text;if(d!=undefined){var e=new CNOA_hr_attendance_agent_Class();a.panel.removeAll(true);a.panel.add(e.show(d,c));a.panel.doLayout()}}}});this.deptPanel=new Ext.Panel({region:"west",layout:"fit",split:true,width:180,minWidth:150,maxWidth:300,border:false,bodyStyle:"border-right-width:1px;",items:[this.deptTree],tbar:new Ext.Toolbar({style:"border-right-width:1px;",items:[{handler:function(b,c){a.treeRoot.reload()}.createDelegate(this),iconCls:"icon-system-refresh",tooltip:lang("refresh"),text:lang("refresh")},{text:lang("collapse"),iconCls:"icon-expand-all",id:this.ID_btn_collapseExpand,tooltip:lang("expandMenuTip"),enableToggle:true,toggleHandler:function(b,c){if(c){b.setIconClass("icon-expand-all");b.setText(lang("expand"));b.setTooltip(lang("expandMenuTip"));a.treeRoot.collapse(true);a.treeRoot.firstChild.expand()}else{b.setIconClass("icon-collapse-all");b.setText(lang("collapse"));b.setTooltip(lang("collapseMenuTip"));a.treeRoot.expand(true)}}}]})});this.mainPanel=new Ext.Panel({border:false,layout:"border",items:[this.deptPanel,this.panel]})}};var CNOA_hr_attendance_check,CNOA_hr_attendance_checkClass;CNOA_hr_attendance_globalClass=CNOA.Class.create();CNOA_hr_attendance_globalClass.prototype={init:function(){var a=this;this.baseUrl="index.php?app=hr&func=attendance&action=check";this.type="add";this.edit_id=0;this.checkFields={chkType:0,chkID:0,chkStatus:0}},getStore:function(a){switch(a){case 1:return CNOA_hr_attendance_egression.store;case 2:return CNOA_hr_attendance_leave.store;case 3:return CNOA_hr_attendance_evection.store;case 4:return CNOA_hr_attendance_overtime.store}},checkPosttime:function(f,b,a,g,d,c){var e="";e='<span style="color:#559966; font-weight:bold">'+f+"</span>";return e},showDetail:function(a){a=a.replace(/\n/g,"<BR> ");winInfos=new Ext.Window({title:lang("viewDetail"),width:650,height:400,autoScroll:true,modal:true,bodyStyle:"padding: 20px; background-color:#fff",html:a,buttons:[{text:lang("close"),handler:function(){winInfos.close()}}]}).show()},checkType:function(g,b,a,h,d,c){var f=a.data;var e="";switch(g){case 1:e=lang("wCDJ");break;case 2:e=lang("qJDJ");break}return"<a>"+e+"</a>"},getCheck:function(h,a,f,g,j,i){var c=f.data;var b=c.stime;var e=c.etime;var d=c.reason;var l="";var k="";l=lang("startTime")+'：<span style="color:#558899; font-weight:bold">'+b+"</span> - "+lang("startTime")+'：<span style="color:#558899; font-weight:bold">'+e+'</span><BR><span ext:qtip="'+lang("clickToView")+'" style="color:#888">'+d+"</span>";return l},getOperation:function(i,a,f,h,k,j){var g=this;var e=f.data;var d=e.chkType;var b=e.chkID;var c=e.status;var l='<a href="javascript:void(0);" onclick="'+g.globalName+".doUpdateStatus("+d+", "+b+", 1, "+c+');">'+lang("ratify")+'</a> / <a href="javascript:void(0)" onclick="'+g.globalName+".doUpdateStatus("+d+", "+b+", 2, "+c+');">'+lang("notApprove")+"</a>";return l},doUpdateStatus:function(c,e,a,b){var d=this;d.checkFields.chkType=c;d.checkFields.chkID=e;d.checkFields.chkStatus=a;if(a==2){d.showAddWindow(b);return}CNOA.msg.cf(lang("suerDoThis"),function(f){if(f=="yes"){Ext.Ajax.request({url:d.baseUrl+"&task=updateCheck",method:"POST",params:{chkType:c,chkID:e,status:a,ostatus:b},success:function(h){var g=Ext.decode(h.responseText);if(g.success===true){CNOA.msg.notice(g.msg,lang("hrMgr"));d.getStore(c).reload()}else{CNOA.msg.alert(g.msg)}}})}})},showAddWindow:function(c){var g=this;var a=Ext.id();var f="";var e="";var b=function(h){var j=g.checkFields;var i=this.formPanel.getForm();if(i.isValid()){i.submit({url:g.baseUrl+"&task=unAllowedCheck",waitTitle:lang("notice"),method:"POST",waitMsg:lang("waiting"),params:{type:"edit",chkType:j.chkType,chkID:j.chkID,ostatus:c},success:function(k,l){g.getStore(j.chkType).reload();CNOA.msg.notice(l.result.msg,lang("hrMgr"));g.addEditWindow.close()},failure:function(k,l){CNOA.msg.alert(l.result.msg)}})}else{CNOA.miniMsg.alertShowAt(a,lang("formValid"))}}.createDelegate(this);var d=function(){var h=g.checkFields;g.formPanel.getForm().load({url:g.baseUrl+"&task=unAllowedCheck",params:{chkType:h.chkType,chkID:h.chkID},method:"POST",waitMsg:lang("waiting"),success:function(i,j){},failure:function(i,j){CNOA.msg.alert(j.result.msg,function(){g.close()})}.createDelegate(this)})};this.formPanel=new Ext.form.FormPanel({hideBorders:true,border:false,waitMsgTarget:true,labelWidth:70,labelAlign:"right",bodyStyle:"padding:10px",items:[{xtype:"textarea",fieldLabel:lang("noReason"),width:380,height:200,name:"oReason"}]});this.addEditWindow=new Ext.Window({width:500,height:300,modal:true,autoDestroy:true,closeAction:"close",resizable:false,title:lang("noPassReason"),layout:"fit",items:[this.formPanel],buttons:[{text:lang("save"),id:a,iconCls:"icon-btn-save",handler:function(){b()}.createDelegate(this)},{text:lang("cancel"),id:this.ID_btn_close,iconCls:"icon-dialog-cancel",handler:function(){this.addEditWindow.close()}.createDelegate(this)}]});this.addEditWindow.show();d()}};CNOA_hr_attendance_egressionClass=CNOA.Class.create();CNOA_hr_attendance_egressionClass.prototype={init:function(){var a=this;this.globalName="CNOA_hr_attendance_globalEgression";this.baseUrl="index.php?app=hr&func=attendance&action=check";this.type="add";this.edit_id=0;this.ID_truename=Ext.id();this.findFields={truename:""};CNOA_hr_attendance_globalEgression=new CNOA_hr_attendance_globalClass();this.fields=[{name:"id"},{name:"deptName"},{name:"userName"},{name:"posttime"},{name:"stime"},{name:"etime"},{name:"reason"},{name:"chkType"},{name:"chkID"},{name:"status"}];this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getCheck&type=1",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields})});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.store.load();this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),{header:"id",dataIndex:"id",hidden:true},{header:lang("department"),dataIndex:"deptName",width:111,sortable:false,menuDisabled:true},{header:lang("appDate"),dataIndex:"posttime",width:111,sortable:false,menuDisabled:true,renderer:CNOA_hr_attendance_globalEgression.checkPosttime.createDelegate(this)},{header:lang("type"),dataIndex:"status",width:80,sortable:false,menuDisabled:true,renderer:a.renStatus.createDelegate(this)},{header:lang("proposer"),dataIndex:"userName",width:100,sortable:false,menuDisabled:true,renderer:a.renUsername.createDelegate(this)},{header:lang("appContents"),dataIndex:"enddate",width:350,sortable:false,menuDisabled:true,renderer:CNOA_hr_attendance_globalEgression.getCheck.createDelegate(this)},{header:lang("opt"),dataIndex:"id",width:100,sortable:false,menuDisabled:true,renderer:CNOA_hr_attendance_globalEgression.getOperation.createDelegate(this)},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({displayInfo:true,store:this.store,pageSize:15,listeners:{beforechange:function(b,c){if(a.findFields.truename!=""){c.truename=a.findFields.truename}}}});this.grid=new Ext.grid.GridPanel({stripeRows:true,border:false,layout:"fit",store:this.store,loadMask:{msg:lang("waiting")},cm:this.colModel,sm:this.sm,hideBorders:true,listeners:{cellclick:function(b,l,k,j){var f=a.store.reader.jsonData.data[l];var c=f.stime;var g=f.etime;var h=f.reason;var d=f.status;var i=f.otime;var m="";m+=lang("startTime")+'：<span style="color:#228833; font-weight:bold">'+c+"</span> - ";m+=lang("isEndTime")+'：<span style="color:#228833; font-weight:bold">'+g+"</span>";if(parseInt(d)==3){m+="<BR> "+lang("actualEndTime")+'：<span style="color:#228833; font-weight:bold">'+i+"</span>"}m+='<BR> <div style="color:#333; padding:20px; ">'+h+"</div>";if(k==6){CNOA_hr_attendance_globalEgression.showDetail(m)}}},tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){this.store.reload()}.createDelegate(this)},lang("proposer")+"：",{xtype:"textfield",width:140,id:a.ID_truename},{text:lang("search"),handler:function(){truename=Ext.getCmp(a.ID_truename).getValue();a.findFields.truename=truename;a.store.load({params:{truename:truename}})}},{text:lang("clear"),handler:function(){Ext.getCmp(a.ID_truename).setValue("");a.findFields.truename="";a.store.load()}},"->",{xtype:"cnoa_helpBtn",helpid:3008}],bbar:this.pagingBar});this.mainPanel=new Ext.Panel({border:false,layout:"fit",title:lang("outRegApp"),items:[a.grid]})},renStatus:function(f,b,a,h,d,c){var e="";var g="";switch(parseInt(f)){case 0:g=lang("outApp");break;case 3:g=lang("returnAudit");break;case 5:g=lang("zxsq");break}e='<span style="color:#663399;">'+g+"</span>";return e},renUsername:function(f,b,a,g,d,c){var e="";e='<span style="color:#2222CC;">'+f+"</span>";return e}};CNOA_hr_attendance_leaveClass=CNOA.Class.create();CNOA_hr_attendance_leaveClass.prototype={init:function(){var a=this;this.globalName="CNOA_hr_attendance_globalLeave";this.baseUrl="index.php?app=hr&func=attendance&action=check";this.type="add";this.edit_id=0;this.ID_truename=Ext.id();this.findFields={truename:""};CNOA_hr_attendance_globalLeave=new CNOA_hr_attendance_globalClass();this.checkFields={chkType:0,chkID:0,chkStatus:0};this.fields=[{name:"id"},{name:"deptName"},{name:"userName"},{name:"posttime"},{name:"stime"},{name:"etime"},{name:"reason"},{name:"chkType"},{name:"chkID"},{name:"status"}];this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getCheck&type=2",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields})});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.store.load();this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),{header:"id",dataIndex:"id",hidden:true},{header:lang("department"),dataIndex:"deptName",width:111,sortable:false,menuDisabled:true},{header:lang("appDate"),dataIndex:"posttime",width:111,sortable:false,menuDisabled:true,renderer:CNOA_hr_attendance_globalLeave.checkPosttime.createDelegate(this)},{header:lang("proposer"),dataIndex:"userName",width:100,sortable:false,menuDisabled:true,renderer:a.renUsername.createDelegate(this)},{header:lang("appContents"),dataIndex:"enddate",width:350,sortable:false,menuDisabled:true,renderer:CNOA_hr_attendance_globalLeave.getCheck.createDelegate(this)},{header:lang("appType"),dataIndex:"status",width:80,sortable:false,menuDisabled:true,renderer:a.renStatus.createDelegate(this)},{header:lang("opt"),dataIndex:"id",width:100,sortable:false,menuDisabled:true,renderer:CNOA_hr_attendance_globalLeave.getOperation.createDelegate(this)},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({displayInfo:true,store:this.store,pageSize:15,listeners:{beforechange:function(b,c){if(a.findFields.truename!=""){c.truename=a.findFields.truename}}}});this.grid=new Ext.grid.GridPanel({stripeRows:true,border:false,layout:"fit",store:this.store,loadMask:{msg:lang("waiting")},cm:this.colModel,sm:this.sm,hideBorders:true,listeners:{cellclick:function(b,l,k,j){var f=a.store.reader.jsonData.data[l];var c=f.stime;var g=f.etime;var h=f.reason;var d=f.status;var i=f.otime;var m="";m+=lang("startTime")+'：<span style="color:#228833; font-weight:bold">'+c+"</span> - ";m+=lang("isEndTime")+'：<span style="color:#228833; font-weight:bold">'+g+"</span>";if(parseInt(d)==3){m+="<BR> "+lang("isEndTime")+'：<span style="color:#228833; font-weight:bold">'+i+"</span>"}m+='<BR> <div style="color:#333; padding:20px; ">'+h+"</div>";if(k==5){CNOA_hr_attendance_globalLeave.showDetail(m)}}},tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){a.store.reload()}},lang("proposer")+"：",{xtype:"textfield",width:140,id:a.ID_truename},{text:lang("search"),handler:function(){truename=Ext.getCmp(a.ID_truename).getValue();a.findFields.truename=truename;a.store.load({params:{truename:truename}})}},{text:lang("clear"),handler:function(){Ext.getCmp(a.ID_truename).setValue("");a.findFields.truename="";a.store.load()}},"->",{xtype:"cnoa_helpBtn",helpid:3009}],bbar:this.pagingBar});this.mainPanel=new Ext.Panel({border:false,layout:"fit",title:lang("qjdjAndsp"),items:[a.grid]})},renStatus:function(f,b,a,g,d,c){var e="";switch(parseInt(f)){case 0:e='<span style="color:#080880">'+lang("leave")+"</span>";break;case 3:e='<span style="color:#828220">'+lang("sickLeave")+"</span>";break;case 5:e='<span style="color:#822082">'+lang("zxsq")+"</span>";break}return e},renUsername:function(f,b,a,g,d,c){var e="";e='<span style="color:#2222CC;">'+f+"</span>";return e}};CNOA_hr_attendance_evectionClass=CNOA.Class.create();CNOA_hr_attendance_evectionClass.prototype={init:function(){var a=this;this.globalName="CNOA_hr_attendance_globalEvection";this.baseUrl="index.php?app=hr&func=attendance&action=check";this.type="add";this.edit_id=0;this.ID_truename=Ext.id();this.findFields={truename:""};CNOA_hr_attendance_globalEvection=new CNOA_hr_attendance_globalClass();this.checkFields={chkType:0,chkID:0,chkStatus:0};this.fields=[{name:"id"},{name:"deptName"},{name:"userName"},{name:"posttime"},{name:"stime"},{name:"etime"},{name:"reason"},{name:"chkType"},{name:"chkID"},{name:"address"},{name:"status"}];this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getCheck&type=3",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields})});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.store.load();this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),{header:"id",dataIndex:"id",hidden:true},{header:lang("department"),dataIndex:"deptName",width:111,sortable:false,menuDisabled:true},{header:lang("registerDate"),dataIndex:"posttime",width:111,sortable:false,menuDisabled:true,renderer:CNOA_hr_attendance_globalEvection.checkPosttime.createDelegate(this)},{header:lang("type"),dataIndex:"status",width:80,sortable:false,menuDisabled:true,renderer:a.renStatus.createDelegate(this)},{header:lang("registrant"),dataIndex:"userName",width:100,sortable:false,menuDisabled:true,renderer:a.renUsername.createDelegate(this)},{header:lang("travelReason"),dataIndex:"enddate",width:300,sortable:false,menuDisabled:true,renderer:CNOA_hr_attendance_globalEvection.getCheck.createDelegate(this)},{header:lang("travelSites"),dataIndex:"address",width:100,sortable:false,menuDisabled:true,renderer:a.renAddress.createDelegate(this)},{header:lang("opt"),dataIndex:"id",width:100,sortable:false,menuDisabled:true,renderer:CNOA_hr_attendance_globalEvection.getOperation.createDelegate(this)},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({displayInfo:true,store:this.store,pageSize:15,listeners:{beforechange:function(b,c){if(a.findFields.truename!=""){c.truename=a.findFields.truename}}}});this.grid=new Ext.grid.GridPanel({stripeRows:true,border:false,layout:"fit",store:this.store,loadMask:{msg:lang("waiting")},cm:this.colModel,sm:this.sm,hideBorders:true,listeners:{cellclick:function(b,l,k,j){var f=a.store.reader.jsonData.data[l];var c=f.stime;var g=f.etime;var h=f.reason;var d=f.status;var i=f.otime;var m="";m+=lang("startTime")+'：<span style="color:#228833; font-weight:bold">'+c+"</span> - ";m+=lang("isEndTime")+'：<span style="color:#228833; font-weight:bold">'+g+"</span>";if(parseInt(d)==3){m+="<BR> "+lang("actualEndTime")+'：<span style="color:#228833; font-weight:bold">'+i+"</span>"}m+" - "+lang("travelSites")+'：<span style="color:#228833; font-weight:bold">'+f.address+"</span>";m+='<BR> <div style="color:#333; padding:20px; ">'+h+"</div>";if((k==5)||(k==6)){CNOA_hr_attendance_globalEvection.showDetail(m)}}},tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){a.store.reload()}},lang("proposer")+"：",{xtype:"textfield",width:140,id:a.ID_truename},{text:lang("search"),handler:function(){truename=Ext.getCmp(a.ID_truename).getValue();a.findFields.truename=truename;a.store.load({params:{truename:truename}})}},{text:lang("clear"),handler:function(){Ext.getCmp(a.ID_truename).setValue("");a.findFields.truename="";a.store.load()}},"->",{xtype:"cnoa_helpBtn",helpid:3010}],bbar:this.pagingBar});this.mainPanel=new Ext.Panel({border:false,layout:"fit",title:lang("cCDJSP"),items:[a.grid]})},renStatus:function(f,b,a,h,d,c){var e="";var g="";switch(parseInt(f)){case 0:g=lang("travelRequset");break;case 3:g=lang("returnAudit");break}e='<span style="color:#663399;">'+g+"</span>";return e},renUsername:function(f,b,a,g,d,c){var e="";e='<span style="color:#2222CC;">'+f+"</span>";return e},renAddress:function(f,b,a,g,d,c){var e="";e='<span style="color:#228833;">'+f+"</span>";return e}};CNOA_hr_attendance_overtimeClass=CNOA.Class.create();CNOA_hr_attendance_overtimeClass.prototype={init:function(){var a=this;this.globalName="CNOA_hr_attendance_globalOvertime";this.baseUrl="index.php?app=hr&func=attendance&action=check";this.type="add";this.edit_id=0;this.ID_truename=Ext.id();this.findFields={truename:""};CNOA_hr_attendance_globalOvertime=new CNOA_hr_attendance_globalClass();this.checkFields={chkType:0,chkID:0,chkStatus:0};this.fields=[{name:"id"},{name:"deptName"},{name:"userName"},{name:"posttime"},{name:"stime"},{name:"etime"},{name:"reason"},{name:"chkType"},{name:"chkID"},{name:"address"},{name:"status"}];this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getCheck&type=4",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields})});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.store.load();this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),{header:"id",dataIndex:"id",hidden:true},{header:lang("department"),dataIndex:"deptName",width:111,sortable:false,menuDisabled:true},{header:lang("appTime"),dataIndex:"posttime",width:111,sortable:false,menuDisabled:true,renderer:CNOA_hr_attendance_globalOvertime.checkPosttime.createDelegate(this)},{header:lang("proposer"),dataIndex:"userName",width:100,sortable:false,menuDisabled:true,renderer:a.renUsername.createDelegate(this)},{header:lang("otTime"),dataIndex:"reason",width:300,sortable:false,menuDisabled:true,renderer:CNOA_hr_attendance_globalOvertime.getCheck.createDelegate(this)},{header:lang("type"),dataIndex:"status",width:90,sortable:false,menuDisabled:true,renderer:a.renStatus.createDelegate(this)},{header:lang("opt"),dataIndex:"id",width:100,sortable:false,menuDisabled:true,renderer:CNOA_hr_attendance_globalOvertime.getOperation.createDelegate(this)},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({displayInfo:true,store:this.store,pageSize:15,listeners:{beforechange:function(b,c){if(a.findFields.truename!=""){c.truename=a.findFields.truename}}}});this.grid=new Ext.grid.GridPanel({stripeRows:true,border:false,layout:"fit",store:this.store,loadMask:{msg:lang("waiting")},cm:this.colModel,sm:this.sm,hideBorders:true,listeners:{cellclick:function(b,l,k,j){var f=a.store.reader.jsonData.data[l];var c=f.stime;var g=f.etime;var h=f.reason;var d=f.status;var i=f.otime;var m="";m+=lang("startTime")+'：<span style="color:#228833; font-weight:bold">'+c+"</span> - ";m+=lang("isEndTime")+'：<span style="color:#228833; font-weight:bold">'+g+"</span>";if(parseInt(d)==3){m+="<BR> "+lang("actualEndTime")+'：<span style="color:#228833; font-weight:bold">'+i+"</span>"}m+='<BR> <div style="color:#333; padding:20px; ">'+h+"</div>";if(k==5){CNOA_hr_attendance_globalOvertime.showDetail(m)}}},tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){a.store.reload()}},lang("proposer")+"：",{xtype:"textfield",width:140,id:a.ID_truename},{text:lang("search"),handler:function(){truename=Ext.getCmp(a.ID_truename).getValue();a.findFields.truename=truename;a.store.load({params:{truename:truename}})}},{text:lang("clear"),handler:function(){Ext.getCmp(a.ID_truename).setValue("");a.findFields.truename="";a.store.load()}},"->",{xtype:"cnoa_helpBtn",helpid:3011}],bbar:this.pagingBar});this.mainPanel=new Ext.Panel({border:false,layout:"fit",title:lang("jBDJandSP"),items:[a.grid]})},renStatus:function(f,b,a,h,d,c){var e="";var g="";switch(parseInt(f)){case 0:g=lang("appOvertime");break;case 3:g=lang("jBJSSP");break;case 5:g=lang("zxsq");break}e='<span style="color:#663399;">'+g+"</span>";return e},renUsername:function(f,b,a,g,d,c){var e="";e='<span style="color:#2222CC;">'+f+"</span>";return e},renAddress:function(f,b,a,g,d,c){var e="";e='<span style="color:#228833;">'+f+"</span>";return e}};CNOA_hr_attendance_checkClass=CNOA.Class.create();CNOA_hr_attendance_checkClass.prototype={init:function(){var a=this;this.baseUrl="index.php?app=hr&func=attendance&action=check";CNOA_hr_attendance_evection=new CNOA_hr_attendance_evectionClass();CNOA_hr_attendance_overtime=new CNOA_hr_attendance_overtimeClass();CNOA_hr_attendance_egression=new CNOA_hr_attendance_egressionClass();CNOA_hr_attendance_leave=new CNOA_hr_attendance_leaveClass();this.centerPanel=new Ext.ux.VerticalTabPanel({region:"center",border:false,tabPosition:"left",resizeTabs:true,deferredRender:false,minTabWidth:200,tabWidth:200,activeItem:0,items:[CNOA_hr_attendance_egression.mainPanel,CNOA_hr_attendance_evection.mainPanel,CNOA_hr_attendance_leave.mainPanel,CNOA_hr_attendance_overtime.mainPanel]});this.mainPanel=new Ext.Panel({border:false,layout:"border",items:[this.centerPanel]})}};var CNOA_hr_attendance_record,CNOA_hr_attendance_recordClass;CNOA_hr_attendance_record_wtClass=CNOA.Class.create();CNOA_hr_attendance_record_wtClass.prototype={init:function(){var a=this;this.baseUrl="index.php?app=hr&func=attendance&action=record";this.type="add";this.edit_id=0;this.uid=0;this.ID_stime=Ext.id();this.ID_etime=Ext.id();this.ID_fullatt=Ext.id();this.ID_absent=Ext.id();this.ID_belate=Ext.id();this.ID_leaved=Ext.id();this.ID_oncktimes=Ext.id();this.ID_offcktimes=Ext.id();this.fields=[{name:"id"},{name:"date"},{name:"time1"},{name:"time2"},{name:"time3"},{name:"time4"},{name:"time5"},{name:"time6"}];this.findFields={uid:0,stime:"",etime:""};this.getHeaderTitle=function(){var b=a.uid;if(b==""){return}Ext.Ajax.request({url:a.baseUrl+"&task=getChecktime&uid="+b,method:"GET",success:function(e){var c=e.responseText;jsData=Ext.decode(c);arrData=jsData.data;start=3;for(var d=0;d<=6-1;d++){a.colModel.setColumnHeader(d+start,"")}for(var d=0;d<=arrData.length-1;d++){data=arrData[d];stype=data.type==0?lang("goWork"):lang("offWork");header=data.time+'(<b style="color:#1122EE;">'+stype+"</b>)";a.colModel.setColumnHeader(d+start,header)}}})};this.clearSearch=function(){var b=Ext.getCmp(a.ID_stime);var c=Ext.getCmp(a.ID_etime);b.setValue(new Date());c.setValue(new Date())};this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getWorktime",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields}),listeners:{load:function(e,c,d){var b=e.reader.jsonData;var f=b.top;fullatt=Ext.getCmp(a.ID_fullatt);absent=Ext.getCmp(a.ID_absent);belate=Ext.getCmp(a.ID_belate);leaved=Ext.getCmp(a.ID_leaved);oncktimes=Ext.getCmp(a.ID_oncktimes);offcktimes=Ext.getCmp(a.ID_offcktimes);fullatt.setValue(f.fullatt);absent.setValue(f.absent);belate.setValue(f.belate);leaved.setValue(f.leaved);oncktimes.setValue(f.oncktimes);offcktimes.setValue(f.offcktimes)},exception:function(h,g,i,f,d,c){var e=d.responseText;if(e!=""){var b=Ext.decode(e);if(b.failure){CNOA.msg.alert(b.msg)}}},beforeload:function(){a.getHeaderTitle()}}});a.store.load();this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),{header:"id",dataIndex:"id",hidden:true},{header:lang("date"),dataIndex:"date",width:130,sortable:false,menuDisabled:true},{header:"",dataIndex:"time1",width:130,sortable:false,menuDisabled:true,renderer:a.renWorktime.createDelegate(this)},{header:"",dataIndex:"time2",width:130,sortable:false,menuDisabled:true,renderer:a.renWorktime.createDelegate(this)},{header:"",dataIndex:"time3",width:130,sortable:false,menuDisabled:true,renderer:a.renWorktime.createDelegate(this)},{header:"",dataIndex:"time4",width:130,sortable:false,menuDisabled:true,renderer:a.renWorktime.createDelegate(this)},{header:"",dataIndex:"time5",width:130,sortable:false,menuDisabled:true,renderer:a.renWorktime.createDelegate(this)},{header:"",dataIndex:"time6",width:130,sortable:false,menuDisabled:true,renderer:a.renWorktime.createDelegate(this)},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({displayInfo:true,store:a.store,pageSize:15,listeners:{beforechange:function(b,c){if(a.findFields.uid!=0){c.uid=a.findFields.uid}if(a.findFields.stime!=""){c.stime=a.findFields.stime}if(a.findFields.etime!=""){c.etime=a.findFields.etime}}}});this.topPanel=new Ext.form.FormPanel({layout:"table",border:false,bodyStyle:"padding: 5px",labelWidth:130,labelAlign:"right",hideBorders:true,layoutConfig:{columns:3},items:[{xtype:"panel",layout:"form",width:250,items:[{xtype:"textfield",fieldLabel:lang("fullDays"),width:100,readOnly:true,name:"fullatt",id:a.ID_fullatt,style:"text-align:center; font-weight: bold; color:#119911;"},{xtype:"textfield",fieldLabel:lang("kuanggong"),width:100,readOnly:true,name:"absent",id:a.ID_absent,style:"text-align:center; font-weight: bold; color:#119911;"}]},{xtype:"panel",layout:"form",width:250,items:[{xtype:"textfield",fieldLabel:lang("cdTimes"),width:100,readOnly:true,name:"belate",id:a.ID_belate,style:"text-align:center; font-weight: bold; color:#119911;"},{xtype:"textfield",fieldLabel:lang("ztTimes"),width:100,readOnly:true,name:"leaved",id:a.ID_leaved,style:"text-align:center; font-weight: bold; color:#119911;"}]},{xtype:"panel",layout:"form",width:250,items:[{xtype:"textfield",fieldLabel:lang("sBWDJ"),width:100,readOnly:true,name:"oncktimes",id:a.ID_oncktimes,style:"text-align:center; font-weight: bold; color:#119911;"},{xtype:"textfield",fieldLabel:lang("xBWDJ"),width:100,readOnly:true,name:"offcktimes",id:a.ID_offcktimes,style:"text-align:center; font-weight: bold; color:#119911;"}]}]});this.grid=new Ext.grid.GridPanel({stripeRows:true,border:false,bodyStyle:"border-top-width: 1px",store:a.store,loadMask:{msg:lang("waiting")},cm:a.colModel,sm:a.sm,hideBorders:true,listeners:{afterrender:function(){a.topPanel.render(this.tbar)}},tbar:new Ext.Toolbar({items:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){a.store.reload()}},lang("startTime")+"：",{xtype:"datefield",format:"Y-m-d",value:new Date(),width:140,id:a.ID_stime},lang("endTime")+"：",{xtype:"datefield",format:"Y-m-d",value:new Date(),width:140,id:a.ID_etime},{text:lang("search"),handler:function(){uid=a.uid;stime=Ext.getCmp(a.ID_stime).getRawValue();etime=Ext.getCmp(a.ID_etime).getRawValue();a.findFields.uid=uid;a.findFields.stime=stime;a.findFields.etime=etime;a.store.load({params:{uid:uid,stime:stime,etime:etime}})}},{text:lang("clear"),handler:function(){uid=a.uid;Ext.getCmp(a.ID_stime).setValue(new Date());Ext.getCmp(a.ID_etime).setValue(new Date());a.findFields.stime="";a.findFields.etime="";a.store.load({params:{uid:uid}})}},"->",{xtype:"cnoa_helpBtn",helpid:3012}]}),bbar:a.pagingBar})},renWorktime:function(value,metaData,record,rowIndex,colIndex,store){var _this=this;var s="";var restDay=record.json.restDay;eval("ctime = record.json.ctime"+(colIndex-2));eval("ctype = record.json.ctype"+(colIndex-2));eval("explain = record.json.explain"+(colIndex-2));if(value!=""){s=value;if(colIndex>=3){date=record.json.date;atime=Date.parse(date+" "+value);btime=Date.parse(date+" "+ctime);stype="";if(restDay==""){if(ctype==0){if(atime>btime){stype=lang("late")}}else{if(atime<btime){stype=lang("leaveEarly")}}}s+='<b style="color:red;">'+stype+"</b>"}}else{var sHeader=_this.colModel.getColumnHeader(colIndex);if(sHeader!=""){if(restDay!=""){switch(parseInt(restDay)){case 1:s='<span style="color:#22AA33;">'+lang("gongxiu")+"</span>";break;case 2:s='<span style="color:#22AA33;">'+lang("holidays")+"</span>";break}}else{s='<span style="color:#EE2233;">'+lang("unRegister")+"</span>"}}}if(explain!=""&&explain!=undefined){explain=explain.replace(/\n/g,"<BR>");var img='<img src="/resources/images/icons/message.gif" ext:qtip="'+explain+'" />';var ss="<span>"+img+"</span>";s+=ss}return s}};CNOA_hr_attendance_record_egressionClass=CNOA.Class.create();CNOA_hr_attendance_record_egressionClass.prototype={init:function(){var a=this;this.baseUrl="index.php?app=hr&func=attendance&action=record";this.type="add";this.edit_id=0;this.uid=0;this.ID_stime=Ext.id();this.ID_etime=Ext.id();this.ID_status=Ext.id();this.fields=[{name:"id"},{name:"posttime"},{name:"verifier"},{name:"status"},{name:"stime"},{name:"etime"},{name:"reason"},{name:"truename"}];this.findFields={stime:"",etime:"",status:-1};this.clearSearch=function(){var c=Ext.getCmp(a.ID_stime);var d=Ext.getCmp(a.ID_etime);var b=Ext.getCmp(a.ID_status);c.setValue(new Date());d.setValue(new Date());b.setValue("-1")};this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getEgression",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields}),listeners:{load:function(e,c,d){var b=e.reader.jsonData},exception:function(h,g,i,f,d,c){var e=d.responseText;if(e!=""){var b=Ext.decode(e);if(b.failure){CNOA.msg.alert(b.msg)}}}}});a.store.load();this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),{header:"id",dataIndex:"id",hidden:true},{header:lang("proposer"),dataIndex:"truename",width:100,sortable:false,menuDisabled:true},{header:lang("appTime"),dataIndex:"posttime",width:111,sortable:false,menuDisabled:true,renderer:a.renPosttime.createDelegate(this)},{header:lang("approvalor"),dataIndex:"verifier",width:111,sortable:false,menuDisabled:true,renderer:a.renWorktime.createDelegate(this)},{header:lang("status"),dataIndex:"status",width:80,sortable:false,menuDisabled:true,renderer:a.renStatus.createDelegate(this)},{header:lang("WCYY"),dataIndex:"reason",width:360,sortable:false,menuDisabled:true,renderer:a.renDetail.createDelegate(this)},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({displayInfo:true,store:a.store,pageSize:15,listeners:{beforechange:function(b,c){c.uid=a.uid;c.status=a.findFields.status;if(a.findFields.stime!=""){c.stime=a.findFields.stime}if(a.findFields.etime!=""){c.etime=a.findFields.etime}}}});this.grid=new Ext.grid.GridPanel({stripeRows:true,border:false,store:a.store,loadMask:{msg:lang("waiting")},cm:a.colModel,sm:a.sm,hideBorders:true,listeners:{cellclick:function(b,j,i,h){var d=a.store.reader.jsonData.data[j];var c=d.stime;var f=d.etime;var g=d.reason;var k=lang("startTime")+'：<span style="color:#228833; font-weight:bold">'+c+"</span> - "+lang("endTime")+'：<span style="color:#228833; font-weight:bold">'+f+'</span><BR><div style="color:#333; padding:20px; ">'+g+"</div>";if(i==6){a.showDetail(k)}}},tbar:new Ext.Toolbar({items:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){a.store.reload()}},lang("startTime")+"：",{xtype:"datefield",format:"Y-m-d",value:new Date(),width:140,id:a.ID_stime},lang("endTime")+"：",{xtype:"datefield",format:"Y-m-d",value:new Date(),width:140,id:a.ID_etime},lang("status")+"：",{xtype:"combo",editable:false,valueField:"statusValue",displayField:"statusDisplay",triggerAction:"all",mode:"local",editable:false,width:160,store:new Ext.data.SimpleStore({fields:["statusValue","statusDisplay"],data:[[-1,lang("All")],[0,lang("hasReturn")],[1,lang("approved1")],[2,lang("notApprove")],[3,lang("outRegApp")],[4,lang("hasReturn")]]}),name:"cbStatus",hiddenName:"cbStatus",allowBlank:false,id:a.ID_status,value:-1,listeners:{select:function(d,b,c){a.findFields.status=c-1;a.store.load({params:{uid:a.uid,status:c-1,stime:a.findFields.stime,etime:a.findFields.etime}})}}},{text:lang("search"),handler:function(){uid=a.uid;stime=Ext.getCmp(a.ID_stime).getRawValue();etime=Ext.getCmp(a.ID_etime).getRawValue();status=a.findFields.status;a.findFields.stime=stime;a.findFields.etime=etime;a.store.load({params:{uid:uid,stime:stime,etime:etime,status:status}})}},{text:lang("clear"),handler:function(){uid=a.uid;Ext.getCmp(a.ID_stime).setValue(new Date());Ext.getCmp(a.ID_etime).setValue(new Date());a.findFields.stime="";a.findFields.etime="";a.findFields.status="-1";a.store.load({params:{uid:uid}})}},"->",{xtype:"cnoa_helpBtn",helpid:3013}]}),bbar:a.pagingBar})},showDetail:function(a){a=a.replace(/\n/g,"<BR> ");winInfos=new Ext.Window({title:lang("viewDetail1"),width:650,height:400,autoScroll:true,modal:true,bodyStyle:"padding: 20px; background-color:#fff",html:a,buttons:[{text:lang("close"),handler:function(){winInfos.close()}}]}).show()},renDetail:function(h,a,f,g,j,i){var k="";var c=f.data;var b=c.stime;var e=c.etime;var d=c.reason;k=lang("startTime")+'：<span style="color:#558899; font-weight:bold">'+b+"</span> - "+lang("endTime")+'：<span style="color:#558899; font-weight:bold">'+e+'</span><BR><span ext:qtip="'+lang("clickToView")+'" style="color:#888">'+d+"</span>";return k},renPosttime:function(f,b,a,g,d,c){var e="";e='<b style="color:#559966;">'+f+"</b>";return e},renWorktime:function(f,b,a,h,d,c){var g=this;var e=f;return e},renStatus:function(f,b,a,h,d,c){var g=this;var e="";switch(parseInt(f)){case 0:e='<span style="color:#4455AA">'+lang("Pending")+"</span>";break;case 1:e='<label style="color:#228822">'+lang("approved1")+"</label>";break;case 2:e='<label style="color:#EE2222">'+lang("notApprove")+"</label>";break;case 3:e='<label style="color:#2222AA">'+lang("returnAudit")+"</label>";break;case 4:e='<label style="color:#2222AA">'+lang("hasReturn")+"</label>";break}return e}};CNOA_hr_attendance_record_leaveClass=CNOA.Class.create();CNOA_hr_attendance_record_leaveClass.prototype={init:function(){var a=this;this.baseUrl="index.php?app=hr&func=attendance&action=record";this.type="add";this.edit_id=0;this.uid=0;this.ID_stime=Ext.id();this.ID_etime=Ext.id();this.ID_status=Ext.id();this.fields=[{name:"id"},{name:"posttime"},{name:"verifier"},{name:"status"},{name:"stime"},{name:"etime"},{name:"reason"},{name:"leaveDay"},{name:"truename"}];this.findFields={stime:"",etime:"",status:-1};this.clearSearch=function(){var c=Ext.getCmp(a.ID_stime);var d=Ext.getCmp(a.ID_etime);var b=Ext.getCmp(a.ID_status);c.setValue(new Date());d.setValue(new Date());b.setValue("-1")};this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getLeave",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields}),listeners:{load:function(e,c,d){var b=e.reader.jsonData},exception:function(h,g,i,f,d,c){var e=d.responseText;if(e!=""){var b=Ext.decode(e);if(b.failure){CNOA.msg.alert(b.msg)}}}}});a.store.load();this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),{header:"id",dataIndex:"id",hidden:true},{header:lang("proposer"),dataIndex:"truename",width:100,sortable:false,menuDisabled:true},{header:lang("appTime"),dataIndex:"posttime",width:111,sortable:false,menuDisabled:true,renderer:a.renPosttime.createDelegate(this)},{header:lang("approvalor"),dataIndex:"verifier",width:111,sortable:false,menuDisabled:true,renderer:a.renWorktime.createDelegate(this)},{header:lang("status"),dataIndex:"status",width:80,sortable:false,menuDisabled:true,renderer:a.renStatus.createDelegate(this)},{header:lang("useAnnual"),dataIndex:"leaveDay",width:80,sortable:false,menuDisabled:true,renderer:a.renLeaveday.createDelegate(this)},{header:lang("qjReason"),dataIndex:"reason",width:350,sortable:false,menuDisabled:true,renderer:a.renDetail.createDelegate(this)},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({displayInfo:true,store:a.store,pageSize:15,listeners:{beforechange:function(b,c){c.uid=a.uid;c.status=a.findFields.status;if(a.findFields.stime!=""){c.stime=a.findFields.stime}if(a.findFields.etime!=""){c.etime=a.findFields.etime}}}});this.grid=new Ext.grid.GridPanel({stripeRows:true,border:false,store:a.store,loadMask:{msg:lang("waiting")},cm:a.colModel,sm:a.sm,hideBorders:true,listeners:{cellclick:function(b,m,l,k){var g=a.store.reader.jsonData.data[m];var c=g.stime;var h=g.etime;var i=g.reason;var d=g.status;var j=g.otime;var f="";if(d==4){f=" - "+lang("XJSJ")+'：<b style="color:#228833">'+j+"</b>"}var n=lang("startTime")+'：<b style="color:#228833;">'+c+"</b> - "+lang("endTime")+'：<b style="color:#228833;">'+h+"</b> "+f+' <BR><div style="color:#333; padding:20px; ">'+i+"</div>";if(l==7){a.showDetail(n)}}},tbar:new Ext.Toolbar({items:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){a.store.reload()}},lang("startTime")+"：",{xtype:"datefield",format:"Y-m-d",value:new Date(),width:140,id:a.ID_stime},lang("endTime")+"：",{xtype:"datefield",format:"Y-m-d",value:new Date(),width:140,id:a.ID_etime},lang("status")+"：",{xtype:"combo",editable:false,valueField:"statusValue",displayField:"statusDisplay",triggerAction:"all",mode:"local",editable:false,width:160,store:new Ext.data.SimpleStore({fields:["statusValue","statusDisplay"],data:[[-1,lang("All")],[0,lang("Pending")],[1,lang("approved1")],[2,lang("notApprove")],[3,lang("appSickLeave")],[4,lang("yXiaoJia")]]}),name:"cbStatus",hiddenName:"cbStatus",allowBlank:false,id:a.ID_status,value:-1,listeners:{select:function(d,b,c){a.findFields.status=c-1;a.store.load({params:{uid:a.uid,status:c-1,stime:a.findFields.stime,etime:a.findFields.etime}})}}},{text:lang("search"),handler:function(){uid=a.uid;stime=Ext.getCmp(a.ID_stime).getRawValue();etime=Ext.getCmp(a.ID_etime).getRawValue();status=a.findFields.status;a.findFields.stime=stime;a.findFields.etime=etime;a.store.load({params:{uid:uid,stime:stime,etime:etime,status:status}})}},{text:lang("clear"),handler:function(){uid=a.uid;Ext.getCmp(a.ID_stime).setValue(new Date());Ext.getCmp(a.ID_etime).setValue(new Date());a.findFields.stime="";a.findFields.etime="";a.findFields.status="-1";a.store.load({params:{uid:uid}})}},"->",{xtype:"cnoa_helpBtn",helpid:3014}]}),bbar:a.pagingBar})},renLeaveday:function(f,b,a,g,d,c){var e="";e='<b style="color:#EE5566;">'+f+"</b>";return e},showDetail:function(a){a=a.replace(/\n/g,"<BR> ");winInfos=new Ext.Window({title:lang("viewDetail1"),width:650,height:400,autoScroll:true,modal:true,bodyStyle:"padding: 20px; background-color:#fff",html:a,buttons:[{text:lang("close"),handler:function(){winInfos.close()}}]}).show()},renDetail:function(h,a,f,g,j,i){var k="";var c=f.data;var b=c.stime;var e=c.etime;var d=c.reason;k=lang("startTime")+'：<span style="color:#558899; font-weight:bold">'+b+"</span> - "+lang("endTime")+'：<span style="color:#558899; font-weight:bold">'+e+'</span><BR><span ext:qtip="'+lang("clickToView")+'" style="color:#888">'+d+"</span>";return k},renPosttime:function(f,b,a,g,d,c){var e="";e='<b style="color:#559966;">'+f+"</b>";return e},renWorktime:function(f,b,a,h,d,c){var g=this;var e=f;return e},renStatus:function(e,b,a,g,d,c){var f=this;switch(parseInt(e)){case 0:s='<span style="color:#4455AA">'+lang("Pending")+"</span>";break;case 1:s='<label style="color:#228822">'+lang("approved1")+"</label>";break;case 2:s='<label style="color:#EE2222">'+lang("notApprove")+"</label>";break;case 3:s='<label style="color:#2222AA">'+lang("appSickLeave")+"</label>";break;case 4:s='<label style="color:#2A2A2A">'+lang("yXiaoJia")+"</label>";break}return s}};CNOA_hr_attendance_record_evectionClass=CNOA.Class.create();CNOA_hr_attendance_record_evectionClass.prototype={init:function(){var a=this;this.baseUrl="index.php?app=hr&func=attendance&action=record";this.type="add";this.edit_id=0;this.uid=0;this.ID_stime=Ext.id();this.ID_etime=Ext.id();this.ID_status=Ext.id();this.fields=[{name:"id"},{name:"posttime"},{name:"verifier"},{name:"status"},{name:"stime"},{name:"etime"},{name:"reason"},{name:"address"},{name:"truename"}];this.findFields={stime:"",etime:"",status:-1};this.clearSearch=function(){var c=Ext.getCmp(a.ID_stime);var d=Ext.getCmp(a.ID_etime);var b=Ext.getCmp(a.ID_status);c.setValue(new Date());d.setValue(new Date());b.setValue("-1")};this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getEvection",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields}),listeners:{load:function(e,c,d){var b=e.reader.jsonData},exception:function(h,g,i,f,d,c){var e=d.responseText;if(e!=""){var b=Ext.decode(e);if(b.failure){CNOA.msg.alert(b.msg)}}}}});a.store.load();this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),{header:"id",dataIndex:"id",hidden:true},{header:lang("proposer"),dataIndex:"truename",width:100,sortable:false,menuDisabled:true},{header:lang("appTime"),dataIndex:"posttime",width:111,sortable:false,menuDisabled:true,renderer:a.renPosttime.createDelegate(this)},{header:lang("approvalor"),dataIndex:"verifier",width:111,sortable:false,menuDisabled:true,renderer:a.renWorktime.createDelegate(this)},{header:lang("status"),dataIndex:"status",width:80,sortable:false,menuDisabled:true,renderer:a.renStatus.createDelegate(this)},{header:lang("travelSites"),dataIndex:"address",width:131,sortable:false,menuDisabled:true,renderer:a.renAddress.createDelegate(this)},{header:lang("travelReason"),dataIndex:"reason",width:340,sortable:false,menuDisabled:true,renderer:a.renDetail.createDelegate(this)},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({displayInfo:true,store:a.store,pageSize:15,listeners:{beforechange:function(b,c){c.uid=a.uid;c.status=a.findFields.status;if(a.findFields.stime!=""){c.stime=a.findFields.stime}if(a.findFields.etime!=""){c.etime=a.findFields.etime}}}});this.grid=new Ext.grid.GridPanel({stripeRows:true,border:false,store:a.store,loadMask:{msg:lang("waiting")},cm:a.colModel,sm:a.sm,hideBorders:true,listeners:{cellclick:function(b,j,i,h){var d=a.store.reader.jsonData.data[j];var c=d.stime;var f=d.etime;var g=d.reason;var k=lang("startTime")+'：<span style="color:#228833; font-weight:bold">'+c+"</span> - "+lang("endTime")+'：<span style="color:#228833; font-weight:bold">'+f+"</span> - "+lang("travelSites")+'：<span style="color:#228833; font-weight:bold">'+d.address+'</span><BR><div style="color:#333; padding:20px; ">'+g+"</div>";if(i==7){a.showDetail(k)}}},tbar:new Ext.Toolbar({items:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){a.store.reload()}},lang("startTime")+"：",{xtype:"datefield",format:"Y-m-d",value:new Date(),width:140,id:a.ID_stime},lang("endTime")+"：",{xtype:"datefield",format:"Y-m-d",value:new Date(),width:140,id:a.ID_etime},lang("status")+"：",{xtype:"combo",editable:false,valueField:"statusValue",displayField:"statusDisplay",triggerAction:"all",mode:"local",editable:false,width:160,store:new Ext.data.SimpleStore({fields:["statusValue","statusDisplay"],data:[[-1,lang("All")],[0,lang("Pending")],[1,lang("approved1")],[2,lang("notApprove")],[3,lang("hasReturn")]]}),name:"cbStatus",hiddenName:"cbStatus",allowBlank:false,id:a.ID_status,value:-1,listeners:{select:function(d,b,c){a.findFields.status=c-1;a.store.load({params:{uid:a.uid,status:c-1,stime:a.findFields.stime,etime:a.findFields.etime}})}}},{text:lang("search"),handler:function(){uid=a.uid;stime=Ext.getCmp(a.ID_stime).getRawValue();etime=Ext.getCmp(a.ID_etime).getRawValue();status=a.findFields.status;a.findFields.stime=stime;a.findFields.etime=etime;a.store.load({params:{uid:uid,stime:stime,etime:etime,status:status}})}},{text:lang("clear"),handler:function(){uid=a.uid;Ext.getCmp(a.ID_stime).setValue(new Date());Ext.getCmp(a.ID_etime).setValue(new Date());a.findFields.stime="";a.findFields.etime="";a.findFields.status="-1";a.store.load({params:{uid:uid}})}},"->",{xtype:"cnoa_helpBtn",helpid:3015}]}),bbar:a.pagingBar})},renAddress:function(f,b,a,g,d,c){var e="";e='<span style="color:#111155;">'+f+"</span>";return e},showDetail:function(a){a=a.replace(/\n/g,"<BR> ");winInfos=new Ext.Window({title:lang("viewDetail1"),width:650,height:400,autoScroll:true,modal:true,bodyStyle:"padding: 20px; background-color:#fff",html:a,buttons:[{text:lang("close"),handler:function(){winInfos.close()}}]}).show()},renDetail:function(h,a,f,g,j,i){var k="";var c=f.data;var b=c.stime;var e=c.etime;var d=c.reason;k=lang("startTime")+'：<span style="color:#558899; font-weight:bold">'+b+'</span> - 结束时间：<span style="color:#558899; font-weight:bold">'+e+'</span><BR><span ext:qtip="点击查看详细" style="color:#888">'+d+"</span>";return k},renPosttime:function(f,b,a,g,d,c){var e="";e='<b style="color:#559966;">'+f+"</b>";return e},renWorktime:function(f,b,a,h,d,c){var g=this;var e=f;return e},renStatus:function(e,b,a,g,d,c){var f=this;switch(parseInt(e)){case 0:s='<span style="color:#4455AA">'+lang("Pending")+"</span>";break;case 1:s='<label style="color:#228822">'+lang("approved1")+"</label>";break;case 2:s='<label style="color:#EE2222">'+lang("notApprove")+"</label>";break;case 3:s='<label style="color:#2222AA">已归来</label>';break}return s}};CNOA_hr_attendance_record_overtimeClass=CNOA.Class.create();CNOA_hr_attendance_record_overtimeClass.prototype={init:function(){var a=this;this.baseUrl="index.php?app=hr&func=attendance&action=record";this.type="add";this.edit_id=0;this.uid=0;this.ID_stime=Ext.id();this.ID_etime=Ext.id();this.ID_status=Ext.id();this.fields=[{name:"id"},{name:"posttime"},{name:"verifier"},{name:"status"},{name:"stime"},{name:"etime"},{name:"reason"},{name:"truename"},{name:"hour"},{name:"minute"}];this.findFields={stime:"",etime:"",status:-1};this.clearSearch=function(){var c=Ext.getCmp(a.ID_stime);var d=Ext.getCmp(a.ID_etime);var b=Ext.getCmp(a.ID_status);c.setValue(new Date());d.setValue(new Date());b.setValue("-1")};this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getOvertime",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields}),listeners:{load:function(e,c,d){var b=e.reader.jsonData},exception:function(h,g,i,f,d,c){var e=d.responseText;if(e!=""){var b=Ext.decode(e);if(b.failure){CNOA.msg.alert(b.msg)}}}}});a.store.load();this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),{header:"id",dataIndex:"id",hidden:true},{header:lang("proposer"),dataIndex:"truename",width:100,sortable:false,menuDisabled:true},{header:lang("appTime"),dataIndex:"posttime",width:111,sortable:false,menuDisabled:true,renderer:a.renPosttime.createDelegate(this)},{header:lang("approvalor"),dataIndex:"verifier",width:111,sortable:false,menuDisabled:true,renderer:a.renWorktime.createDelegate(this)},{header:lang("status"),dataIndex:"status",width:80,sortable:false,menuDisabled:true,renderer:a.renStatus.createDelegate(this)},{header:lang("jiabanTime"),dataIndex:"hour",width:131,sortable:false,menuDisabled:true,renderer:a.renTimes.createDelegate(this)},{header:lang("otReason"),dataIndex:"reason",width:340,sortable:false,menuDisabled:true,renderer:a.renDetail.createDelegate(this)},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({displayInfo:true,store:a.store,pageSize:15,listeners:{beforechange:function(b,c){c.uid=a.uid;c.status=a.findFields.status;if(a.findFields.stime!=""){c.stime=a.findFields.stime}if(a.findFields.etime!=""){c.etime=a.findFields.etime}}}});this.grid=new Ext.grid.GridPanel({stripeRows:true,border:false,store:a.store,loadMask:{msg:lang("waiting")},cm:a.colModel,sm:a.sm,hideBorders:true,listeners:{cellclick:function(b,j,i,h){var d=a.store.reader.jsonData.data[j];var c=d.stime;var f=d.etime;var g=d.reason;var k=lang("startTime")+'：<span style="color:#228833; font-weight:bold">'+c+"</span> - "+lang("endTime")+'：<span style="color:#228833; font-weight:bold">'+f+'</span><BR><div style="color:#333; padding:20px; ">'+g+"</div>";if(i==7){a.showDetail(k)}}},tbar:new Ext.Toolbar({items:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){a.store.reload()}},lang("startTime")+"：",{xtype:"datefield",format:"Y-m-d",value:new Date(),width:140,id:a.ID_stime},lang("endTime")+"：",{xtype:"datefield",format:"Y-m-d",value:new Date(),width:140,id:a.ID_etime},lang("status")+"：",{xtype:"combo",editable:false,valueField:"statusValue",displayField:"statusDisplay",triggerAction:"all",mode:"local",editable:false,width:160,store:new Ext.data.SimpleStore({fields:["statusValue","statusDisplay"],data:[[-1,lang("All")],[0,lang("Pending")],[1,lang("approved1")],[2,lang("notApprove")],[3,lang("confirmed")]]}),name:"cbStatus",hiddenName:"cbStatus",allowBlank:false,id:a.ID_status,value:-1,listeners:{select:function(d,b,c){a.findFields.status=c-1;a.store.load({params:{uid:a.uid,status:c-1,stime:a.findFields.stime,etime:a.findFields.etime}})}}},{text:lang("search"),handler:function(){uid=a.uid;stime=Ext.getCmp(a.ID_stime).getRawValue();etime=Ext.getCmp(a.ID_etime).getRawValue();status=a.findFields.status;a.findFields.stime=stime;a.findFields.etime=etime;a.store.load({params:{uid:uid,stime:stime,etime:etime,status:status}})}},{text:lang("clear"),handler:function(){uid=a.uid;Ext.getCmp(a.ID_stime).setValue(new Date());Ext.getCmp(a.ID_etime).setValue(new Date());a.findFields.stime="";a.findFields.etime="";a.findFields.status="-1";a.store.load({params:{uid:uid}})}},"->",{xtype:"cnoa_helpBtn",helpid:3016}]}),bbar:a.pagingBar})},renTimes:function(g,a,e,f,i,h){var j="";var d=e.data;var c=d.hour;var b=d.minute;j='<span style="color:#5566AA;">'+c+lang("hour")+b+lang("minute")+"</span>";return j},showDetail:function(a){a=a.replace(/\n/g,"<BR> ");winInfos=new Ext.Window({title:lang("viewDetail1"),width:650,height:400,autoScroll:true,modal:true,bodyStyle:"padding: 20px; background-color:#fff",html:a,buttons:[{text:lang("close"),handler:function(){winInfos.close()}}]}).show()},renDetail:function(h,a,f,g,j,i){var k="";var c=f.data;var b=c.stime;var e=c.etime;var d=c.reason;k=lang("startTime")+'：<span style="color:#558899; font-weight:bold">'+b+"</span> - "+lang("endTime")+'：<span style="color:#558899; font-weight:bold">'+e+'</span><BR><span ext:qtip="'+lang("clickToView")+'" style="color:#888">'+d+"</span>";return k},renPosttime:function(f,b,a,g,d,c){var e="";e='<b style="color:#559966;">'+f+"</b>";return e},renWorktime:function(f,b,a,h,d,c){var g=this;var e=f;return e},renStatus:function(e,b,a,g,d,c){var f=this;switch(parseInt(e)){case 0:s='<span style="color:#4455AA">'+lang("Pending")+"</span>";break;case 1:s='<label style="color:#228822">'+lang("approved1")+"</label>";break;case 2:s='<label style="color:#EE2222">'+lang("notApprove")+"</label>";break;case 3:s='<label style="color:#2222AA">'+lang("jBQR")+"</label>";break}return s}};CNOA_hr_attendance_recordClass=CNOA.Class.create();CNOA_hr_attendance_recordClass.prototype={init:function(){var f=this;this.baseUrl="index.php?app=hr&func=attendance&action=record";var d=new CNOA_hr_attendance_record_wtClass();var e=new CNOA_hr_attendance_record_egressionClass();var b=new CNOA_hr_attendance_record_leaveClass();var a=new CNOA_hr_attendance_record_evectionClass();var c=new CNOA_hr_attendance_record_overtimeClass();this.tabPanel=new Ext.TabPanel({region:"center",border:false,bodyStyle:"border-left-width:1px",items:[{title:lang("sXBDJ"),layout:"fit",items:[d.grid]},{title:lang("wCDJ"),layout:"fit",items:[e.grid]},{title:lang("qJDJ"),layout:"fit",items:[b.grid]},{title:lang("cCDJ"),layout:"fit",items:[a.grid]},{title:lang("jBDJ"),layout:"fit",items:[c.grid]}],activeItem:0});this.treeRoot=new Ext.tree.AsyncTreeNode({text:lang("companyPerson"),expanded:true});this.treeLoader=new Ext.tree.TreeLoader({dataUrl:this.baseUrl+"&task=getUsersTree",preloadChildren:true,clearOnLoad:false,listeners:{load:function(g){this.deptTree.expandAll();this.deptTree.getEl().unmask()}.createDelegate(this)}});this.deptTree=new Ext.tree.TreePanel({hideBorders:true,border:false,rootVisible:false,lines:true,animCollapse:false,animate:false,loader:this.treeLoader,root:this.treeRoot,autoScroll:true,listeners:{click:function(g){attr=g.attributes;uid=attr.uid;if(uid!=undefined){d.uid=uid;d.store.load({params:{uid:uid}});e.uid=uid;e.store.load({params:{uid:uid}});b.uid=uid;b.store.load({params:{uid:uid}});a.uid=uid;a.store.load({params:{uid:uid}});c.uid=uid;c.store.load({params:{uid:uid}});d.clearSearch();e.clearSearch();b.clearSearch();a.clearSearch();c.clearSearch()}}}});this.deptPanel=new Ext.Panel({region:"west",layout:"fit",split:true,width:180,minWidth:150,maxWidth:300,border:false,bodyStyle:"border-right-width:1px;",items:[this.deptTree],tbar:new Ext.Toolbar({style:"border-right-width:1px;",items:[{handler:function(g,h){f.treeRoot.reload()}.createDelegate(this),iconCls:"icon-system-refresh",tooltip:lang("refresh"),text:lang("refresh")},{text:lang("collapse"),iconCls:"icon-expand-all",id:this.ID_btn_collapseExpand,tooltip:lang("expandMenuTip"),enableToggle:true,toggleHandler:function(g,h){if(h){g.setIconClass("icon-expand-all");g.setText(lang("expand"));g.setTooltip(lang("expandMenuTip"));f.treeRoot.collapse(true);f.treeRoot.firstChild.expand()}else{g.setIconClass("icon-collapse-all");g.setText(lang("collapse"));g.setTooltip(lang("collapseMenuTip"));f.treeRoot.expand(true)}}}]})});this.mainPanel=new Ext.Panel({border:false,layout:"border",items:[this.deptPanel,this.tabPanel]})}};var CNOA_hr_attendance_setting,CNOA_hr_attendance_settingClass;CNOA_hr_attendance_setting_pbClass=CNOA.Class.create();CNOA_hr_attendance_setting_pbClass.prototype={init:function(){var a=this;this.baseUrl="index.php?app=hr&func=attendance&action=setting";this.type="add";this.edit_id=0;this.fields=[{name:"id"},{name:"name"},{name:"pbTime1"},{name:"pbTime2"},{name:"pbTime3"},{name:"pbTime4"},{name:"pbTime5"},{name:"pbTime6"}];this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=worktime",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields})});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.store.load();this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),this.sm,{header:"id",dataIndex:"id",hidden:true},{header:lang("typeOfSchedu"),dataIndex:"name",width:180,sortable:false,menuDisabled:true},{header:lang("firstDJ"),dataIndex:"pbTime1",width:100,sortable:false,menuDisabled:true},{header:lang("secondDJ"),dataIndex:"pbTime2",width:100,sortable:false,menuDisabled:true},{header:lang("thirdDJ"),dataIndex:"pbTime3",width:100,sortable:false,menuDisabled:true},{header:lang("fourDJ"),dataIndex:"pbTime4",width:100,sortable:false,menuDisabled:true},{header:lang("fiveDJ"),dataIndex:"pbTime5",width:100,sortable:false,menuDisabled:true},{header:lang("sixDJ"),dataIndex:"pbTime6",width:100,sortable:false,menuDisabled:true},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({displayInfo:true,store:this.store,pageSize:15});this.grid=new Ext.grid.GridPanel({stripeRows:true,border:false,bodyStyle:"border-left-width:1px",layout:"fit",store:this.store,loadMask:{msg:lang("waiting")},cm:this.colModel,sm:this.sm,hideBorders:true,listeners:{rowdblclick:function(b,c){var d=a.grid.getSelectionModel().getSelections();if(d.length==0){CNOA.miniMsg.alertShowAt(b,lang("mustSelectOneRow"))}else{a.type="edit";a.edit_id=d[0].get("id");a.showAddWindow()}}},tbar:new Ext.Toolbar({style:"border-left-width:1px",items:[{text:lang("newPB"),iconCls:"icon-utils-s-add",handler:function(){a.type="add";a.showAddWindow()}},{handler:function(b,c){var d=a.grid.getSelectionModel().getSelections();if(d.length==0){CNOA.miniMsg.alertShowAt(b,lang("mustSelectOneRow"))}else{a.type="edit";a.edit_id=d[0].get("id");a.showAddWindow()}}.createDelegate(this),iconCls:"icon-utils-s-edit",text:lang("modify")},{text:lang("del"),iconCls:"icon-utils-s-delete",handler:function(b){a.deleteList(b)}},{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){this.store.reload()}.createDelegate(this)},"<span class='cnoa_color_gray'>"+lang("doubleClick")+"</span>","->",{xtype:"cnoa_helpBtn",helpid:3002}]}),bbar:this.pagingBar});this.mainPanel=new Ext.Panel({border:false,layout:"fit",title:lang("typeOfSchedu"),items:[a.grid]})},deleteList:function(a){var c=this;var b=this.grid.getSelectionModel().getSelections();if(b.length==0){CNOA.miniMsg.alertShowAt(a,lang("mustSelectOneRow"))}else{CNOA.msg.cf(lang("errorToDelete"),function(e){if(e=="yes"){if(b){var f="";for(var d=0;d<b.length;d++){id=b[d].get("id");if(id!=1){f+=id+","}}c.deleteData(f)}}})}},deleteData:function(a){var b=this;Ext.Ajax.request({url:this.baseUrl+"&task=delWorkTime",method:"POST",params:{ids:a},success:function(d){var c=Ext.decode(d.responseText);if(c.success===true){CNOA.msg.notice(c.msg,lang("hrMgr"));b.store.reload()}else{CNOA.msg.alert(c.msg)}}})},showAddWindow:function(){var g=this;var a=Ext.id();var f="";var e="";if(g.type=="add"){f=lang("newPB");e=g.baseUrl+"&task=addWorkTime"}else{f=lang("EditSchedu");e=g.baseUrl+"&task=editWorkTime"}var c=function(h){var i=this.formPanel.getForm();if(i.isValid()){i.submit({url:e,waitTitle:lang("notice"),method:"POST",waitMsg:lang("waiting"),params:{id:g.edit_id},success:function(j,k){g.addEditWindow.close();g.store.reload()}.createDelegate(this),failure:function(j,k){CNOA.msg.alert(k.result.msg)}.createDelegate(this)})}else{CNOA.miniMsg.alertShowAt(a,lang("formValid"))}}.createDelegate(this);var d=function(){g.formPanel.getForm().load({url:g.baseUrl+"&task=worktime&type=info",params:{id:g.edit_id},method:"POST",waitMsg:lang("waiting"),success:function(h,i){},failure:function(h,i){CNOA.msg.alert(i.result.msg,function(){g.close()})}.createDelegate(this)})};var b=function(h,k,j){var i="pbType"+h;if(k==undefined){k=""}if(j==undefined){j=0}return new Ext.Panel({layout:"table",border:false,fieldLabel:lang("di")+h+lang("timeDJ"),items:[{xtype:"timefield",name:"pbTime"+h,increment:15,format:"H:i",value:k,width:140},{xtype:"label",text:" ",width:10},{xtype:"combo",width:100,name:"pbType"+h,valueField:"value",displayField:i,triggerAction:"all",mode:"local",hiddenName:"pbType"+h,editable:false,store:new Ext.data.SimpleStore({fields:["value",i],data:[[0,lang("goWork")],[1,lang("offWork")]]}),value:j}]})};this.formPanel=new Ext.form.FormPanel({border:false,waitMsgTarget:true,bodyStyle:"padding: 10px",items:[{xtype:"fieldset",title:lang("scheduling"),layout:"form",labelWidth:90,labelAlign:"right",items:[{xtype:"textfield",fieldLabel:lang("pbTypeSay"),width:230,allowBlank:false,name:"pbName"},b(1),b(2),b(3),b(4),b(5),b(6)]},{xtype:"fieldset",title:lang("gongxiu"),layout:"table",layoutConfig:{columns:3},hideBorders:true,labelWidth:30,items:[{xtype:"panel",layout:"form",width:120,items:[{xtype:"checkbox",boxLabel:lang("monday"),name:"week1"},{xtype:"checkbox",boxLabel:lang("thursday"),name:"week4"},{xtype:"checkbox",boxLabel:lang("sunday"),name:"week0"}]},{xtype:"panel",layout:"form",width:120,items:[{xtype:"checkbox",boxLabel:lang("tuesday"),name:"week2"},{xtype:"checkbox",boxLabel:lang("friday"),name:"week5"},{xtype:"displayfield",height:26}]},{xtype:"panel",layout:"form",width:120,items:[{xtype:"checkbox",boxLabel:lang("wednesday"),name:"week3"},{xtype:"checkbox",boxLabel:lang("saturday"),name:"week6"},{xtype:"displayfield",height:26}]}]}]});this.addEditWindow=new Ext.Window({width:400,height:makeWindowHeight(500),modal:true,autoDestroy:true,closeAction:"close",resizable:false,title:f,layout:"fit",items:[this.formPanel],buttons:[{text:lang("save"),id:a,iconCls:"icon-btn-save",handler:function(){c()}.createDelegate(this)},{text:lang("cancel"),id:this.ID_btn_close,iconCls:"icon-dialog-cancel",handler:function(){this.addEditWindow.close()}.createDelegate(this)}]});this.addEditWindow.show();if(g.type=="edit"){d()}}};CNOA_hr_attendance_setting_djClass=CNOA.Class.create();CNOA_hr_attendance_setting_djClass.prototype={init:function(){var d=this;this.baseUrl="index.php?app=hr&func=attendance&action=setting";var a=Ext.id();var c=function(){d.mainPanel.getForm().load({url:d.baseUrl+"&task=CheckTime_info",method:"POST",success:function(e,f){},failure:function(e,f){CNOA.msg.alert(f.result.msg)}})};var b=function(e){var g=this.mainPanel.getForm();if(g.isValid()){g.submit({url:d.baseUrl+"&task=CheckTime_update",method:"POST",params:{},success:function(f,h){CNOA.msg.notice(h.result.msg,lang("hrMgr"))},failure:function(f,h){CNOA.msg.alert(h.result.msg)}})}else{CNOA.miniMsg.alertShowAt(a,lang("formValid"))}}.createDelegate(this);this.mainPanel=new Ext.form.FormPanel({border:false,bodyStyle:"border-left-width:1px; padding:10px;",title:lang("dJSJD"),tbar:[{text:lang("save"),id:a,iconCls:"icon-btn-save",handler:function(){b()}.createDelegate(this)},'<span style="color:gray;"><<<'+lang("clickSaveData")+"</span>","->",{xtype:"cnoa_helpBtn",helpid:3017}],items:[{xtype:"panel",width:990,border:false,items:[{xtype:"fieldset",title:lang("setSB"),labelWidth:130,width:980,defaults:{style:{marginBottom:"10px"}},items:[{xtype:"textfield",fieldLabel:lang("allowgotowork1"),name:"onbeforetime"},{xtype:"textfield",fieldLabel:lang("allowgotowork"),name:"onaftertime"}]}]},{xtype:"panel",width:990,border:false,items:[{xtype:"fieldset",title:lang("setGetOffWork"),labelWidth:130,width:980,items:[{xtype:"textfield",fieldLabel:lang("getOffWorkBefore"),name:"offbeforetime"},{xtype:"textfield",fieldLabel:lang("getOffWorlAfter"),name:"offaftertime"}]}]},{xtype:"hidden",listeners:{afterrender:function(){c()}}},{xtype:"panel",width:990,border:false,items:[{xtype:"fieldset",title:lang("sXBremind"),labelWidth:20,width:980,items:[{xtype:"checkbox",boxLabel:lang("shifouTiXing"),name:"alert"}]}]},{xtype:"panel",width:990,border:false,width:980,items:[{xtype:"fieldset",title:lang("bindIp"),labelWidth:20,items:[{xtype:"checkbox",boxLabel:lang("qiYongBindIp"),name:"bindIP"}]}]}]})}};CNOA_hr_attendance_setting_specialClass=CNOA.Class.create();CNOA_hr_attendance_setting_specialClass.prototype={init:function(){var d=this;d.ID_allUserButton=Ext.id();d.ID_allUserField=Ext.id();this.baseUrl="index.php?app=hr&func=attendance&action=setting";var a=Ext.id();var c=function(){d.mainPanel.getForm().load({url:d.baseUrl+"&task=special_info",method:"POST",success:function(e,f){},failure:function(e,f){CNOA.msg.alert(f.result.msg)}})};var b=function(e){var g=this.mainPanel.getForm();if(g.isValid()){g.submit({url:d.baseUrl+"&task=special_update",method:"POST",params:{},success:function(f,h){CNOA.msg.notice(h.result.msg,lang("hrMgr"))},failure:function(f,h){CNOA.msg.alert(h.result.msg)}})}else{CNOA.miniMsg.alertShowAt(a,lang("formValid"))}}.createDelegate(this);this.mainPanel=new Ext.form.FormPanel({border:false,bodyStyle:"border-left-width:1px",layout:"fit",title:lang("mianQianPerson"),tbar:[{text:lang("save"),id:a,iconCls:"icon-btn-save",handler:function(){b()}.createDelegate(this)},'<span style="color:gray;"><<<'+lang("clickSaveData")+"</span>","->",{xtype:"cnoa_helpBtn",helpid:3018}],items:[{xtype:"fieldset",style:"margin: 10px 0 0 0; padding: 0",width:500,border:false,labelAlign:"right",id:d.ID_allUserField,items:[{xtype:"textarea",style:"margin: 0; padding: 0;",height:130,width:400,readOnly:true,fieldLabel:lang("mianQianPerson"),name:"allUserNames"},{xtype:"hidden",name:"allUids",listeners:{afterrender:function(){c()}}},{xtype:"btnForPoepleSelector",id:d.ID_allUserButton,style:"margin: 0; padding: 0",autoWidth:true,dataUrl:d.baseUrl+"&task=getAllUserListsInPermitDeptTree",style:"margin-left:105px;",text:lang("selectPeople"),listeners:{selected:function(g,h){var j=new Array();var f=new Array();if(h.length>0){for(var e=0;e<h.length;e++){j.push(h[e].uname);f.push(h[e].uid)}}d.mainPanel.getForm().findField("allUserNames").setValue(j.join(","));d.mainPanel.getForm().findField("allUids").setValue(f.join(","))},onrender:function(e){e.setSelectedUids(d.mainPanel.getForm().findField("allUids").getValue().split(","))}}}]}]})}};CNOA_hr_attendance_setting_vacationClass=CNOA.Class.create();CNOA_hr_attendance_setting_vacationClass.prototype={init:function(){var a=this;this.baseUrl="index.php?app=hr&func=attendance&action=setting";this.type="add";this.edit_id=0;this.fields=[{name:"id"},{name:"begindate"},{name:"enddate"}];this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=vacation_list",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields})});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.store.load();this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),this.sm,{header:"id",dataIndex:"id",hidden:true},{header:lang("startDate"),dataIndex:"begindate",width:180,sortable:true,menuDisabled:true},{header:lang("endDate"),dataIndex:"enddate",width:180,sortable:false,menuDisabled:true},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({displayInfo:true,store:this.store,pageSize:15});this.grid=new Ext.grid.GridPanel({stripeRows:true,border:false,bodyStyle:"border-left-width:1px",layout:"fit",store:this.store,loadMask:{msg:lang("waiting")},cm:this.colModel,sm:this.sm,hideBorders:true,listeners:{rowdblclick:function(b,c){var d=a.grid.getSelectionModel().getSelections();if(d.length==0){CNOA.miniMsg.alertShowAt(b,lang("mustSelectOneRow"))}else{a.type="edit";a.edit_id=d[0].get("id");a.showAddWindow()}}},tbar:[{text:lang("addHoliday"),iconCls:"icon-utils-s-add",handler:function(){a.type="add";a.showAddWindow()}},{handler:function(b,c){var d=a.grid.getSelectionModel().getSelections();if(d.length==0){CNOA.miniMsg.alertShowAt(b,lang("mustSelectOneRow"))}else{a.type="edit";a.edit_id=d[0].get("id");a.showAddWindow()}}.createDelegate(this),iconCls:"icon-utils-s-edit",text:lang("modify")},{text:lang("del"),iconCls:"icon-utils-s-delete",handler:function(b){a.deleteList(b)}},{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){this.store.reload()}.createDelegate(this)},"<span class='cnoa_color_gray'>"+lang("doubleClick")+"</span>","->",{xtype:"cnoa_helpBtn",helpid:3003}],bbar:this.pagingBar});this.mainPanel=new Ext.Panel({border:false,layout:"fit",title:lang("visaHolidays"),items:[a.grid]})},deleteList:function(a){var c=this;var b=this.grid.getSelectionModel().getSelections();if(b.length==0){CNOA.miniMsg.alertShowAt(a,lang("mustSelectOneRow"))}else{CNOA.msg.cf(lang("areYouDelete"),function(e){if(e=="yes"){if(b){var f="";for(var d=0;d<b.length;d++){f+=b[d].get("id")+","}c.deleteData(f)}}})}},deleteData:function(a){var b=this;Ext.Ajax.request({url:this.baseUrl+"&task=vacation_del",method:"POST",params:{ids:a},success:function(d){var c=Ext.decode(d.responseText);if(c.success===true){CNOA.msg.notice(c.msg,lang("hrMgr"));b.store.reload()}else{CNOA.msg.alert(c.msg)}}})},showAddWindow:function(){var f=this;var a=Ext.id();var e="";var d="";if(f.type=="add"){e=lang("addHolidays1");d=f.baseUrl+"&task=vacation_add"}else{e=lang("editHolidays");d=f.baseUrl+"&task=vacation_edit"}var b=function(g){var h=this.formPanel.getForm();if(h.isValid()){h.submit({url:d,waitTitle:lang("notice"),method:"POST",waitMsg:lang("waiting"),params:{id:f.edit_id},success:function(i,j){f.addEditWindow.close();f.store.reload();CNOA.msg.notice(j.result.msg,lang("hrMgr"))}.createDelegate(this),failure:function(i,j){CNOA.msg.alert(j.result.msg)}.createDelegate(this)})}else{CNOA.miniMsg.alertShowAt(a,lang("formValid"))}}.createDelegate(this);var c=function(){f.formPanel.getForm().load({url:f.baseUrl+"&task=vacation_info",params:{id:f.edit_id},method:"POST",waitMsg:lang("waiting"),success:function(g,h){},failure:function(g,h){CNOA.msg.alert(h.result.msg,function(){f.close()})}.createDelegate(this)})};this.formPanel=new Ext.form.FormPanel({hideBorders:true,border:false,waitMsgTarget:true,labelWidth:90,labelAlign:"right",items:[{xtype:"panel",border:false,layout:"form",bodyStyle:"padding: 10px",items:[{xtype:"datefield",fieldLabel:lang("startDate"),editable:false,format:"Y-m-d",allowBlank:false,name:"begindate",width:200},{xtype:"datefield",fieldLabel:lang("endDate"),editable:false,format:"Y-m-d",allowBlank:false,name:"enddate",width:200}]}]});this.addEditWindow=new Ext.Window({width:400,height:200,modal:true,autoDestroy:true,closeAction:"close",resizable:false,title:lang("visaHolidays"),layout:"fit",items:[this.formPanel],buttons:[{text:lang("save"),id:a,iconCls:"icon-btn-save",handler:function(){b()}.createDelegate(this)},{text:lang("cancel"),id:this.ID_btn_close,iconCls:"icon-dialog-cancel",handler:function(){this.addEditWindow.close()}.createDelegate(this)}]});this.addEditWindow.show();if(f.type=="edit"){c()}}};CNOA_hr_attendance_setting_spClass=CNOA.Class.create();CNOA_hr_attendance_setting_spClass.prototype={init:function(){var a=this;this.baseUrl="index.php?app=hr&func=attendance&action=setting";this.baseField=[{xtype:"fieldset",title:lang("approverSet"),style:"margin: 10px;",items:[{xtype:"selectorform",fieldLabel:lang("approvalor"),name:"uname",hiddenName:"uids",width:300}]}];this.mainPanel=new Ext.form.FormPanel({labelAlign:"right",labelWidth:110,items:this.baseField,border:false,title:lang("approverSet"),tbar:new Ext.Toolbar({style:"border-left-width:1px;",items:[{text:lang("save"),iconCls:"icon-btn-save",handler:function(b){a.submit(b)}}]})});this.mainPanel.getForm().load({url:a.baseUrl+"&task=loadSpSetting",waitMsg:lang("loading")})},submit:function(a){var c=this;var b=this.mainPanel.getForm();if(b.isValid()){b.submit({url:c.baseUrl+"&task=saveSpSetting",waitTitle:lang("notice"),method:"POST",waitMsg:lang("waiting"),success:function(d,e){CNOA.msg.notice2(e.result.msg)},failure:function(d,e){CNOA.msg.alert(e.result.msg)}})}else{CNOA.miniMsg.alertShowAt(a,lang("formValid"))}}};CNOA_hr_attendance_settingClass=CNOA.Class.create();CNOA_hr_attendance_settingClass.prototype={init:function(){var f=this;this.baseUrl="index.php?app=hr&func=attendance&action=setting";var d=new CNOA_hr_attendance_setting_pbClass();var e=new CNOA_hr_attendance_setting_djClass();var c=new CNOA_hr_attendance_setting_specialClass();var b=new CNOA_hr_attendance_setting_vacationClass();var a=new CNOA_hr_attendance_setting_spClass();this.centerPanel=new Ext.ux.VerticalTabPanel({region:"center",border:false,tabPosition:"left",resizeTabs:true,deferredRender:false,minTabWidth:150,tabWidth:150,activeItem:0,items:[d.mainPanel,e.mainPanel,c.mainPanel,b.mainPanel,a.mainPanel]});this.mainPanel=new Ext.Panel({border:false,layout:"border",items:[this.centerPanel]})}};var CNOA_hr_attendance_statistice,CNOA_hr_attendance_statisticeClass;CNOA_hr_attendance_statistice_wtClass=CNOA.Class.create();CNOA_hr_attendance_statistice_wtClass.prototype={init:function(){var a=this;this.baseUrl="index.php?app=hr&func=attendance&action=statistice";this.uid=0;this.ID_truename=Ext.id();this.fields=[{name:"id"},{name:"dept"},{name:"name"},{name:"fullatt"},{name:"absent"},{name:"belate"},{name:"leaved"},{name:"oncktimes"},{name:"offcktimes"},{name:"c_egression"},{name:"c_evection"},{name:"c_leave"},{name:"c_overtime"}];this.findFields={uid:0,stime:"",etime:""};this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getWorktime",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields}),listeners:{exception:function(h,g,i,f,d,c){var e=d.responseText;if(e!=""){var b=Ext.decode(e);if(b.failure){CNOA.msg.alert(b.msg)}}}}});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),{header:"id",dataIndex:"id",hidden:true},{header:lang("department"),dataIndex:"dept",width:130,sortable:false,menuDisabled:true},{header:lang("truename"),dataIndex:"name",width:100,sortable:false,menuDisabled:true,renderer:a.renTrueName.createDelegate(this)},{header:lang("fullDays"),dataIndex:"fullatt",width:125,sortable:false,menuDisabled:true,renderer:a.renFullAtt.createDelegate(this)},{header:lang("kuanggong"),dataIndex:"absent",width:125,sortable:false,menuDisabled:true,renderer:a.renAbsent.createDelegate(this)},{header:lang("cdTimes"),dataIndex:"belate",width:80,sortable:false,menuDisabled:true,renderer:a.renOther.createDelegate(this)},{header:lang("ztTimes"),dataIndex:"leaved",width:120,sortable:false,menuDisabled:true,renderer:a.renOther.createDelegate(this)},{header:lang("sBWDJ"),dataIndex:"oncktimes",width:160,sortable:false,menuDisabled:true,renderer:a.renOther.createDelegate(this)},{header:lang("xBWDJ"),dataIndex:"offcktimes",width:125,sortable:false,menuDisabled:true,renderer:a.renOther.createDelegate(this)},{header:lang("outTime"),dataIndex:"c_egression",width:73,sortable:false,menuDisabled:true,renderer:a.renOther.createDelegate(this)},{header:lang("travelTimes"),dataIndex:"c_evection",width:85,sortable:false,menuDisabled:true,renderer:a.renOther.createDelegate(this)},{header:lang("leaveTimes"),dataIndex:"c_leave",width:90,sortable:false,menuDisabled:true,renderer:a.renOther.createDelegate(this)},{header:lang("otTimes"),dataIndex:"c_overtime",width:140,sortable:false,menuDisabled:true,renderer:a.renOther.createDelegate(this)},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({displayInfo:true,store:a.store,pageSize:15,listeners:{beforechange:function(b,c){if(a.findFields.truename!=""){c.truename=a.findFields.truename}}}});this.grid=new Ext.grid.GridPanel({stripeRows:true,border:false,store:a.store,loadMask:{msg:lang("waiting")},cm:a.colModel,sm:a.sm,hideBorders:true,tbar:new Ext.Toolbar({items:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){a.store.reload()}},{xtype:"button",text:lang("exportToExcel"),iconCls:"icon-excel",handler:function(){a.openExportExcelWindow()}},lang("registrant")+"：",{xtype:"textfield",width:150,id:a.ID_truename},{text:lang("search"),handler:function(){truename=Ext.getCmp(a.ID_truename).getValue();a.findFields.truename=truename;a.store.setBaseParam("truename",truename);a.store.load()}},{text:lang("clear"),handler:function(){Ext.getCmp(a.ID_truename).setValue("");a.findFields.truename="";a.store.load()}},"<span class='cnoa_color_gray'><<"+lang("clickToView")+"</span>","->",{xtype:"cnoa_helpBtn",helpid:3001}]}),bbar:a.pagingBar,listeners:{rowclick:function(b,g,f){var d=a.store.reader.jsonData;var c=d.data[g];c.stime=d.stime;c.etime=d.etime;a.winDetail(c)}}})},openDownloadExcelWindow:function(a){var b=new Ext.Window({width:320,height:150,title:lang("downExcel"),resizable:false,modal:true,layout:"fit",bodyStyle:"padding:10px;background-color: #FFF;",html:lang("clickToDownload")+"：<br/>"+a,buttons:[{text:lang("close"),iconCls:"icon-dialog-cancel",handler:function(){b.close()}.createDelegate(this)}]}).show()},openExportExcelWindow:function(){var g=this;var f=g.store.baseParams;var c=f.s_deptid;var e=f.s_etime;var d=f.s_stime;var b=f.s_wtid;var a=f.truename;Ext.Ajax.request({url:g.baseUrl+"&task=exportExcel",method:"POST",params:{wtid:b,stime:d,etime:e,deptid:c,truename:a},success:function(i){var h=i.responseText;jsData=Ext.decode(h);g.openDownloadExcelWindow(jsData.msg)},failure:function(h,i){CNOA.msg.alert(result.msg,function(){})}})},winDetail:function(Data){var _this=this;var baseUrl="index.php?app=hr&func=attendance&action=statistice";var uid=Data.uid;var stime=Data.stime;var etime=Data.etime;var sWinTitle=Data.name;var fields=[{name:"id"},{name:"date"},{name:"time1"},{name:"time2"},{name:"time3"},{name:"time4"},{name:"time5"},{name:"time6"}];var findFields={uid:0,stime:"",etime:""};var getHeaderTitle=function(){if(uid==""){return}Ext.Ajax.request({url:baseUrl+"&task=getChecktime&uid="+uid,method:"GET",success:function(r){var sText=r.responseText;jsData=Ext.decode(sText);arrData=jsData.data;start=3;for(var i=0;i<=6-1;i++){colModel.setColumnHeader(i+start,"")}for(var i=0;i<=arrData.length-1;i++){data=arrData[i];stype=data.type==0?lang("goWork"):lang("offWork");header=data.time+'(<b style="color:#1122EE;">'+stype+"</b>)";colModel.setColumnHeader(i+start,header)}}})};function renWorktime(value,metaData,record,rowIndex,colIndex,store){var _this=this;var s="";var restDay=record.json.restDay;eval("ctime = record.json.ctime"+(colIndex-2));eval("ctype = record.json.ctype"+(colIndex-2));eval("explain = record.json.explain"+(colIndex-2));if(value!=""){s=value;if(colIndex>=3){date=record.json.date;atime=Date.parse(date+" "+value);btime=Date.parse(date+" "+ctime);stype="";if(restDay==""){if(ctype==0){if(atime>btime){stype=lang("late")}}else{if(atime<btime){stype=lang("leaveEarly")}}}s+='<b style="color:red;">'+stype+"</b>"}}else{var sHeader=colModel.getColumnHeader(colIndex);if(sHeader!=""){if(restDay!=""){switch(parseInt(restDay)){case 1:s='<span style="color:#22AA33;">'+lang("gongxiu")+"</span>";break;case 2:s='<span style="color:#22AA33;">'+lang("holidays")+"</span>";break}}else{s='<span style="color:#EE2233;">'+lang("unRegister")+"</span>"}}}if(explain!=""&&explain!=undefined){explain=explain.replace(/\n/g,"<BR>");var img='<img src="/resources/images/icons/message.gif" ext:qtip="'+explain+'" />';var ss="<span>"+img+"</span>";s+=ss}return s}var store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:baseUrl+"&task=getRecWorktime",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:fields}),listeners:{load:function(th,record,opt){},exception:function(th,type,action,options,response,arg){var sText=response.responseText;if(sText!=""){var result=Ext.decode(sText);if(result.failure){CNOA.msg.alert(result.msg)}}},beforeload:function(){getHeaderTitle()}}});store.setBaseParam("uid",uid);store.setBaseParam("stime",stime);store.setBaseParam("etime",etime);store.load();var sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});var colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),{header:"id",dataIndex:"id",hidden:true},{header:lang("date"),dataIndex:"date",width:130,sortable:false,menuDisabled:true},{header:"",dataIndex:"time1",width:100,sortable:false,menuDisabled:true,renderer:renWorktime},{header:"",dataIndex:"time2",width:100,sortable:false,menuDisabled:true,renderer:renWorktime},{header:"",dataIndex:"time3",width:100,sortable:false,menuDisabled:true,renderer:renWorktime.createDelegate(this)},{header:"",dataIndex:"time4",width:100,sortable:false,menuDisabled:true,renderer:renWorktime.createDelegate(this)},{header:"",dataIndex:"time5",width:100,sortable:false,menuDisabled:true,renderer:renWorktime.createDelegate(this)},{header:"",dataIndex:"time6",width:100,sortable:false,menuDisabled:true,renderer:renWorktime.createDelegate(this)},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);var pagingBar=new Ext.PagingToolbar({displayInfo:true,store:store,pageSize:15});var grid=new Ext.grid.GridPanel({stripeRows:true,border:false,layout:"fit",store:store,loadMask:{msg:lang("waiting")},cm:colModel,sm:sm,hideBorders:true,tbar:new Ext.Toolbar({items:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(button,event){store.reload()}}]}),bbar:pagingBar});var win=new Ext.Window({modal:true,width:800,height:makeWindowHeight(600),layout:"fit",items:[grid],title:lang("view")+"“"+sWinTitle+"”"+lang("sXBDJdetails"),buttons:[{xtype:"button",text:lang("closeWindow"),handler:function(){win.close()}}]}).show()},renTrueName:function(f,b,a,h,d,c){var g=this;var e='<span style="color:#2255EE">'+f+"</span>";return e},renFullAtt:function(f,b,a,h,d,c){var g=this;var e='<b style="color:#229933">'+f+"</b>";return e},renAbsent:function(f,b,a,h,d,c){var g=this;var e='<b style="color:#DD2233">'+f+"</b>";return e},renOther:function(f,b,a,h,d,c){var g=this;var e='<span style="color:#EE1122">'+f+"</span>";return e},renWorktime:function(value,metaData,record,rowIndex,colIndex,store){var _this=this;var s="";var restDay=record.json.restDay;eval("ctime = record.json.ctime"+(colIndex-2));eval("ctype = record.json.ctype"+(colIndex-2));eval("explain = record.json.explain"+(colIndex-2));if(value!=""){s=value;if(colIndex>=3){date=record.json.date;atime=Date.parse(date+" "+value);btime=Date.parse(date+" "+ctime);stype="";if(restDay==""){if(ctype==0){if(atime>btime){stype=lang("late")}}else{if(atime<btime){stype=lang("leaveEarly")}}}s+='<b style="color:red;">'+stype+"</b>"}}else{var sHeader=_this.colModel.getColumnHeader(colIndex);if(sHeader!=""){if(restDay!=""){switch(parseInt(restDay)){case 1:s='<span style="color:#22AA33;">'+lang("gongxiu")+"</span>";break;case 2:s='<span style="color:#22AA33;">'+lang("holidays")+"</span>";break}}else{s='<span style="color:#EE2233;">'+lang("unRegister")+"</span>"}}}if(explain!=""&&explain!=undefined){var img='<img src="/resources/images/icons/message.gif" ext:qtip="'+explain+'" />';var ss="<span>"+img+"</span>";s+=ss}return s}};CNOA_hr_attendance_statistice_egressionClass=CNOA.Class.create();CNOA_hr_attendance_statistice_egressionClass.prototype={init:function(){var a=this;this.baseUrl="index.php?app=hr&func=attendance&action=statistice";this.type="add";this.edit_id=0;this.uid=0;this.ID_stime=Ext.id();this.ID_etime=Ext.id();this.ID_status=Ext.id();this.ID_truename=Ext.id();this.fields=[{name:"id"},{name:"posttime"},{name:"verifier"},{name:"status"},{name:"stime"},{name:"etime"},{name:"reason"},{name:"truename"}];this.findFields={stime:"",etime:"",status:-1};this.clearSearch=function(){var c=Ext.getCmp(a.ID_stime);var d=Ext.getCmp(a.ID_etime);var b=Ext.getCmp(a.ID_status);c.setValue(new Date());d.setValue(new Date());b.setValue("-1")};this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getEgression",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields}),listeners:{load:function(e,c,d){var b=e.reader.jsonData},exception:function(h,g,i,f,d,c){var e=d.responseText;if(e!=""){var b=Ext.decode(e);if(b.failure){CNOA.msg.alert(b.msg)}}}}});this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),{header:"id",dataIndex:"id",hidden:true},{header:lang("proposer"),dataIndex:"truename",width:100,sortable:false,menuDisabled:true},{header:lang("appTime"),dataIndex:"posttime",width:111,sortable:false,menuDisabled:true,renderer:a.renPosttime.createDelegate(this)},{header:lang("approvalor"),dataIndex:"verifier",width:111,sortable:false,menuDisabled:true,renderer:a.renWorktime.createDelegate(this)},{header:lang("status"),dataIndex:"status",width:80,sortable:false,menuDisabled:true,renderer:a.renStatus.createDelegate(this)},{header:lang("WCYY"),dataIndex:"reason",width:360,sortable:false,menuDisabled:true,renderer:a.renDetail.createDelegate(this)},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({displayInfo:true,store:a.store,pageSize:15,listeners:{beforechange:function(b,c){if(a.findFields.truename!=""){c.truename=a.findFields.truename}}}});this.grid=new Ext.grid.GridPanel({stripeRows:true,border:false,store:a.store,loadMask:{msg:lang("waiting")},cm:a.colModel,hideBorders:true,listeners:{cellclick:function(b,j,i,h){var d=a.store.reader.jsonData.data[j];var c=d.stime;var f=d.etime;var g=d.reason;var k=lang("startTime")+'：<span style="color:#228833; font-weight:bold">'+c+"</span> - "+lang("endTime")+'：<span style="color:#228833; font-weight:bold">'+f+'</span><BR><div style="color:#333; padding:20px; ">'+g+"</div>";if(i==6){a.showDetail(k)}}},tbar:new Ext.Toolbar({items:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){a.store.reload()}},lang("proposer")+"：",{xtype:"textfield",width:140,id:a.ID_truename},{text:lang("search"),handler:function(){truename=Ext.getCmp(a.ID_truename).getValue();a.findFields.truename=truename;a.store.load({params:{truename:truename}})}},{text:lang("clear"),handler:function(){Ext.getCmp(a.ID_truename).setValue("");a.findFields.truename="";a.store.load()}},"->",{xtype:"cnoa_helpBtn",helpid:3020}]}),bbar:a.pagingBar})},showDetail:function(a){a=a.replace(/\n/g,"<BR> ");winInfos=new Ext.Window({title:lang("viewDetail1"),width:650,height:400,autoScroll:true,modal:true,bodyStyle:"padding: 20px; background-color:#fff",html:a,buttons:[{text:lang("close"),handler:function(){winInfos.close()}}]}).show()},renDetail:function(h,a,f,g,j,i){var k="";var c=f.data;var b=c.stime;var e=c.etime;var d=c.reason;k=lang("startTime")+'：<span style="color:#558899; font-weight:bold">'+b+"</span> - "+lang("endTime")+'：<span style="color:#558899; font-weight:bold">'+e+'</span><BR><span ext:qtip="'+lang("clickToView")+'" style="color:#888">'+d+"</span>";return k},renPosttime:function(f,b,a,g,d,c){var e="";e='<b style="color:#559966;">'+f+"</b>";return e},renWorktime:function(f,b,a,h,d,c){var g=this;var e=f;return e},renStatus:function(g,b,a,h,d,c){var f=a.data;var e="";switch(parseInt(f.status)){case 0:e='<label style="color:#668833;">'+lang("Pending")+"</label>";break;case 1:e='<label style="color:#228822">'+lang("approved1")+"</label>";break;case 2:e='<label style="color:#EE2222">'+lang("notApprove")+"</label>";break;case 3:e='<label style="color:#567812">'+lang("returnAudit")+"</label>";break;case 4:e='<label style="color:#2222AA">'+lang("hasReturn")+"</label>";break;case 5:e='<label style="color:#2288AA">'+lang("zxsq")+"</label>";break;case 6:e='<label style="color:#8822AA">'+lang("hasCanceled")+"</label>";break;case 7:e='<label style="color:#6666AA">'+lang("zXSQBTG")+"</label>";break;case 8:e='<label style="color:#2299AA">'+lang("returnNoPass")+"</label>";break}return e}};CNOA_hr_attendance_statistice_leaveClass=CNOA.Class.create();CNOA_hr_attendance_statistice_leaveClass.prototype={init:function(){var a=this;this.baseUrl="index.php?app=hr&func=attendance&action=statistice";this.type="add";this.edit_id=0;this.uid=0;this.ID_stime=Ext.id();this.ID_etime=Ext.id();this.ID_status=Ext.id();this.ID_truename=Ext.id();this.findFields={truename:""};this.fields=[{name:"id"},{name:"posttime"},{name:"verifier"},{name:"status"},{name:"stime"},{name:"etime"},{name:"reason"},{name:"leaveDay"},{name:"truename"}];this.findFields={stime:"",etime:"",status:-1};this.clearSearch=function(){var c=Ext.getCmp(a.ID_stime);var d=Ext.getCmp(a.ID_etime);var b=Ext.getCmp(a.ID_status);c.setValue(new Date());d.setValue(new Date());b.setValue("-1")};this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getLeave",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields}),listeners:{load:function(e,c,d){var b=e.reader.jsonData},exception:function(h,g,i,f,d,c){var e=d.responseText;if(e!=""){var b=Ext.decode(e);if(b.failure){CNOA.msg.alert(b.msg)}}}}});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),{header:"id",dataIndex:"id",hidden:true},{header:lang("proposer"),dataIndex:"truename",width:100,sortable:false,menuDisabled:true},{header:lang("appTime"),dataIndex:"posttime",width:111,sortable:false,menuDisabled:true,renderer:a.renPosttime.createDelegate(this)},{header:lang("approvalor"),dataIndex:"verifier",width:111,sortable:false,menuDisabled:true,renderer:a.renWorktime.createDelegate(this)},{header:lang("status"),dataIndex:"status",width:80,sortable:false,menuDisabled:true,renderer:a.renStatus.createDelegate(this)},{header:lang("useAnnual"),dataIndex:"leaveDay",width:80,sortable:false,menuDisabled:true,renderer:a.renLeaveday.createDelegate(this)},{header:lang("qjReason"),dataIndex:"reason",width:350,sortable:false,menuDisabled:true,renderer:a.renDetail.createDelegate(this)},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({displayInfo:true,store:a.store,pageSize:15,listeners:{beforechange:function(b,c){if(a.findFields.truename!=""){c.truename=a.findFields.truename}}}});this.grid=new Ext.grid.GridPanel({stripeRows:true,border:false,store:a.store,loadMask:{msg:lang("waiting")},cm:a.colModel,sm:a.sm,hideBorders:true,listeners:{cellclick:function(b,m,l,k){var g=a.store.reader.jsonData.data[m];var c=g.stime;var h=g.etime;var i=g.reason;var d=g.status;var j=g.otime;var f="";if(d==4){f=" - "+lang("XJSJ")+'：<b style="color:#228833">'+j+"</b>"}var n=lang("startTime")+'：<b style="color:#228833;">'+c+"</b> - "+lang("endTime")+'：<b style="color:#228833;">'+h+"</b> "+f+' <BR><div style="color:#333; padding:20px; ">'+i+"</div>";if(l==7){a.showDetail(n)}}},tbar:new Ext.Toolbar({items:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){a.store.reload()}},lang("proposer")+"：",{xtype:"textfield",width:140,id:a.ID_truename},{text:lang("search"),handler:function(){truename=Ext.getCmp(a.ID_truename).getValue();a.findFields.truename=truename;a.store.load({params:{truename:truename}})}},{text:lang("clear"),handler:function(){Ext.getCmp(a.ID_truename).setValue("");a.findFields.truename="";a.store.load()}},"->",{xtype:"cnoa_helpBtn",helpid:3021}]}),bbar:a.pagingBar})},renLeaveday:function(f,b,a,g,d,c){var e="";e='<b style="color:#EE5566;">'+f+"</b>";return e},showDetail:function(a){a=a.replace(/\n/g,"<BR> ");winInfos=new Ext.Window({title:lang("viewDetail1"),width:650,height:400,autoScroll:true,modal:true,bodyStyle:"padding: 20px; background-color:#fff",html:a,buttons:[{text:lang("close"),handler:function(){winInfos.close()}}]}).show()},renDetail:function(h,a,f,g,j,i){var k="";var c=f.data;var b=c.stime;var e=c.etime;var d=c.reason;k=lang("startTime")+'：<span style="color:#558899; font-weight:bold">'+b+"</span> - "+lang("endTime")+'：<span style="color:#558899; font-weight:bold">'+e+'</span><BR><span ext:qtip="'+lang("clickToView")+'" style="color:#888">'+d+"</span>";return k},renPosttime:function(f,b,a,g,d,c){var e="";e='<b style="color:#559966;">'+f+"</b>";return e},renWorktime:function(f,b,a,h,d,c){var g=this;var e=f;return e},renStatus:function(g,b,a,h,d,c){var f=a.data,e="";switch(parseInt(f.status)){case 0:e='<label style="color:#668833;">'+lang("Pending")+"</label>";break;case 1:e='<label style="color:#228822">'+lang("approved1")+"</label>";break;case 2:e='<label style="color:#EE2222">'+lang("notApprove")+"</label>";break;case 3:e='<label style="color:#334488">'+lang("appSickLeave")+"</label>";break;case 4:e='<label style="color:#2222bb">'+lang("yXiaoJia")+"</label>";break;case 5:e='<label style="color:#2288AA">'+lang("zxsq")+"</label>";break;case 6:e='<label style="color:#8822AA">'+lang("hasCanceled")+"</label>";break;case 7:e='<label style="color:#6666AA">'+lang("zXSQBTG")+"</label>";break;case 8:e='<label style="color:#2299AA">'+lang("xJSHBTG")+"</label>";break}return e}};CNOA_hr_attendance_statistice_evectionClass=CNOA.Class.create();CNOA_hr_attendance_statistice_evectionClass.prototype={init:function(){var a=this;this.baseUrl="index.php?app=hr&func=attendance&action=statistice";this.type="add";this.edit_id=0;this.uid=0;this.ID_stime=Ext.id();this.ID_etime=Ext.id();this.ID_status=Ext.id();this.ID_truename=Ext.id();this.findFields={truename:""};this.fields=[{name:"id"},{name:"posttime"},{name:"verifier"},{name:"status"},{name:"stime"},{name:"etime"},{name:"reason"},{name:"address"},{name:"truename"}];this.findFields={stime:"",etime:"",status:-1};this.clearSearch=function(){var c=Ext.getCmp(a.ID_stime);var d=Ext.getCmp(a.ID_etime);var b=Ext.getCmp(a.ID_status);c.setValue(new Date());d.setValue(new Date());b.setValue("-1")};this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getEvection",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields}),listeners:{load:function(e,c,d){var b=e.reader.jsonData},exception:function(h,g,i,f,d,c){var e=d.responseText;if(e!=""){var b=Ext.decode(e);if(b.failure){CNOA.msg.alert(b.msg)}}}}});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),{header:"id",dataIndex:"id",hidden:true},{header:lang("proposer"),dataIndex:"truename",width:100,sortable:false,menuDisabled:true},{header:lang("appTime"),dataIndex:"posttime",width:111,sortable:false,menuDisabled:true,renderer:a.renPosttime.createDelegate(this)},{header:lang("approvalor"),dataIndex:"verifier",width:111,sortable:false,menuDisabled:true,renderer:a.renWorktime.createDelegate(this)},{header:lang("status"),dataIndex:"status",width:80,sortable:false,menuDisabled:true,renderer:a.renStatus.createDelegate(this)},{header:lang("travelSites"),dataIndex:"address",width:131,sortable:false,menuDisabled:true,renderer:a.renAddress.createDelegate(this)},{header:lang("travelReason"),dataIndex:"reason",width:340,sortable:false,menuDisabled:true,renderer:a.renDetail.createDelegate(this)},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({displayInfo:true,store:a.store,pageSize:15,listeners:{beforechange:function(b,c){if(a.findFields.truename!=""){c.truename=a.findFields.truename}}}});this.grid=new Ext.grid.GridPanel({stripeRows:true,border:false,store:a.store,loadMask:{msg:lang("waiting")},cm:a.colModel,sm:a.sm,hideBorders:true,listeners:{cellclick:function(b,j,i,h){var d=a.store.reader.jsonData.data[j];var c=d.stime;var f=d.etime;var g=d.reason;var k=lang("startTime")+'：<span style="color:#228833; font-weight:bold">'+c+"</span> - "+lang("endTime")+'：<span style="color:#228833; font-weight:bold">'+f+"</span> - "+lang("travelSites")+'：<span style="color:#228833; font-weight:bold">'+d.address+'</span><BR><div style="color:#333; padding:20px; ">'+g+"</div>";if(i==7){a.showDetail(k)}}},tbar:new Ext.Toolbar({items:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){a.store.reload()}},lang("proposer")+"：",{xtype:"textfield",width:140,id:a.ID_truename},{text:lang("search"),handler:function(){truename=Ext.getCmp(a.ID_truename).getValue();a.findFields.truename=truename;a.store.load({params:{truename:truename}})}},{text:lang("clear"),handler:function(){Ext.getCmp(a.ID_truename).setValue("");a.findFields.truename="";a.store.load()}},"->",{xtype:"cnoa_helpBtn",helpid:3022}]}),bbar:a.pagingBar})},renAddress:function(f,b,a,g,d,c){var e="";e='<span style="color:#111155;">'+f+"</span>";return e},showDetail:function(a){a=a.replace(/\n/g,"<BR> ");winInfos=new Ext.Window({title:lang("viewDetail1"),width:650,height:400,autoScroll:true,modal:true,bodyStyle:"padding: 20px; background-color:#fff",html:a,buttons:[{text:lang("close"),handler:function(){winInfos.close()}}]}).show()},renDetail:function(h,a,f,g,j,i){var k="";var c=f.data;var b=c.stime;var e=c.etime;var d=c.reason;k=lang("startTime")+'：<span style="color:#558899; font-weight:bold">'+b+"</span> - "+lang("endTime")+'：<span style="color:#558899; font-weight:bold">'+e+'</span><BR><span ext:qtip="'+lang("clickToView")+'" style="color:#888">'+d+"</span>";return k},renPosttime:function(f,b,a,g,d,c){var e="";e='<b style="color:#559966;">'+f+"</b>";return e},renWorktime:function(f,b,a,h,d,c){var g=this;var e=f;return e},renStatus:function(g,b,a,h,d,c){var f=a.data;var e="";switch(parseInt(f.status)){case 0:e='<label style="color:#668833;">'+lang("Pending")+"</label>";break;case 1:e='<label style="color:#228822">'+lang("approved1")+"</label>";break;case 2:e='<label style="color:#EE2222">'+lang("notApprove")+"</label>";break;case 3:e='<label style="color:#567812">'+lang("returnAudit")+"</label>";break;case 4:e='<label style="color:#2222AA">'+lang("hasReturn")+"</label>";break;case 5:e='<label style="color:#2288AA">'+lang("zxsq")+"</label>";break;case 6:e='<label style="color:#8822AA">'+lang("hasCanceled")+"</label>";break;case 7:e='<label style="color:#6666AA">'+lang("zXSQBTG")+"</label>";break;case 8:e='<label style="color:#2299AA">'+lang("returnNoPass")+"</label>";break}return e}};CNOA_hr_attendance_statistice_overtimeClass=CNOA.Class.create();CNOA_hr_attendance_statistice_overtimeClass.prototype={init:function(){var a=this;this.baseUrl="index.php?app=hr&func=attendance&action=statistice";this.edit_id=0;this.uid=0;this.ID_stime=Ext.id();this.ID_etime=Ext.id();this.ID_status=Ext.id();this.ID_truename=Ext.id();this.findFields={truename:""};this.fields=[{name:"id"},{name:"posttime"},{name:"verifier"},{name:"status"},{name:"stime"},{name:"etime"},{name:"reason"},{name:"truename"},{name:"hour"},{name:"minute"}];this.findFields={stime:"",etime:"",status:-1};this.clearSearch=function(){var c=Ext.getCmp(a.ID_stime);var d=Ext.getCmp(a.ID_etime);var b=Ext.getCmp(a.ID_status);c.setValue(new Date());d.setValue(new Date());b.setValue("-1")};this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getOvertime",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields}),listeners:{load:function(e,c,d){var b=e.reader.jsonData},exception:function(h,g,i,f,d,c){var e=d.responseText;if(e!=""){var b=Ext.decode(e);if(b.failure){CNOA.msg.alert(b.msg)}}}}});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),{header:"id",dataIndex:"id",hidden:true},{header:lang("proposer"),dataIndex:"truename",width:100,sortable:false,menuDisabled:true},{header:lang("appTime"),dataIndex:"posttime",width:111,sortable:false,menuDisabled:true,renderer:a.renPosttime.createDelegate(this)},{header:lang("approvalor"),dataIndex:"verifier",width:111,sortable:false,menuDisabled:true,renderer:a.renWorktime.createDelegate(this)},{header:lang("status"),dataIndex:"status",width:80,sortable:false,menuDisabled:true,renderer:a.renStatus.createDelegate(this)},{header:lang("jiabanTime"),dataIndex:"hour",width:131,sortable:false,menuDisabled:true,renderer:a.renTimes.createDelegate(this)},{header:lang("otReason"),dataIndex:"reason",width:340,sortable:false,menuDisabled:true,renderer:a.renDetail.createDelegate(this)},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.pagingBar=new Ext.PagingToolbar({displayInfo:true,store:a.store,pageSize:15,listeners:{beforechange:function(b,c){if(a.findFields.truename!=""){c.truename=a.findFields.truename}}}});this.grid=new Ext.grid.GridPanel({stripeRows:true,border:false,store:a.store,loadMask:{msg:lang("waiting")},cm:a.colModel,sm:a.sm,hideBorders:true,listeners:{cellclick:function(b,j,i,h){var d=a.store.reader.jsonData.data[j];var c=d.stime;var f=d.etime;var g=d.reason;var k=lang("startTime")+'：<span style="color:#228833; font-weight:bold">'+c+"</span> - "+lang("endTime")+'：<span style="color:#228833; font-weight:bold">'+f+'</span><BR><div style="color:#333; padding:20px; ">'+g+"</div>";if(i==7){a.showDetail(k)}}},tbar:new Ext.Toolbar({items:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(b,c){a.store.reload()}},lang("proposer")+"：",{xtype:"textfield",width:140,id:a.ID_truename},{text:lang("search"),handler:function(){truename=Ext.getCmp(a.ID_truename).getValue();a.findFields.truename=truename;a.store.load({params:{truename:truename}})}},{text:lang("clear"),handler:function(){Ext.getCmp(a.ID_truename).setValue("");a.findFields.truename="";a.store.load()}},"->",{xtype:"cnoa_helpBtn",helpid:3023}]}),bbar:a.pagingBar})},renTimes:function(g,a,e,f,i,h){var j="";var d=e.data;var c=d.hour;var b=d.minute;j='<span style="color:#5566AA;">'+c+lang("hour")+b+lang("minute")+"</span>";return j},showDetail:function(a){a=a.replace(/\n/g,"<BR> ");winInfos=new Ext.Window({title:lang("viewDetail1"),width:650,height:400,autoScroll:true,modal:true,bodyStyle:"padding: 20px; background-color:#fff",html:a,buttons:[{text:lang("close"),handler:function(){winInfos.close()}}]}).show()},renDetail:function(h,a,f,g,j,i){var k="";var c=f.data;var b=c.stime;var e=c.etime;var d=c.reason;k=lang("startTime")+'：<span style="color:#558899; font-weight:bold">'+b+"</span> - "+lang("endTime")+'：<span style="color:#558899; font-weight:bold">'+e+'</span><BR><span ext:qtip="'+lang("clickToView")+'" style="color:#888">'+d+"</span>";return k},renPosttime:function(f,b,a,g,d,c){var e="";e='<b style="color:#559966;">'+f+"</b>";return e},renWorktime:function(f,b,a,h,d,c){var g=this;var e=f;return e},renStatus:function(g,b,a,h,d,c){var f=a.data;var e="";switch(parseInt(f.status)){case 0:e='<label style="color:#668833;">'+lang("Pending")+"</label>";break;case 1:e='<label style="color:#228822">'+lang("approved1")+"</label>";break;case 2:e='<label style="color:#EE2222">'+lang("notApprove")+"</label>";break;case 3:e='<label style="color:#2222AA">'+lang("endOtApp")+"</label>";break;case 4:e='<label style="color:#2222AA">'+lang("endOtApp")+"</label>";break;case 5:e='<label style="color:#6622AA">'+lang("zxsq")+"</label>";break;case 6:e='<label style="color:#AA22AA">'+lang("hasCanceled")+"</label>";break;case 7:e='<label style="color:#6666AA">'+lang("zXSQBTG")+"</label>";break;case 8:e='<label style="color:#2299AA">'+lang("jBJSSHBTG")+"</label>";break}return e}};CNOA_hr_attendance_statisticeClass=CNOA.Class.create();CNOA_hr_attendance_statisticeClass.prototype={init:function(){var g=this;this.ID_deptList=Ext.id();this.ID_worktime=Ext.id();this.ID_searchSTime=Ext.id();this.ID_searchETime=Ext.id();this.selectOAUID=Ext.id();this.baseUrl="index.php?app=hr&func=attendance&action=statistice";var d=new CNOA_hr_attendance_statistice_wtClass();var f=new CNOA_hr_attendance_statistice_egressionClass();var b=new CNOA_hr_attendance_statistice_leaveClass();var a=new CNOA_hr_attendance_statistice_evectionClass();var c=new CNOA_hr_attendance_statistice_overtimeClass();this.tabPanel=new Ext.TabPanel({region:"center",border:false,items:[{title:lang("sXBDJ"),layout:"fit",items:[d.grid]},{title:lang("wCDJ"),layout:"fit",items:[f.grid]},{title:lang("qJDJ"),layout:"fit",items:[b.grid]},{title:lang("cCDJ"),layout:"fit",items:[a.grid]},{title:lang("jBDJ"),layout:"fit",items:[c.grid]}],activeItem:0});this.worktList=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=worktimeList",disableCaching:true}),reader:new Ext.data.JsonReader({root:"data",fields:[{name:"id"},{name:"name"}]}),listeners:{load:function(m,j){var k=Ext.getCmp(g.ID_worktime);k.setValue(j[0].data.id);var i=parseInt(new Date().getMonth()+1).toString();if(i.length==1){i="0"+i}var h=(parseInt(new Date().getFullYear())+"-"+i+"-01");var l=Ext.getCmp(g.ID_searchSTime);l.setValue(h)}}});this.worktList.load();this.pnlSearch=new Ext.form.FormPanel({border:false,labelAlign:"right",labelWidth:70,bodyStyle:"padding:20px",defaults:{style:{marginBottom:"10px"}},items:[{xtype:"departmentselectorfield",id:this.selectOAUID,fieldLabel:lang("inDepartment"),width:230,allowBlank:false,hiddenName:"deptId",mulitSelect:false},{xtype:"combo",width:180,name:"worktimeid",valueField:"id",displayField:"name",triggerAction:"all",mode:"local",editable:false,store:g.worktList,fieldLabel:lang("typeOfSchedu"),id:g.ID_worktime},{xtype:"datefield",fieldLabel:lang("startDate"),width:180,format:"Y-m-d",id:g.ID_searchSTime},{xtype:"datefield",fieldLabel:lang("endDate"),width:180,format:"Y-m-d",id:g.ID_searchETime,value:new Date()}]});function e(i){var k=Ext.getCmp(g.selectOAUID);var h=Ext.getCmp(g.ID_worktime);var j=Ext.getCmp(g.ID_searchSTime);var l=Ext.getCmp(g.ID_searchETime);i.setBaseParam("s_deptid",k.getValue());i.setBaseParam("s_wtid",h.getValue());i.setBaseParam("s_stime",j.getRawValue());i.setBaseParam("s_etime",l.getRawValue());i.load()}this.searchSubmit=function(){e(d.store);e(b.store);e(a.store);e(f.store);e(c.store);g.winSearch.close()};this.winSearch=new Ext.Window({modal:true,width:400,height:270,closable:false,resizable:false,draggable:false,layout:"fit",title:lang("attStatisticsQuery"),items:[this.pnlSearch],buttons:[{xtype:"button",text:lang("kQStatistics"),handler:function(){g.searchSubmit()}},{xtype:"button",text:lang("close"),handler:function(){g.winSearch.close();Ext.destroy(CNOA_hr_attendance_statistice);CNOA_hr_attendance_statistice=null;mainPanel.closeTab(CNOA.hr.attendance.statistice.parentID.replace("docs-",""))}}]});this.mainPanel=new Ext.Panel({border:false,layout:"border",items:[this.winSearch.show(),this.tabPanel]})}};var sm_hr_attendance=1;