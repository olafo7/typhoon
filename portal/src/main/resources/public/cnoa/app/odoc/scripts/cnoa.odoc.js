var CNOA_odoc_receive_apply,CNOA_odoc_receive_applyClass;CNOA_odoc_receive_applyClass=CNOA.Class.create();CNOA_odoc_receive_applyClass.prototype={init:function(){var a=this;this.baseUrl="index.php?app=odoc&func=receive&action=apply";Ext.Ajax.request({url:a.baseUrl+"&task=loadColumn",method:"POST",success:function(c){var b=Ext.decode(c.responseText);if(b.success===true){a.layoutPanel(b)}else{CNOA.msg.alert(b.msg,function(){})}}})},layoutPanel:function(b){var c=this;this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:true});this.cm=[new Ext.grid.RowNumberer(),this.sm,{header:lang("opt"),sortable:true,dataIndex:"id",width:160,menuDisabled:true,renderer:function(f,h,e){var g=e.data;var d="";if(g.status==2){d+='<a href="javascript:void(0)" class="gridview" onclick="CNOA_odoc_receive_apply.viewFlow('+g.uFlowId+')">'+lang("viewProcess")+"</a>"}else{if(g.status==0){d+='<a href="javascript:void(0)" class="gridview" onclick="CNOA_odoc_receive_apply.operate('+f+')">'+lang("launchApproval")+"</a>"}else{if(g.status==1){d+='<a href="javascript:void(0)" class="gridview" onclick="CNOA_odoc_receive_apply.viewFlow('+g.uFlowId+')">'+lang("viewProcess")+"</a>"}}}d+='<a class="gridview3 jianju" href="javascript:void(0)" onclick="CNOA_odoc_receive_apply.viewAttach('+f+')">'+lang("jerContent")+"</a>";return d}},{header:lang("addTime"),sortable:true,dataIndex:"posttime",width:100,menuDisabled:true},{header:lang("status"),sortable:true,dataIndex:"status",width:100,menuDisabled:true,renderer:function(d){if(d==1){return'<span style="color:green;">'+lang("beingModerate")+"</span>"}else{if(d==2){return'<span style="color:#333333;">'+lang("endApp")+"</span>"}else{return'<span style="color:red;">'+lang("notSubmitApp")+"</span>"}}}},{header:lang("agency"),sortable:true,dataIndex:"deptment",width:100,menuDisabled:true},{header:lang("title1"),sortable:true,dataIndex:"title",width:100,menuDisabled:true},{header:lang("number1"),sortable:true,dataIndex:"number",width:100,menuDisabled:true},{header:lang("numOfPrint"),sortable:true,dataIndex:"print",width:100,menuDisabled:true}];var a=[{name:"id"},{name:"posttime"},{name:"status"},{name:"uFlowId"},{name:"deptment"},{name:"title"},{name:"number"},{name:"print"},{name:"puFlowId"}];Ext.each(b.column,function(d,e){a.push({name:"field_"+d.field});c.cm.push({header:d.title,sortable:true,dataIndex:"field_"+d.field,width:parseInt(d.width,10),menuDisabled:true})});this.store=new Ext.data.Store({autoLoad:true,proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getJsonList"}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:a})});this.grid=new Ext.grid.GridPanel({store:this.store,width:600,plain:false,stripeRows:true,loadMask:{msg:lang("waiting")},region:"center",border:false,autoScroll:true,sm:this.sm,columns:this.cm,tbar:[{handler:function(d,e){c.store.reload()}.createDelegate(this),iconCls:"icon-system-refresh",text:lang("refresh")},{handler:function(d,e){c.addWin("new",0)}.createDelegate(this),iconCls:"icon-utils-s-add",cls:"btn-blue4",text:lang("addingReceipt")},{handler:function(e,f){var g=c.grid.getSelectionModel().getSelections();if(g.length==0){CNOA.miniMsg.alertShowAt(e,lang("haveNotChosenEdit"))}else{var h=g[0].get("id");var d=g[0].get("status");if(d!=0){CNOA.msg.alert(lang("flowHasBenStartEnd"))}else{c.addWin("edit",h)}}},iconCls:"icon-utils-s-edit",text:lang("modify")},{text:lang("del"),iconCls:"icon-utils-s-delete",handler:function(d,e){var f=c.grid.getSelectionModel().getSelections();if(f.length==0){CNOA.miniMsg.alertShowAt(d,lang("mustSelectOneRow"))}else{CNOA.miniMsg.cfShowAt(d,lang("confirmToDelete"),function(){if(f){var h="";for(var g=0;g<f.length;g++){h+=f[g].get("id")+","}Ext.Ajax.request({url:c.baseUrl+"&task=deleteData",method:"POST",params:{ids:h},success:function(j){var i=Ext.decode(j.responseText);if(i.success===true){c.store.reload()}else{CNOA.msg.alert(i.msg,function(){})}}})}})}}},{text:lang("distribute"),handler:function(){var e=c.grid.getSelectionModel().getSelections();if(e.length<=0){CNOA.msg.alert(lang("pleaseSelectOne"));return}if(e[0].json.status!=2){CNOA.msg.alert(lang("hasNotBeenApp"));return}var d=e[0].json.id;c.issueSend(d)}.createDelegate(this),iconCls:"icon-applications-stack",cls:"btn-blue3"},"<span class='cnoa_color_gray'>"+lang("doubleClickEdit")+"</span>"],bbar:new Ext.PagingToolbar({displayInfo:true,store:this.store,pageSize:30})});this.treeStore=new Ext.data.Store({autoLoad:true,proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getSearchList",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:[{name:"field"},{name:"title"}]})});this.mainPanel=new Ext.Panel({collapsible:false,hideBorders:true,border:false,layout:"border",autoScroll:false,items:[this.grid]});Ext.getCmp(CNOA.odoc.receive.apply.parentID).add(this.mainPanel);Ext.getCmp(CNOA.odoc.receive.apply.parentID).doLayout()},addWin:function(g,a){var f=this;var c=[{xtype:"fieldset",title:lang("selectProcess"),layout:"column",id:"CNOA_ODOC_NEW_FLOW_CT",hideLabel:true,width:660,autoHeight:true,items:[]},{xtype:"fieldset",title:lang("information12"),hideLabel:true,width:660,layout:"column",autoHeight:true,defaults:{border:false},items:[{xtype:"panel",layout:"form",items:[{xtype:"textfield",fieldLabel:lang("docSendUnit"),name:"deptment",width:180},{xtype:"textfield",fieldLabel:lang("title1"),name:"title",width:180}]},{xtype:"panel",layout:"form",items:[{xtype:"numberfield",fieldLabel:lang("numOfPrint"),name:"print",width:180}]}]},{xtype:"panel",border:false,layout:"form",width:660,id:"ID_DEFINDE_FIELDS_RECEIVE"}];this.addFormPanel=new Ext.form.FormPanel({border:false,labelWidth:90,width:640,labelAlign:"right",waitMsgTarget:true,bodyStyle:"padding-left:5px;",items:c,autoScroll:true});var e=function(){var j=lang("selectProcess"),h;try{h=f.addFormPanel.getForm().findField("ococ_send_apply_flowList").getGroupValue()}catch(i){h="";j=lang("canNotInitProcess")}if(Ext.isEmpty(h)){CNOA.msg.alert(j);return false}return true};var b=function(){var h=f.addFormPanel.getForm();if(h.isValid()){h.submit({url:f.baseUrl+"&task=submitData",method:"POST",waitMsg:lang("waiting"),params:{id:a},success:function(i,j){if(j.result.success==true){d.close();f.store.reload();f.operate(j.result.msg)}}.createDelegate(this),failure:function(i,j){}.createDelegate(this)})}};var d=new Ext.Window({title:lang("addingReceipt"),width:700,height:makeWindowHeight(500),modal:true,layout:"fit",resizable:false,border:false,items:this.addFormPanel,buttons:[{text:lang("sureFQ"),handler:function(){if(e()){b(a)}}},{text:lang("close"),handler:function(h){d.close()}}]}).show();this.superField=Ext.getCmp("ID_DEFINDE_FIELDS_RECEIVE");f.loadLayout(g,a)},viewFlow:function(a){mainPanel.closeTab("CNOA_MENU_WF_USE_OPENFLOW");mainPanel.loadClass(this.baseUrl+"&task=loadPage&from=viewflow&uFlowId="+a,"CNOA_MENU_WF_USE_OPENFLOW",lang("viewFlow"),"icon-flow")},operate:function(a){var b=this;Ext.Ajax.request({url:b.baseUrl+"&task=getFaqiFlow",method:"POST",params:{id:a},success:function(d){var c=Ext.decode(d.responseText);if(c.success===true){b.goNewFlow(c)}else{if(c.msg=="no_bind_flow"){b.addWin("edit",a)}else{CNOA.msg.alert(c.msg)}}}})},viewAttach:function(e){var d=this;var c=Ext.id();var a=function(){Ext.Ajax.request({url:d.baseUrl+"&task=loadAttachList",method:"POST",params:{id:e},success:function(g){var f=Ext.decode(g.responseText);if(f.success===true){Ext.getCmp(c).body.update(f.data)}else{}}})};var b=new Ext.Window({title:lang("viewPostContent"),width:500,height:makeWindowHeight(500),modal:true,bodyStyle:"background-color:#FFF;padding:10px;",resizable:false,autoScroll:true,border:false,items:[{xtype:"fieldset",title:lang("fileView"),id:c}],listeners:{afterrender:function(){a()}},buttons:[{text:lang("close"),handler:function(f){b.close()}}]}).show()},goNewFlow:function(a){var d=a.flowType;var c=a.flowId;var f=a.nameRuleId;var g=a.tplSort;var e=0;var b=a.otherApp;if(d==0){mainPanel.closeTab("CNOA_MENU_WF_USE_OPENFLOW");mainPanel.loadClass("index.php?app=wf&func=flow&action=use&modul=new&task=loadPage&from=newflow&flowId="+c+"&nameRuleId="+f+"&flowType="+d+"&tplSort="+g+"&childId="+e+"&otherApp="+b,"CNOA_MENU_WF_USE_OPENFLOW",lang("FqNewFixedFlow"),"icon-flow-new")}else{mainPanel.closeTab("CNOA_USE_FLOW_NEWFREE_FLOWDESIGN");mainPanel.loadClass("index.php?app=wf&func=flow&action=use&modul=newfree&task=loadPage&from=flowdesign&flowId="+c+"&flowType="+d+"&tplSort="+g+"&childId="+e+"&otherApp="+b,"CNOA_USE_FLOW_NEWFREE_FLOWDESIGN","设计流程","icon-flow-new")}},loadLayout:function(c,a){var b=this;Ext.Ajax.request({url:b.baseUrl+"&task=loadLayout",method:"POST",success:function(f){var d=Ext.decode(f.responseText);if(d.success===true){Ext.each(d.fieldset,function(g,h){b.addFieldSet(g.name,g.fieldset)});Ext.each(d.field,function(g,h){Ext.getCmp("ID_FIELD_RECEIVE_"+g.fieldset).add(b.addField(g.fstfield,g.secfield,g.fstname,g.secname,g.type))});var e=Ext.getCmp("CNOA_ODOC_NEW_FLOW_CT");Ext.each(d.flowList,function(g,h){e.add({xtype:"radio",name:"ococ_send_apply_flowList",style:"margin-left: 10px;",boxLabel:g.name,inputValue:g.id,checked:h==0?true:false})});e.doLayout();b.superField.doLayout();if(c=="edit"){b.addFormPanel.getForm().load({url:b.baseUrl+"&task=loadFormData",method:"POST",params:{id:a},success:function(h,i){var g=i.result.data},failure:function(g,h){CNOA.msg.alert(h.result.msg,function(){})}})}}else{CNOA.msg.alert(d.msg,function(){})}}})},addFieldSet:function(b,a){var c=this;c.superField.add({xtype:"fieldset",title:b,width:660,autoHeight:true,id:"ID_FIELD_RECEIVE_"+a})},addField:function(a,b,e,g,c){var d=this;if(c=="textarea"){var f={xtype:"panel",layout:"form",items:[{xtype:"textarea",width:464,fieldLabel:e,name:"field_"+a}]}}else{if(c=="sort"){var f={xtype:"panel",layout:"form",items:[{xtype:"combo",fieldLabel:e,name:"field_"+a,store:this.sortStore,hiddenName:"field_"+a,valueField:"iid",displayField:"sort",mode:"local",width:180,triggerAction:"all",forceSelection:true,editable:false}]}}else{if(c=="type"){var f={xtype:"panel",layout:"form",items:[{xtype:"combo",fieldLabel:e,name:"field_"+a,store:this.typeStore,hiddenName:"field_"+a,valueField:"id",displayField:"sid",mode:"local",width:180,triggerAction:"all",forceSelection:true,editable:false}]}}else{if(c=="region"){var f=[{xtype:"panel",layout:"form",items:[{xtype:"combo",fieldLabel:e,name:"field_"+a,store:this.regionStore,name:"field_"+a,secondId:b,valueField:"rid",displayField:"name",mode:"local",width:180,triggerAction:"all",forceSelection:true,editable:false,listeners:{change:function(k,m,j){d.region2="";d.addFormPanel.getForm().findField("field_"+k.secondId).setValue("");d.regionStore2.load({params:{rid:m}})}}}]},{xtype:"panel",layout:"form",items:[{xtype:"combo",fieldLabel:g,name:"field_"+b,store:this.regionStore2,name:"field_"+b,valueField:"pid",displayField:"name",mode:"local",width:180,triggerAction:"all",forceSelection:true,editable:false}]}]}else{var f=[];if(e==""||g==""){var h=e==""?b:a;f=[{xtype:"panel",layout:"form",items:[{xtype:"textfield",width:464,fieldLabel:e==""?g:e,name:"field_"+h}]}]}else{f=[{xtype:"panel",layout:"form",items:[{xtype:"textfield",width:180,fieldLabel:e,name:"field_"+a}]},{xtype:"panel",layout:"form",items:[{xtype:"textfield",width:180,fieldLabel:g,name:"field_"+b}]}]}}}}}var i={xtype:"panel",layout:"table",layoutConfig:{columns:2},style:"margin-top:10px",border:false,labelWidth:90,defaults:{border:false},items:f};return i},issueSend:function(f){var e=this;var c=e.grid.getSelectionModel().getSelections();if(c.length<=0){CNOA.msg.alert(lang("pleaseSelectOne"));return}var a=c[0].json.id;var b=new Ext.form.FormPanel({border:false,labelWidth:60,labelAlign:"right",bodyStyle:"padding: 10px",items:[{xtype:"checkboxgroup",fieldLabel:lang("distributeContent"),columns:3,allowBlank:false,items:[{boxLabel:lang("appForm"),name:"viewForm"},{boxLabel:lang("appOfText"),name:"viewWord",checked:true},{boxLabel:lang("flowAttachment"),name:"viewAttach",checked:true}]},{xtype:"textarea",fieldLabel:lang("peopleToView"),name:"recvMan",width:333,height:150,readOnly:true,allowBlank:false},{xtype:"hidden",name:"recvUids",id:e.ID_recvUids},{xtype:"btnForPoepleSelector",fieldLabel:"",text:lang("select"),allowBlank:false,name:"checkName",dataUrl:e.baseUrl+"&task=getAllUserListsInPermitDeptTree",width:70,style:"margin: 0 0 0 65px",listeners:{selected:function(m,n){var o=new Array();var k=new Array();if(n.length>0){for(var j=0;j<=n.length-1;j++){o.push(n[j].uname);k.push(n[j].uid)}}var h=o.join(",");var g=k.join(",");b.getForm().findField("recvUids").setValue(g);b.getForm().findField("recvMan").setValue(h)}}}]});submit=function(){var g=b.getForm();if(g.isValid()){g.submit({url:e.baseUrl+"&task=submitIssue",method:"POST",params:{id:a},success:function(h,i){CNOA.msg.notice(i.result.msg,lang("docMgr"));e.store.reload();d.close()},failure:function(h,i){CNOA.msg.alert(i.result.msg)}})}else{CNOA.msg.alert(lang("formValid"))}};var d=new Ext.Window({title:lang("distribute"),width:430,height:330,layout:"fit",modal:true,resizable:false,maximizable:false,items:[b],buttons:[{text:lang("sureDistribute"),handler:function(){submit()}},{text:lang("close"),handler:function(){d.close()}}]}).show();return d}};var CNOA_odoc_send_apply,CNOA_odoc_send_applyClass;CNOA_odoc_send_applyClass=CNOA.Class.create();CNOA_odoc_send_applyClass.prototype={init:function(){var a=this;this.baseUrl="index.php?app=odoc&func=send&action=apply";Ext.Ajax.request({url:a.baseUrl+"&task=loadColumn",method:"POST",success:function(c){var b=Ext.decode(c.responseText);if(b.success===true){a.layoutPanel(b)}else{CNOA.msg.alert(b.msg,function(){})}}})},layoutPanel:function(b){var d=this;this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:true});this.cm=[new Ext.grid.RowNumberer(),this.sm,{header:lang("opt"),sortable:true,dataIndex:"id",width:140,menuDisabled:true,renderer:function(g,i,f){var h=f.data;var e="";if(h.status==2){e+='<a class="gridview" href="javascript:void(0)" onclick="CNOA_odoc_send_apply.viewFlow('+h.uFlowId+')">'+lang("viewProcess")+"</a>"}else{if(h.status==0){e+='<a class="gridview" href="javascript:void(0)" onclick="CNOA_odoc_send_apply.operate('+g+')">'+lang("launchApproval")+"</a>"}else{if(h.status==1){e+='<a class="gridview" href="javascript:void(0)" onclick="CNOA_odoc_send_apply.viewFlow('+h.uFlowId+')">'+lang("viewProcess")+"</a>"}}}return e}},{header:lang("addTime"),sortable:true,dataIndex:"posttime",width:100,menuDisabled:true},{header:lang("status"),sortable:true,dataIndex:"status",width:100,menuDisabled:true,renderer:function(e){if(e==1){return'<span style="color:green;">'+lang("beingModerate")+"</span>"}else{if(e==2){return'<span style="color:gray;">'+lang("endApp")+"</span>"}else{return'<span style="color:red;">'+lang("notSubmitApp")+"</span>"}}}}];var a=[{name:"id"},{name:"posttime"},{name:"status"},{name:"uFlowId"},{name:"activeAccount"}];Ext.each(b.column,function(e,f){a.push({name:"field_"+e.field});d.cm.push({header:e.title,sortable:true,dataIndex:"field_"+e.field,width:parseInt(e.width,10),menuDisabled:true})});this.store=new Ext.data.Store({autoLoad:true,proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getJsonList"}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:a})});this.grid=new Ext.grid.GridPanel({store:this.store,width:600,plain:false,stripeRows:true,loadMask:{msg:lang("waiting")},region:"center",border:false,autoScroll:true,sm:this.sm,columns:this.cm,tbar:[{handler:function(e,f){d.store.reload()}.createDelegate(this),iconCls:"icon-system-refresh",text:lang("refresh")},{handler:function(e,f){d.addWin("add",0)}.createDelegate(this),iconCls:"icon-utils-s-add",cls:"btn-blue4",text:lang("initIssuesDoc")},{handler:function(f,g){var h=d.grid.getSelectionModel().getSelections();if(h.length==0){CNOA.miniMsg.alertShowAt(f,lang("haveNotChosenEdit"))}else{var i=h[0].get("id");var e=h[0].get("status");if(e!=0){CNOA.msg.alert(lang("flowHasBenStartEnd"))}else{d.addWin("edit",i)}}},iconCls:"icon-utils-s-edit",text:lang("modify")},{text:lang("del"),iconCls:"icon-utils-s-delete",handler:function(e,f){var g=d.grid.getSelectionModel().getSelections();if(g.length==0){CNOA.miniMsg.alertShowAt(e,lang("mustSelectOneRow"))}else{CNOA.miniMsg.cfShowAt(e,lang("confirmToDelete"),function(){if(g){var j="";for(var h=0;h<g.length;h++){j+=g[h].get("id")+","}Ext.Ajax.request({url:d.baseUrl+"&task=deleteData",method:"POST",params:{ids:j},success:function(k){var i=Ext.decode(k.responseText);if(i.success===true){d.store.reload()}else{CNOA.msg.alert(i.msg,function(){})}}})}})}}},{text:lang("distribute"),handler:function(){var f=d.grid.getSelectionModel().getSelections();if(f.length<=0){CNOA.msg.alert(lang("pleaseSelectOne"));return}if(f[0].json.status!=2){CNOA.msg.alert(lang("hasNotBeenApp"));return}var e=f[0].json.id;d.issueSend(e)}.createDelegate(this),iconCls:"icon-applications-stack",cls:"btn-blue3"},{text:lang("issued"),handler:function(){var f=d.grid.getSelectionModel().getSelections();if(f.length<=0){CNOA.msg.alert(lang("pleaseSelectOne"));return}if(f[0].json.status!=2){CNOA.msg.alert(lang("hasNotBeenApp"));return}var e=f[0].json.id;d.signSend(e)}.createDelegate(this),iconCls:"icon-arrow_down",cls:"btn-blue3"},"<span class='cnoa_color_gray'>"+lang("doubleClickEdit")+"</span>"],bbar:new Ext.PagingToolbar({displayInfo:true,store:this.store,pageSize:30})});this.treeStore=new Ext.data.Store({autoLoad:true,proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getSearchList",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:[{name:"field"},{name:"title"}]})});this.searchPanel=new Ext.form.FormPanel({region:"north",height:100,border:false,hidden:true,defaults:{border:false},padding:5,items:[{xtype:"panel",defaults:{border:false},items:[{xtype:"hidden",name:"id"},{xtype:"panel",layout:"table",layoutConfig:{columns:6},defaults:{style:"margin-left:5px;"},height:30,items:[new Ext.form.ComboBox({store:d.treeStore,name:"kong1",hiddenName:"kong1",valueField:"field",displayField:"title",mode:"local",width:150,triggerAction:"all",forceSelection:true,editable:false,listeners:{select:function(g,e,f){}}}),new Ext.form.ComboBox({store:new Ext.data.SimpleStore({fields:["value","name"],data:[["equal",lang("equal")],["noEqual",lang("notEqual")],["contain",lang("contains")],["dayu",lang("greaterThan")],["xiaoyu",lang("lessThan")],["dayuEqual",lang("greaterOrEqual")],["xiaoyuEqual",lang("lessOrEqual")]]}),width:100,value:"equal",valueField:"value",displayField:"name",name:"condition1",hiddenName:"condition1",mode:"local",triggerAction:"all",forceSelection:true,editable:false}),{xtype:"textfield",width:200,name:"value1"},{xtype:"button",text:lang("reset"),handler:function(){c.findField("kong1").setValue("");c.findField("condition1").setValue("equal");c.findField("value1").setValue("")}}]},{xtype:"panel",layout:"table",layoutConfig:{columns:4},defaults:{style:"margin-left:5px;"},height:30,items:[new Ext.form.ComboBox({store:d.treeStore,name:"kong2",hiddenName:"kong2",valueField:"field",displayField:"title",mode:"local",width:150,triggerAction:"all",forceSelection:true,editable:false,listeners:{select:function(g,e,f){}}}),new Ext.form.ComboBox({store:new Ext.data.SimpleStore({fields:["value","name"],data:[["equal",lang("equal")],["noEqual",lang("notEqual")],["contain",lang("contains")],["dayu",lang("greaterThan")],["xiaoyu",lang("lessThan")],["dayuEqual",lang("greaterOrEqual")],["xiaoyuEqual",lang("lessOrEqual")]]}),width:100,value:"equal",valueField:"value",displayField:"name",name:"condition2",hiddenName:"condition2",mode:"local",triggerAction:"all",forceSelection:true,editable:false}),{xtype:"textfield",width:200,name:"value2"},{xtype:"button",text:lang("reset"),handler:function(){c.findField("kong2").setValue("");c.findField("condition2").setValue("equal");c.findField("value2").setValue("")}}]},{xtype:"panel",layout:"table",layoutConfig:{columns:4},defaults:{style:"margin-left:5px;"},height:30,items:[new Ext.form.ComboBox({store:d.treeStore,name:"kong3",hiddenName:"kong3",valueField:"field",displayField:"title",mode:"local",width:150,triggerAction:"all",forceSelection:true,editable:false}),new Ext.form.ComboBox({store:new Ext.data.SimpleStore({fields:["value","name"],data:[["equal",lang("equal")],["noEqual",lang("notEqual")],["contain",lang("contains")],["dayu",lang("greaterThan")],["xiaoyu",lang("lessThan")],["dayuEqual",lang("greaterOrEqual")],["xiaoyuEqual",lang("lessOrEqual")]]}),width:100,value:"equal",valueField:"value",displayField:"name",name:"condition3",hiddenName:"condition3",mode:"local",triggerAction:"all",forceSelection:true,editable:false}),{xtype:"textfield",width:200,name:"value3"},{xtype:"button",text:lang("reset"),handler:function(){c.findField("kong3").setValue("");c.findField("condition3").setValue("equal");c.findField("value3").setValue("")}}]}]}]});var c=d.searchPanel.getForm();this.mainPanel=new Ext.Panel({collapsible:false,hideBorders:true,border:false,layout:"border",autoScroll:false,items:[this.searchPanel,this.grid]});Ext.getCmp(CNOA.odoc.send.apply.parentID).add(this.mainPanel);Ext.getCmp(CNOA.odoc.send.apply.parentID).doLayout()},addWin:function(g,a){var f=this;var c=[{xtype:"fieldset",title:lang("selectProcess"),layout:"column",id:"CNOA_ODOC_NEW_FLOW_CT",hideLabel:true,width:660,autoHeight:true,items:[]},{xtype:"panel",border:false,layout:"form",width:660,id:"ID_DEFINDE_FIELDS_SEND"}];this.addFormPanel=new Ext.form.FormPanel({border:false,labelWidth:90,width:640,labelAlign:"right",waitMsgTarget:true,bodyStyle:"padding-left:5px;",items:c,autoScroll:true});var e=function(){var j=lang("selectProcess"),h;try{h=f.addFormPanel.getForm().findField("ococ_send_apply_flowList").getGroupValue()}catch(i){h="";j=lang("canNotInitProcess")}if(Ext.isEmpty(h)){CNOA.msg.alert(j);return false}return true};var b=function(){var h=f.addFormPanel.getForm();if(h.isValid()){h.submit({url:f.baseUrl+"&task=submitData",method:"POST",waitMsg:lang("waiting"),params:{id:a},success:function(i,j){if(j.result.success==true){d.close();f.store.reload();f.operate(j.result.msg)}}.createDelegate(this),failure:function(i,j){}.createDelegate(this)})}};var d=new Ext.Window({title:lang("add"),width:700,height:makeWindowHeight(500),modal:true,layout:"fit",resizable:false,border:false,items:this.addFormPanel,buttons:[{text:lang("sureFQ"),handler:function(){if(e()){b(a)}}},{text:lang("close"),handler:function(h){d.close()}}]}).show();this.superField=Ext.getCmp("ID_DEFINDE_FIELDS_SEND");f.loadLayout(g,a)},loadLayout:function(c,a){var b=this;Ext.Ajax.request({url:b.baseUrl+"&task=loadLayout",method:"POST",success:function(f){var d=Ext.decode(f.responseText);if(d.success===true){Ext.each(d.fieldset,function(g,h){b.addFieldSet(g.name,g.fieldset)});Ext.each(d.field,function(g,h){Ext.getCmp("ID_FIELD_SEND_"+g.fieldset).add(b.addField(g.fstfield,g.secfield,g.fstname,g.secname,g.type))});var e=Ext.getCmp("CNOA_ODOC_NEW_FLOW_CT");Ext.each(d.flowList,function(g,h){e.add({xtype:"radio",name:"ococ_send_apply_flowList",style:"margin-left: 10px;",boxLabel:g.name,inputValue:g.id,checked:h==0?true:false})});e.doLayout();b.superField.doLayout();if(c=="edit"){b.addFormPanel.getForm().load({url:b.baseUrl+"&task=loadFormData",method:"POST",params:{id:a},success:function(h,i){var g=i.result.data},failure:function(g,h){CNOA.msg.alert(h.result.msg,function(){})}})}}else{CNOA.msg.alert(d.msg,function(){})}}})},addFieldSet:function(b,a){var c=this;c.superField.add({xtype:"fieldset",title:b,autoHeight:true,id:"ID_FIELD_SEND_"+a})},addField:function(a,b,e,g,c){var d=this;if(c=="textarea"){var f={xtype:"panel",layout:"form",items:[{xtype:"textarea",width:464,fieldLabel:e,name:"field_"+a}]}}else{if(c=="sort"){var f={xtype:"panel",layout:"form",items:[{xtype:"combo",fieldLabel:e,name:"field_"+a,store:this.sortStore,hiddenName:"field_"+a,valueField:"iid",displayField:"sort",mode:"local",width:180,triggerAction:"all",forceSelection:true,editable:false}]}}else{if(c=="type"){var f={xtype:"panel",layout:"form",items:[{xtype:"combo",fieldLabel:e,name:"field_"+a,store:this.typeStore,hiddenName:"field_"+a,valueField:"id",displayField:"sid",mode:"local",width:180,triggerAction:"all",forceSelection:true,editable:false}]}}else{if(c=="region"){var f=[{xtype:"panel",layout:"form",items:[{xtype:"combo",fieldLabel:e,name:"field_"+a,store:this.regionStore,name:"field_"+a,secondId:b,valueField:"rid",displayField:"name",mode:"local",width:180,triggerAction:"all",forceSelection:true,editable:false,listeners:{change:function(k,m,j){d.region2="";d.addFormPanel.getForm().findField("field_"+k.secondId).setValue("");d.regionStore2.load({params:{rid:m}})}}}]},{xtype:"panel",layout:"form",items:[{xtype:"combo",fieldLabel:g,name:"field_"+b,store:this.regionStore2,name:"field_"+b,valueField:"pid",displayField:"name",mode:"local",width:180,triggerAction:"all",forceSelection:true,editable:false}]}]}else{var f=[];if(e==""||g==""){var h=e==""?b:a;f=[{xtype:"panel",layout:"form",items:[{xtype:"textfield",width:464,fieldLabel:e==""?g:e,name:"field_"+h}]}]}else{f=[{xtype:"panel",layout:"form",items:[{xtype:"textfield",width:180,fieldLabel:e,name:"field_"+a}]},{xtype:"panel",layout:"form",items:[{xtype:"textfield",width:180,fieldLabel:g,name:"field_"+b}]}]}}}}}var i={xtype:"panel",layout:"table",layoutConfig:{columns:2},style:"margin-top:10px",border:false,defaults:{border:false},items:f};return i},operate:function(a){var b=this;Ext.Ajax.request({url:b.baseUrl+"&task=getFaqiFlow",method:"POST",params:{id:a},success:function(g){var c=Ext.decode(g.responseText);if(c.success===true){var f=c.flowType;var e=c.flowId;var i=c.nameRuleId;var j=c.tplSort;var h=0;var d=c.otherApp;if(f==0){mainPanel.closeTab("CNOA_MENU_WF_USE_OPENFLOW");mainPanel.loadClass("index.php?app=wf&func=flow&action=use&modul=new&task=loadPage&from=newflow&flowId="+e+"&nameRuleId="+i+"&flowType="+f+"&tplSort="+j+"&childId="+h+"&otherApp="+d,"CNOA_MENU_WF_USE_OPENFLOW",lang("FqNewFixedFlow"),"icon-flow-new")}else{mainPanel.closeTab("CNOA_USE_FLOW_NEWFREE_FLOWDESIGN");mainPanel.loadClass("index.php?app=wf&func=flow&action=use&modul=newfree&task=loadPage&from=flowdesign&flowId="+e+"&flowType="+f+"&tplSort="+j+"&childId="+h+"&otherApp="+d,"CNOA_USE_FLOW_NEWFREE_FLOWDESIGN",lang("designFlow"),"icon-flow-new")}}else{CNOA.msg.alert(c.msg,function(){})}}})},viewFlow:function(a){mainPanel.closeTab("CNOA_MENU_WF_USE_OPENFLOW");mainPanel.loadClass(this.baseUrl+"&task=loadPage&from=viewflow&uFlowId="+a,"CNOA_MENU_WF_USE_OPENFLOW","查看工作流程","icon-flow")},signSend:function(b){var e=this;var a=Ext.id();var c=new Ext.form.FormPanel({border:false,labelWidth:80,labelAlign:"right",bodyStyle:"padding: 10px 0 0 15px",defaults:{style:"margin-bottom: 10px",width:330},items:[{xtype:"textfield",fieldLabel:lang("docSendUnit"),name:"deptment",allowBlank:false},{xtype:"textfield",fieldLabel:lang("title"),name:"title",allowBlank:false},{xtype:"textfield",fieldLabel:lang("receiveDocNum"),name:"number",allowBlank:false},{xtype:"numberfield",fieldLabel:lang("numOfPrint"),name:"print",allowBlank:false},{xtype:"checkboxgroup",fieldLabel:lang("issuanceContent"),allowBlank:false,items:[{boxLabel:lang("appOfText"),name:"withWord"},{boxLabel:lang("flowAttachment"),name:"withAttach"}]},{xtype:"hidden",id:a,name:"uids"},{xtype:"textfield",readOnly:true,allowBlank:false,fieldLabel:lang("receiveMan"),emptyText:lang("pleaseSelectRecipient"),blankText:lang("pleaseSelectRecipient"),name:"names",listeners:{render:function(f){f.to=a},focus:function(f){people_selector("user",f,false,false)}}}]});var d=new Ext.Window({title:lang("issued"),width:460,height:325,layout:"fit",modal:true,resizable:false,maximizable:false,items:c,buttons:[{text:lang("ok"),handler:function(){var g=c.getForm();if(g.isValid()){g.submit({url:e.baseUrl+"&task=submitSign",method:"POST",params:{pid:b},success:function(f,h){CNOA.msg.notice(h.result.msg,lang("docMgr"));e.store.reload();d.close()},failure:function(f,h){CNOA.msg.alert(h.result.msg)}})}else{CNOA.msg.alert(lang("formValid"))}}},{text:lang("close"),handler:function(){d.close()}}]}).show();return d},issueSend:function(f){var e=this;var c=e.grid.getSelectionModel().getSelections();if(c.length<=0){CNOA.msg.alert(lang("pleaseSelectOne"));return}var a=c[0].json.id;var b=new Ext.form.FormPanel({border:false,labelWidth:60,labelAlign:"right",bodyStyle:"padding: 10px",items:[{xtype:"checkboxgroup",fieldLabel:lang("distributeContent"),columns:3,allowBlank:false,items:[{boxLabel:lang("appForm"),name:"viewForm"},{boxLabel:lang("appOfText"),name:"viewWord",checked:true},{boxLabel:lang("flowAttachment"),name:"viewAttach",checked:true}]},{xtype:"textarea",fieldLabel:lang("peopleToView"),name:"recvMan",width:333,height:150,readOnly:true,allowBlank:false},{xtype:"hidden",name:"recvUids",id:e.ID_recvUids},{xtype:"btnForPoepleSelector",fieldLabel:"",text:lang("select"),allowBlank:false,name:"checkName",dataUrl:e.baseUrl+"&task=getAllUserListsInPermitDeptTree",width:70,style:"margin: 0 0 0 65px",listeners:{selected:function(m,n){var o=new Array();var k=new Array();if(n.length>0){for(var j=0;j<=n.length-1;j++){o.push(n[j].uname);k.push(n[j].uid)}}var h=o.join(",");var g=k.join(",");b.getForm().findField("recvUids").setValue(g);b.getForm().findField("recvMan").setValue(h)}}}]});submit=function(){var g=b.getForm();if(g.isValid()){g.submit({url:e.baseUrl+"&task=submitIssue",method:"POST",params:{id:a},success:function(h,i){CNOA.msg.notice(i.result.msg,lang("docMgr"));e.store.reload();d.close()},failure:function(h,i){CNOA.msg.alert(i.result.msg)}})}else{CNOA.msg.alert(lang("formValid"))}};var d=new Ext.Window({title:lang("distribute"),width:430,height:330,layout:"fit",modal:true,resizable:false,maximizable:false,items:[b],buttons:[{text:lang("sureDistribute"),handler:function(){submit()}},{text:lang("close"),handler:function(){d.close()}}]}).show();return d}};var CNOA_odoc_setting_flowClass,CNOA_odoc_setting_flow;var CNOA_odoc_setting_setAddWin1,CNOA_odoc_setting_setAddWin2,CNOA_odoc_setting_setAddWinClass;var CNOA_odoc_setting_setWinList1,CNOA_odoc_setting_setWinList2,CNOA_odoc_setting_setWinListClass;var CNOA_odoc_setting_setBindFlowClass;CNOA_odoc_setting_setAddWinClass=function(j){var f=this;this.baseUrl="index.php?app=odoc&func=setting&action=flow";this.dataStore={fieldset:[],field:[]};this.fieldsetStoreData=[];var c=1;var d=1;var m=[{xtype:"panel",border:false,layout:"form",defaults:{},id:"ID_DEFINDE_FIELDS_SET"}];this.form=new Ext.form.FormPanel({border:false,labelWidth:60,labelAlign:"left",autoWidth:true,waitMsgTarget:true,bodyStyle:"padding:5px 10px 10px 10px;",items:m,autoScroll:true,hideLabel:true,listeners:{render:function(n){}}});var g=new Ext.Panel({layout:"fit",id:"odoc_view_"+j,items:this.form,tbar:[{text:lang("addSort"),cls:"btn-red1",handler:function(n){Ext.MessageBox.prompt("",lang("youNeesAddCategory"),function(o,p){if(o=="ok"){if(p!=""){k(p,0,true)}else{CNOA.msg.alert(lang("youNotAddName"))}}})}},{text:lang("addInputBoxes"),cls:"btn-yellow1",handler:function(n){i("add","","","","","","")}},{text:lang("save"),iconCls:"icon-win-save",cls:"btn-blue4",handler:function(n){var o=[];$("#ID_DEFINDE_FIELDS_SET").find("fieldset").each(function(q,p){var s=p.id;var r=Ext.getCmp(s);var t={fieldset:{id:r.fieldsetid,name:r.title},items:[]};$("#"+s).find("input,textarea").each(function(v,u){var w=$(this);t.items.push({name:w.attr("name"),value:w.val()})});o.push(t)});f.form.getForm().submit({url:f.baseUrl+"&task=submitAddWinLayout",method:"POST",waitMsg:lang("waiting"),params:{data:Ext.encode(o),from:j},success:function(p,q){CNOA.msg.alert(lang("successopt"),function(){h()})}.createDelegate(this),failure:function(p,q){CNOA.msg.alert(q.result.msg,function(){}.createDelegate(this))}.createDelegate(this)})}},('<span class="cnoa_color_gray">'+lang("add")+(j=="send"?lang("docSend"):lang("receiveDoc"))+lang("windowSetting")+"</span>")]});var k=function(p,q,o){var r=Ext.getCmp("ID_DEFINDE_FIELDS_SET");if(!q){q=0}var n="ID_FIELD_SET_"+c;r.add({xtype:"fieldset",title:p,width:600,autoHeight:true,id:n,fieldsetid:q,items:[{xtype:"button",text:lang("delCategories"),fieldsetid:q,handler:function(s){CNOA.msg.cf(lang("removeClassification"),function(v){if(v=="yes"){r.remove(Ext.getCmp(n));var t=[],u=[];Ext.each(f.dataStore.fieldset,function(w){if(w.fieldset!=s.fieldsetid){t.push(w);u.push([w.fieldset,w.name])}});f.dataStore.fieldset=t;f.fieldsetStoreData=u}})}}]});f.fieldsetStoreData.push([q,p]);if(o){f.dataStore.fieldset.push({fieldset:q,name:p,sid:c})}c++;r.doLayout()};var e=function(o){var n={};switch(o){case"text":n.note_one="{["+lang("singleLineOfText")+"]}";n.note_two="{["+lang("singleLineOfText")+"]}";break;case"textarea":n.note_one="{["+lang("multipleLine")+"]}";n.note_two="{["+lang("multipleLine")+"]}";break;case"type":n.note_one="{["+lang("customCategory")+"]}";n.note_two="";break;case"sort":n.note_one="{["+lang("industryInformation")+"]}";n.note_two="";break;case"region":n.note_one="{["+lang("region")+"]}";n.note_two="{["+lang("twoRegion")+"]}";break;case"account":n.note_one="{["+lang("loginUserName")+"]}";n.note_two="{["+lang("realName")+"]}";break}return n};var i=function(A,q,r,u,t,n,p){var y=new Ext.data.SimpleStore({fields:["fieldsetid","name"],data:f.fieldsetStoreData});var D=[{xtype:"combo",fieldLabel:lang("type"),name:"typeFrom",hiddenName:"typeFrom",store:new Ext.data.SimpleStore({fields:["value","name"],data:[["text",lang("singleLineOfText")],["textarea",lang("multipleLine")]]}),valueField:"value",displayField:"name",mode:"local",triggerAction:"all",forceSelection:true,editable:false,width:200,value:"text",listeners:{change:function(F,G,E){if(G=="textarea"||G=="type"||G=="sort"){o.getForm().findField("secname").setValue("");o.getForm().findField("secname").hide()}else{o.getForm().findField("secname").show()}}}},{xtype:"combo",fieldLabel:lang("categoryList"),name:"fieldsetid",hiddenName:"fieldsetid",store:y,valueField:"fieldsetid",displayField:"name",mode:"local",triggerAction:"all",forceSelection:true,editable:false,width:200,allowBlank:false},{xtype:"textfield",name:"fstname",width:200,fieldLabel:lang("firstName")},{xtype:"textfield",name:"secname",width:200,fieldLabel:lang("secondName")}];var o=new Ext.form.FormPanel({border:false,labelWidth:90,labelAlign:"right",autoWidth:true,waitMsgTarget:true,bodyStyle:"padding:5px 10px 10px 10px;",items:D,autoScroll:true});var w=new Ext.Window({title:A=="edit"?lang("edit"):lang("add"),modal:true,resizable:false,width:400,height:220,layout:"fit",items:o,buttons:[{text:lang("ok"),hidden:A=="add"?false:true,handler:function(F){if(!o.getForm().isValid()){CNOA.msg.alert(lang("partNotFill"));return false}var E=o.getForm().getValues();a({fieldset:E.fieldsetid,fstfield:"0",fstname:E.fstname,secfield:"0",secname:E.secname,type:E.typeFrom});w.close()}},{text:lang("modify"),hidden:A=="edit"?false:true,handler:function(F){if(!o.getForm().isValid()){CNOA.msg.alert(lang("partNotFill"));return false}var E=o.getForm().getValues();var G=e(t);f.form.getForm().findField("field_"+u+"_"+n+"_"+q+"_"+t).setValue(G.note_one+E.fstname);try{f.form.getForm().findField("field_"+u+"_"+p+"_"+r+"_"+t).setValue(G.note_two+E.secname)}catch(H){B=""}w.close()}},{text:lang("close"),handler:function(E){w.close()}}]}).show();if(A=="edit"){var C=f.form.getForm().findField("field_"+u+"_"+n+"_"+q+"_"+t).getValue();C=C.replace(/\{\[.*\]\}/ig,"");try{var B=f.form.getForm().findField("field_"+u+"_"+p+"_"+r+"_"+t).getValue();B=B.replace(/\{\[.*\]\}/ig,"")}catch(x){B=""}var s={};var v="";var z="";s.data={typeFrom:t,fieldsetid:u,fstname:C,secname:B};o.getForm().loadRecord(s);o.getForm().findField("fieldsetid").setDisabled(true);o.getForm().findField("typeFrom").setDisabled(true);if(t=="textarea"){o.getForm().findField("secname").hide()}}};var b=function(r){var n=d++;var o=d++;var q=r.type;var u=r.fieldset;var p="ID_GROUP_CHILD_FIELD"+n;var t=e(q);if(q=="textarea"){var s=[{xtype:"textarea",width:380,readOnly:true,name:"field_"+u+"_"+n+"_"+r.fstfield+"_"+q,value:t.note_one+r.fstname}]}else{var s=[{xtype:"textfield",width:180,readOnly:true,name:"field_"+u+"_"+n+"_"+r.fstfield+"_"+q,value:t.note_one+r.fstname},{xtype:"textfield",width:180,readOnly:true,name:"field_"+u+"_"+o+"_"+r.secfield+"_"+q,style:"margin-left:20px",value:t.note_two+r.secname}]}s.push({xtype:"button",text:lang("edit"),firstId:n,secondId:o,fieldset:u,typeFrom:q,fstfield:r.fstfield,secfield:r.secfield,style:"margin-left:10px",handler:function(w){i("edit",w.fstfield,w.secfield,w.fieldset,w.typeFrom,n,o)}},{xtype:"button",text:lang("del"),tableId:n,style:"margin-left:10px",handler:function(x){var w=$("#"+p).parents("fieldset[id^=ID_FIELD_SET_]").get(0).id;Ext.getCmp(w).remove(p)}});var v={xtype:"panel",layout:"table",layoutConfig:{columns:5},style:"margin-top:10px",border:false,id:p,defaults:{border:false},items:s};return v};var a=function(o){var p=Ext.getCmp("ID_DEFINDE_FIELDS_SET");var n=null;Ext.getCmp("ID_DEFINDE_FIELDS_SET").items.each(function(q){if(q.fieldsetid==o.fieldset){n=Ext.getCmp(q.id)}});n.add(b(o));n.doLayout()};this.initView=function(){Ext.getCmp("ID_DEFINDE_FIELDS_SET").removeAll();f.fieldsetStoreData=[];Ext.each(f.dataStore.fieldset,function(n){k(n.name,n.fieldset)});Ext.each(f.dataStore.field,function(n){a(n)})};var h=function(){Ext.Ajax.request({url:f.baseUrl+"&task=loadFormData",method:"POST",params:{from:j},success:function(o){var n=Ext.decode(o.responseText);if(n.success===true){f.dataStore.fieldset=n.fieldset;f.dataStore.field=n.field;f.initView()}else{CNOA.msg.alert(n.msg,function(){})}}})};h();return g};CNOA_odoc_setting_setWinListClass=function(h){var e=this;this.baseUrl="index.php?app=odoc&func=setting&action=flow";var c=["field","name","title","width"];var g=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getFieldList",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:c}),listeners:{load:function(n,k,m){}}});g.load({params:{from:h}});var j=new Ext.grid.ColumnModel([{id:"name",header:"输入框名称",sortable:true,dataIndex:"name",menuDisabled:true}]);var i=new Ext.grid.GridPanel({region:"west",width:240,ddGroup:"wordDDGroup",layout:"fit",bodyStyle:"border-right-width:1px;",enableDragDrop:true,store:g,cm:j,autoExpandColumn:"name",sm:new Ext.grid.RowSelectionModel({singleSelect:true}),dropConfig:{appendOnly:true},border:false,listeners:{afterrender:function(k){setTimeout(function(){try{new Ext.dd.DropTarget(f.getView().scroller.dom,{ddGroup:"wordDDGroup",notifyDrop:function(r,q,p){var n=r.dragData.selections;Ext.each(n,r.grid.store.remove,r.grid.store);var o=r.getDragData(q).rowIndex;if(typeof(o)=="undefined"){f.store.add(n)}else{b.insert(o,n)}}})}catch(m){}},1000)}}});var b=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getWordList",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:c})});b.load({params:{from:h}});var a=new Ext.grid.ColumnModel([{header:"",hidden:true,dataIndex:"fieldid"},{header:"输入框名称",width:150,sortable:true,dataIndex:"name",menuDisabled:true},{id:"title",header:"自定义名称",sortable:true,dataIndex:"title",menuDisabled:true,editor:{xtype:"textfield",allowBlank:true}},{header:"宽度",width:80,sortable:true,dataIndex:"width",menuDisabled:true,editor:{xtype:"textfield",allowBlank:true}}]);var f=new Ext.grid.EditorGridPanel({region:"center",border:false,ddGroup:"wordDDGroup",layout:"fit",enableDragDrop:true,store:b,cm:a,autoExpandColumn:"title",sm:new Ext.grid.RowSelectionModel({singleSelect:true}),clicksToEdit:1,listeners:{afterrender:function(k){setTimeout(function(){try{new Ext.dd.DropTarget(i.getView().scroller.dom,{ddGroup:"wordDDGroup",notifyEnter:function(p,o,n){},notifyDrop:function(r,q,p){var n=r.dragData.selections;Ext.each(n,r.grid.store.remove,r.grid.store);var o=r.getDragData(q).rowIndex;if(typeof(o)=="undefined"){i.store.add(n)}else{g.insert(o,n)}}})}catch(m){}},1000)}}});var d=new Ext.Panel({resizable:false,modal:true,layout:"border",items:[i,f],id:"odoc_list_"+h,tbar:[{text:lang("save"),iconCls:"icon-btn-save",handler:function(k){var m=[];Ext.each(b.data.items,function(n,o){m.push(n.data)});Ext.Ajax.request({url:e.baseUrl+"&task=submitList",method:"POST",params:{data:Ext.encode(m),from:h},success:function(o){var n=Ext.decode(o.responseText);if(n.success===true){CNOA.msg.alert(n.msg,function(){})}else{CNOA.msg.alert(n.msg,function(){})}}})}},('<span class="cnoa_color_gray">设置'+(h=="send"?"发":"收")+"文的列表显示</span>"),'<span class="cnoa_color_gray">可以拖动左边的输入框到右边栏目里添加列，双击“自定义名称”/“宽度”可以修改相应内容。</span>']});return d};CNOA_odoc_setting_setBindFlowClass=CNOA.Class.create();CNOA_odoc_setting_setBindFlowClass.prototype={init:function(e){var d=this;this.from=e;this.baseUrl="index.php?app=odoc&func=setting&action=flow";var a=[{name:"id"},{name:"name"},{name:"flowId"},{name:"flowName"},{name:"status"},{name:"bindKJ"}];this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getFlowJsonData&from="+this.from,disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:a})});var c=new Ext.grid.CheckboxSelectionModel({singleSelect:true});this.store.load();var b=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),{header:"id",dataIndex:"id",hidden:true},{header:lang("flowName"),dataIndex:"name",width:180,sortable:true,menuDisabled:true},{header:"绑定工作流",dataIndex:"flowName",width:180,sortable:true,menuDisabled:true},{header:"状态",dataIndex:"status",width:60,sortable:false,menuDisabled:true,renderer:function(g,i,f){var h=this;if(g==1){return"<span class=cnoa_color_green>启用</span>"}else{return"<span class=cnoa_color_red>停用</span>"}}},{header:"绑定控件",dataIndex:"bindKJ",id:"bindKJ",width:140,sortable:false,menuDisabled:true},{header:lang("opt"),dataIndex:"id",width:240,sortable:false,menuDisabled:true,renderer:function(k,m,j){var i=j.data,f="";if(i.status==1){f="停用"}else{f="启用"}var g="<a href='javascript:void(0);' class='gridview' onclick='CNOA_odoc_setting_setBindFlow.setStatus("+k+", "+i.status+")'>"+f+"</a>";g+="<a href='javascript:void(0);' class='gridview4 jianju' onclick='CNOA_odoc_setting_setBindFlow.addFlow(\"edit\", "+k+")'>修改</a>";g+="<a href='javascript:void(0);' class='gridview3 jianju' onclick='CNOA_odoc_setting_setBindFlow.bindKongJian("+k+")'>绑定控件</a>";g+="<a href='javascript:void(0);' class='gridview2 jianju' onclick='CNOA_odoc_setting_setBindFlow.deleteFlow("+k+")'>删除</a>";return g}},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.right=new Ext.grid.GridPanel({store:this.store,loadMask:{msg:lang("waiting")},cm:b,hideBorders:true,border:false,region:"center",layout:"fit",autoExpandColumn:"bindKJ",stripeRows:true,tbar:new Ext.Toolbar({items:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(f){d.store.reload()}},{text:lang("add"),iconCls:"icon-utils-s-add",handler:function(f){d.addFlow("add")}},(function(){var f='<span class="cnoa_color_gray">';switch(d.from){case"send":f+="绑定发文流程";break;case"receive":f+="绑定收文流程";break;return}f+="</span>";return f})()]})});this.mainPanel=new Ext.Panel({layout:"border",id:"odoc_bind_"+this.from,items:[this.right]})},setStatus:function(c,a){var b=this;CNOA.msg.cf("确定要"+(a==0?"启用":"停用")+"此条公文流程吗？",function(d){if(d=="yes"){Ext.Ajax.request({url:b.baseUrl+"&task=setStatus",method:"POST",params:{id:c},success:function(f){var e=Ext.decode(f.responseText);if(e.success===true){CNOA.msg.alert(e.msg,function(){b.store.load()})}else{CNOA.msg.alert(e.msg,function(){})}}})}})},deleteFlow:function(b){var a=this;CNOA.msg.cf("确定要删除此条公文流程吗？",function(c){if(c=="yes"){Ext.Ajax.request({url:a.baseUrl+"&task=deleteFlow",method:"POST",params:{id:b},success:function(e){var d=Ext.decode(e.responseText);if(d.success===true){CNOA.msg.alert(d.msg,function(){a.store.load()})}else{CNOA.msg.alert(d.msg,function(){})}}})}})},addFlow:function(e,h){var g=this;var a,b,c;var f=function(){a.getForm().load({url:g.baseUrl+"&task=editLoadBindFlowData",params:{id:h},method:"POST",waitMsg:lang("waiting"),success:function(i,j){}.createDelegate(this),failure:function(i,j){CNOA.msg.alert(j.result.msg,function(){c.close()})}.createDelegate(this)})};b=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getFlowList",method:"POST"}),reader:new Ext.data.JsonReader({root:"data",fields:[{name:"flowId"},{name:"name"}]}),listeners:{load:function(k,i,j){}}});b.load();a=new Ext.form.FormPanel({border:false,labelWidth:60,labelAlign:"left",autoWidth:true,waitMsgTarget:true,bodyStyle:"padding:5px",items:[{xtype:"textfield",fieldLabel:lang("flowName"),name:"name",width:400},{xtype:"combo",fieldLabel:"绑定流程",name:"bindFlow",hiddenName:"bindFlow",store:b,valueField:"flowId",displayField:"name",mode:"local",triggerAction:"all",forceSelection:true,editable:false,width:400}],listeners:{render:function(i){if(e){f()}}}});var d="";if(e=="edit"){if(this.from=="send"){d="修改发文流程绑定"}else{if(this.from=="receive"){d="修改收文流程绑定"}}}else{if(this.from=="send"){d="添加发文流程绑定"}else{if(this.from=="receive"){d="添加收文流程绑定"}}}c=new Ext.Window({title:d,width:492,height:150,modal:true,resizable:false,layout:"fit",items:a,buttons:[{text:lang("save"),handler:function(i){a.getForm().submit({url:g.baseUrl+"&task=submitBindFlow",method:"POST",waitMsg:lang("waiting"),params:{from:g.from,tp:e,id:h},success:function(j,k){CNOA.msg.alert(lang("successopt"),function(){c.close();g.store.load()})}.createDelegate(this),failure:function(j,k){CNOA.msg.alert(k.result.msg,function(){}.createDelegate(this))}.createDelegate(this)})}},{text:lang("close"),handler:function(i){c.close()}}]}).show()},bindKongJian:function(c){var i=this;var g=[{name:"field"},{name:"kongjian"},{name:"name"}];var b=new Ext.data.GroupingStore({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getBindFieldList"}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:g}),listeners:{load:function(o,m,n){}}});var f=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getFlowFieldList",method:"POST"}),reader:new Ext.data.JsonReader({root:"data",fields:[{name:"id"},{name:"name"}]}),listeners:{load:function(o,m,n){b.load({params:{from:i.from,id:c}})}}});f.load({params:{from:i.from,id:c}});var j=new Ext.ux.grid.RowEditor({cancelText:lang("cancel"),saveText:lang("update"),errorSummary:false});var e=new Ext.grid.CheckboxSelectionModel({singleSelect:true});var d=new Ext.form.ComboBox({width:150,autoLoad:true,triggerAction:"all",selectOnFocus:true,editable:false,store:f,valueField:"id",displayField:"name",mode:"local",forceSelection:true});var k=[new Ext.grid.RowNumberer(),{header:"",hidden:true,dataIndex:"field"},{header:"输入框",sortable:true,dataIndex:"name",width:200,menuDisabled:true},{header:"流程控件",sortable:true,dataIndex:"kongjian",width:200,menuDisabled:true,editor:d,renderer:function(m){var n;f.each(function(o){if(o.get("id")==m){n=o;return}});return n==null?"":n.get("name")}}];var a=new Ext.grid.GridPanel({store:b,plain:false,stripeRows:true,loadMask:{msg:lang("waiting")},region:"center",layout:"fit",border:false,autoScroll:true,columns:k,plugins:j,view:new Ext.grid.GroupingView({markDirty:false})});var h=new Ext.Window({title:"绑定流程控件",width:700,height:550,resizable:false,modal:true,layout:"fit",items:a,buttons:[{text:lang("save"),handler:function(m){var n=[];Ext.each(b.data.items,function(o,p){n.push(o.data)});Ext.Ajax.request({url:i.baseUrl+"&task=submitBindFlowField",method:"POST",params:{data:Ext.encode(n),from:i.from,id:c},success:function(p){var o=Ext.decode(p.responseText);if(o.success===true){CNOA.msg.alert(o.msg,function(){h.close()})}else{CNOA.msg.alert(o.msg,function(){})}}})}},{text:lang("close"),handler:function(){h.close()}}]}).show()}};CNOA_odoc_setting_flowClass=CNOA.Class.create();CNOA_odoc_setting_flowClass.prototype={init:function(){var e=this;this.from="";var a=Ext.id();var d=Ext.id();var b=Ext.id();var c=Ext.id();this.baseUrl="index.php?app=odoc&func=setting&action=flow";this.mainPanel=new Ext.Panel({collapsible:false,hideBorders:true,border:false,region:"center",layout:"fit",items:[new CNOA_odoc_setting_setAddWinClass("send")],tbar:[{xtype:"buttongroup",title:"界面设置",columns:2,defaults:{scale:"small",allowDepress:false,toggleGroup:"odocSettings",enableToggle:true},items:[{handler:function(f,g){e.getSetAddWin("send")}.createDelegate(this),pressed:true,iconCls:"icon-odoc-send",cls:"btn-blue2",text:"发文"},{handler:function(f,g){e.getSetAddWin("receive")}.createDelegate(this),iconCls:"icon-odoc-receive",cls:"btn-blue2",text:"收文"}]},{xtype:"buttongroup",title:"列表设置",columns:2,defaults:{scale:"small",allowDepress:false,toggleGroup:"odocSettings",enableToggle:true},items:[{handler:function(f,g){e.getSetWinList("send")},iconCls:"icon-odoc-send",cls:"btn-blue2",text:"发文"},{handler:function(f,g){e.getSetWinList("receive")},iconCls:"icon-odoc-receive",cls:"btn-blue2",text:"收文"}]},{xtype:"buttongroup",title:"绑定工作流",columns:3,defaults:{scale:"small",allowDepress:false,toggleGroup:"odocSettings",enableToggle:true},items:[{handler:function(f,g){e.getSetBindFlow("send")},iconCls:"icon-odoc-send",cls:"btn-blue2",text:"发文"},{handler:function(f,g){e.getSetBindFlow("receive")},iconCls:"icon-odoc-receive",cls:"btn-blue2",text:"收文"}]},"<span class='cnoa_color_red'>创建流程后，如没启用则无法显示</span>"]})},clearItems:function(){try{Ext.destroy(this.mainPanel.items.items)}catch(a){}},getSetAddWin:function(a){this.clearItems();this.mainPanel.add(new CNOA_odoc_setting_setAddWinClass(a));this.mainPanel.doLayout()},getSetWinList:function(a){this.clearItems();this.mainPanel.add(new CNOA_odoc_setting_setWinListClass(a));this.mainPanel.doLayout()},getSetBindFlow:function(a){CNOA_odoc_setting_setBindFlow=new CNOA_odoc_setting_setBindFlowClass(a);this.clearItems();this.mainPanel.add(CNOA_odoc_setting_setBindFlow.mainPanel);this.mainPanel.doLayout()}};var CNOA_odoc_viewFiles,CNOA_odoc_viewFilesClass;CNOA_odoc_viewFilesClass=CNOA.Class.create();CNOA_odoc_viewFilesClass.prototype={init:function(c,a){var b=this;this.id=c;this.baseUrl=a;this.ID_attachCt=Ext.id();this.ID_printArea=Ext.id();this.ID_baseInfo=Ext.id();var b=this;this.ID_fieldSet_Base=Ext.id();this.ID_fieldSet_Word=Ext.id();this.ID_fieldSet_Attach=Ext.id();this.ID_fieldSet_Form=Ext.id();this.mainPanel=new Ext.Window({title:lang("viewArchiveContent"),width:800,height:makeWindowHeight(Ext.getBody().getBox().height-40),modal:true,bodyStyle:"background-color:#FFF;padding:10px;",autoScroll:true,maximizable:true,border:false,items:[{xtype:"fieldset",title:lang("fileInformation"),collapsible:true,id:this.ID_fieldSet_Base},{xtype:"fieldset",title:lang("officialForm"),collapsible:true,id:this.ID_fieldSet_Form},{xtype:"fieldset",title:lang("gongWenText"),id:this.ID_fieldSet_Word,items:[{xtype:"button",text:lang("viewText"),handler:function(){var d=b.baseUrl+"&task=viewFile&act=loadWordFile&id="+c+"&"+getSessionStr();openOfficeForView(d,"doc","查看正文内容")}}]},{xtype:"fieldset",title:lang("attach"),id:this.ID_fieldSet_Attach}],listeners:{afterrender:function(){b.loadInfo()}},buttons:[{text:lang("close"),handler:function(d){b.mainPanel.close()}}]}).show()},loadInfo:function(){var a=this;Ext.Ajax.request({url:a.baseUrl+"&task=viewFile",method:"POST",params:{id:this.id},success:function(c){var b=Ext.decode(c.responseText);if(b.success===true){makeListView2(b.data.baseInfo,Ext.getCmp(a.ID_fieldSet_Base).body);if(b.data.word){}if(b.data.form){Ext.getCmp(a.ID_fieldSet_Form).show();Ext.getCmp(a.ID_fieldSet_Form).body.update(b.data.form)}if(b.data.attach){Ext.getCmp(a.ID_fieldSet_Attach).show();Ext.getCmp(a.ID_fieldSet_Attach).body.update(b.data.attach)}}else{}}})}};var CNOA_odoc_files_anjuanmgr,CNOA_odoc_files_anjuanmgrClass;CNOA_odoc_files_anjuanmgrClass=CNOA.Class.create();CNOA_odoc_files_anjuanmgrClass.prototype={init:function(){var c=this;var a=Ext.id();var b=Ext.id();this.baseUrl="index.php?app=odoc&func=files&action=anjuanmgr";this.typeListStore=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:c.baseUrl+"&task=getTypeList"}),reader:new Ext.data.JsonReader({root:"data",fields:[{name:"id"},{name:"title"}]})});this.typeListStore.load();this.levelListStore=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:c.baseUrl+"&task=getLevelList"}),reader:new Ext.data.JsonReader({root:"data",fields:[{name:"tid"},{name:"title"}]})});this.levelListStore.load();this.savetimeListStore=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:c.baseUrl+"&task=getSavetimeList"}),reader:new Ext.data.JsonReader({root:"data",fields:[{name:"id"},{name:"title"}]})});this.savetimeListStore.load();this.roomListStore=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:c.baseUrl+"&task=getRoomList"}),reader:new Ext.data.JsonReader({root:"data",fields:[{name:"id"},{name:"title"}]})});this.roomListStore.load();this.storeBar={id:0,storeType:"waiting",status:"",type:""};this.fields=[{name:"id"},{name:"title"},{name:"room"},{name:"hehao"},{name:"type"},{name:"title"},{name:"anjuandate"},{name:"page"},{name:"savetime"},{name:"note"},{name:"status"}];this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getJsonData",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields}),listeners:{exception:function(i,h,j,g,f,e){var d=Ext.decode(f.responseText);if(d.failure){CNOA.msg.alert(d.msg)}}}});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.pagingBar=new Ext.PagingToolbar({displayInfo:true,emptyMsg:lang("pagingToolbarEmptyMsg"),displayMsg:lang("showDataTotal2"),store:this.store,pageSize:15,listeners:{beforechange:function(d,e){Ext.apply(e,c.storeBar)}}});this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),this.sm,{header:"id",dataIndex:"id",hidden:true},{header:lang("properties"),dataIndex:"status",width:40,sortable:true,menuDisabled:true,renderer:this.status.createDelegate(this)},{header:lang("belongToNeiMu"),dataIndex:"type",width:100,sortable:true,menuDisabled:true},{header:lang("boxNo"),dataIndex:"hehao",width:100,sortable:true,menuDisabled:true},{header:lang("docketTitle"),dataIndex:"title",width:80,sortable:true,menuDisabled:true},{header:lang("year1"),dataIndex:"anjuandate",width:80,sortable:true,menuDisabled:true},{header:lang("page"),dataIndex:"page",width:80,sortable:true,menuDisabled:true},{header:lang("retentionPeriod"),dataIndex:"savetime",width:80,sortable:true,menuDisabled:true},{header:lang("remark"),dataIndex:"note",width:80,sortable:true,menuDisabled:true},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.grid=new Ext.grid.GridPanel({stripeRows:true,region:"center",bodyStyle:"border-left-width:1px;",store:this.store,loadMask:{msg:lang("loading")},cm:this.colModel,sm:this.sm,hideBorders:true,tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(d,e){c.store.reload()}},{handler:function(d,e){c.add("add",0)}.createDelegate(this),iconCls:"icon-utils-s-add",cls:"btn-blue4",text:lang("addDockert")},{text:lang("modify"),iconCls:"icon-utils-s-edit",handler:function(){var d=c.grid.getSelectionModel().getSelections();if(d.length==0){CNOA.miniMsg.alertShowAt(button,lang("mustSelectOneRow"))}else{c.add("edit",d[0].get("id"))}}},{text:lang("del"),iconCls:"icon-utils-s-delete",handler:function(d){var e=c.grid.getSelectionModel().getSelections();if(e.length==0){CNOA.miniMsg.alertShowAt(d,lang("mustSelectOneRow"))}else{CNOA.miniMsg.cfShowAt(d,lang("areYouDelete"),function(){if(e){var g="";for(var f=0;f<e.length;f++){g+=e[f].get("id")+","}c.deleteData(g)}})}}},{text:lang("closeDocket"),iconCls:"icon-new-lock",cls:"btn-blue3",handler:function(d){var e=c.grid.getSelectionModel().getSelections();if(e.length==0){CNOA.miniMsg.alertShowAt(d,lang("didNotCloseDocket"))}else{CNOA.miniMsg.cfShowAt(d,lang("sureCloseDocket"),function(){if(e){var g="";for(var f=0;f<e.length;f++){g+=e[f].get("id")+","}c.lock(g,"lock")}})}}},{text:lang("unwinder"),iconCls:"icon-new-unlock",cls:"btn-blue3",handler:function(d){var e=c.grid.getSelectionModel().getSelections();if(e.length==0){CNOA.miniMsg.alertShowAt(d,lang("didNotCloseDocket"))}else{CNOA.miniMsg.cfShowAt(d,lang("suerOpenDocket"),function(){if(e){var g="";for(var f=0;f<e.length;f++){g+=e[f].get("id")+","}c.lock(g,"unlock")}})}}},"->",{xtype:"cnoa_helpBtn",helpid:4002}],bbar:this.pagingBar});this.treeRoot=new Ext.tree.AsyncTreeNode({text:lang("fileRoom"),expanded:true});this.treeLoader=new Ext.tree.TreeLoader({dataUrl:this.baseUrl+"&task=getRoom",preloadChildren:true,clearOnLoad:false});this.dirTree=new Ext.tree.TreePanel({hideBorders:true,border:false,rootVisible:true,lines:true,animCollapse:false,animate:false,loader:this.treeLoader,root:this.treeRoot,autoScroll:true,listeners:{click:function(d){c.storeBar.id=d.attributes.id;c.store.load({params:c.storeBar})}.createDelegate(this)}});this.left=new Ext.Panel({region:"west",width:200,layout:"fit",split:true,minWidth:80,maxWidth:380,bodyStyle:"border-right-width:1px;",items:[this.dirTree],tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(d,e){c.treeRoot.reload()}},"->",lang("fileRoom")]});this.mainPanel=new Ext.Panel({collapsible:false,hideBorders:true,border:false,layout:"border",autoScroll:false,items:[this.left,this.grid],tbar:[lang("nameProject")+": ",{xtype:"textfield",width:100,id:b},{xtype:"button",text:lang("search"),style:"margin-left:5px",handler:function(){c.storeBar.type=Ext.getCmp(b).getValue();c.store.load({params:c.storeBar})}},{xtype:"button",text:lang("clear"),handler:function(){Ext.getCmp(b).setValue("");c.storeBar.type="";c.store.load({params:c.storeBar})}}]})},lock:function(a,c){var b=this;Ext.Ajax.request({url:b.baseUrl+"&task=lock",params:{ids:a,from:c},method:"POST",success:function(f,e){var d=Ext.decode(f.responseText);if(d.success===true){b.store.reload()}else{CNOA.msg.alert(d.msg,function(){b.store.reload()})}},failure:function(d,e){CNOA.msg.alert(result.msg,function(){b.store.reload()})}})},status:function(b,d,a){if(b==0){return'<img src="'+CNOA_EXTJS_PATH+'/resources/images/default/tree/lock-unlock.png" align="absmiddle">'}else{if(b==1){return'<img src="'+CNOA_EXTJS_PATH+'/resources/images/default/tree/lock.png" align="absmiddle">'}}},add:function(h,g){var f=this;var e=function(i){b.getForm().load({url:f.baseUrl+"&task=loadFormData",params:{id:i},method:"POST",waitTitle:lang("waiting"),success:function(j,k){},failure:function(j,k){CNOA.msg.alert(k.result.msg,function(){})}})};var c=function(j,i){if(b.getForm().isValid()){b.getForm().submit({url:f.baseUrl+"&task=add",waitTitle:lang("waiting"),params:{from:j,id:i},method:"POST",waitMsg:lang("loading"),success:function(k,m){CNOA.msg.notice(m.result.msg,"公文管理");d.close();f.store.reload()},failure:function(k,m){CNOA.msg.alert(m.result.msg,function(){})}.createDelegate(this)})}};var a=[{xtype:"fieldset",title:lang("addDockert"),autoHeight:true,defaults:{border:false,style:"margin-bottom : 5px"},items:[{xtype:"panel",layout:"table",column:2,defaults:{border:false},items:[{xtype:"panel",layout:"form",items:[{xtype:"textfield",fieldLabel:lang("docketTitle"),width:150,name:"title",allowBlank:false}]},{xtype:"panel",layout:"form",items:[{xtype:"textfield",fieldLabel:lang("boxNo"),width:150,name:"hehao",allowBlank:false}]}]},{xtype:"panel",layout:"table",column:2,defaults:{border:false},items:[{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({fieldLabel:lang("year1"),name:"anjuandate",allowBlank:false,store:new Ext.data.SimpleStore({fields:["value","anjuandate"],data:(function(){var m=new Date().getFullYear()+1;var j=[];for(var k=0;k<20;k++){j[k]=[m,m];m--}return j})()}),width:150,hiddenName:"anjuandate",valueField:"value",displayField:"anjuandate",mode:"local",triggerAction:"all",forceSelection:true,editable:false})]},{xtype:"panel",layout:"form",items:[{xtype:"textfield",fieldLabel:lang("fondsNo"),name:"quanzonghao",width:150,allowBlank:false}]}]},{xtype:"panel",layout:"table",column:2,defaults:{border:false},items:[{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({name:"savetime",store:f.savetimeListStore,allowBlank:false,width:150,fieldLabel:lang("retentionPeriod"),hiddenName:"savetime",valueField:"id",displayField:"title",mode:"local",triggerAction:"all",forceSelection:true,editable:false})]},{xtype:"panel",layout:"form",items:[{xtype:"textfield",fieldLabel:lang("fileRoomNumber"),allowBlank:false,name:"danganshidaihao",width:150}]}]},{xtype:"panel",layout:"table",column:2,defaults:{border:false},items:[{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({name:"danganshi",store:f.roomListStore,width:150,fieldLabel:lang("fileRoom"),allowBlank:false,hiddenName:"danganshi",valueField:"id",displayField:"title",mode:"local",triggerAction:"all",forceSelection:true,editable:false})]},{xtype:"panel",layout:"form",items:[{xtype:"textfield",fieldLabel:lang("responsible"),width:150,name:"respon",allowBlank:false}]}]},{xtype:"panel",layout:"table",column:2,defaults:{border:false},items:[{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({name:"type",store:f.typeListStore,allowBlank:false,width:150,fieldLabel:lang("nameProject"),hiddenName:"type",valueField:"id",displayField:"title",mode:"local",triggerAction:"all",forceSelection:true,editable:false})]},{xtype:"panel",layout:"form",items:[{xtype:"textfield",fieldLabel:lang("page"),width:150,name:"page",allowBlank:false}]}]},{xtype:"panel",layout:"table",column:2,defaults:{border:false},items:[{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({name:"level",store:f.levelListStore,width:150,allowBlank:false,fieldLabel:lang("encryptionLevel"),hiddenName:"level",valueField:"tid",displayField:"title",mode:"local",triggerAction:"all",forceSelection:true,editable:false})]}]},{xtype:"panel",layout:"table",column:2,defaults:{border:false},items:[{xtype:"panel",layout:"form",items:[{xtype:"datefield",fieldLabel:lang("startTime"),name:"stime",format:"Y-m-d",width:150,allowBlank:false}]},{xtype:"panel",layout:"form",items:[{xtype:"datefield",fieldLabel:lang("endTime"),name:"etime",format:"Y-m-d",width:150,allowBlank:false}]}]},{xtype:"textarea",fieldLabel:lang("remark"),name:"note",width:425,height:50}]}];var b=new Ext.form.FormPanel({border:false,labelWidth:120,labelAlign:"right",region:"center",layout:"fit",waitMsgTarget:true,items:[{xtype:"panel",border:false,bodyStyle:"padding:10px",layout:"form",region:"center",autoScroll:true,items:a}]});var d=new Ext.Window({title:lang("addDocketWindow"),layout:"border",width:620,height:makeWindowHeight(435),resizable:false,modal:true,items:[b],buttons:[{text:lang("submit"),handler:function(){c(h,g)}},{text:lang("cancel"),handler:function(){d.close()}}]}).show();if(h=="edit"){e(g)}},deleteData:function(a){var b=this;Ext.Ajax.request({url:b.baseUrl+"&task=delete",params:{ids:a},method:"POST",success:function(e,d){var c=Ext.decode(e.responseText);if(c.success===true){b.store.reload()}else{CNOA.msg.alert(c.msg,function(){b.store.reload()})}},failure:function(c,d){CNOA.msg.alert(result.msg,function(){b.store.reload()})}})}};var CNOA_odoc_files_borrow,CNOA_odoc_files_borrowClass;CNOA_odoc_files_borrowClass=CNOA.Class.create();CNOA_odoc_files_borrowClass.prototype={init:function(){this.baseUrl="index.php?app=odoc&func=files&action=borrow";var i=this,m={};var h=[{name:"id"},{name:"fileid"},{name:"title"},{name:"status"},{name:"postdept"},{name:"postname"},{name:"posttime"},{name:"stime"},{name:"etime"},{name:"reason"},{name:"uFlowId"},{name:"returned"},{name:"readtimes"},{name:"approvetime"},{name:"approveuid"},{name:"approvename"}];var o={titleValue:""};this.store=new Ext.data.Store({autoLoad:true,baseParams:o,proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getJsonData",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:h})});var c=new Ext.grid.CheckboxSelectionModel(),j=function(s,u,q){var r=q.data;var p=parseInt(r.status),t="";rtText="";switch(p){case 0:t='<span style="color:#0080C0;">'+lang("beingModerate")+"</span>";break;case 1:t='<span style="color:#008040;">'+lang("approvalThrough")+"</span>";break;case 2:t='<span style="color:#FF7979;">'+lang("approvalNotThrough")+"</span>";break}switch(parseInt(r.returned)){case 0:if(r.fileid!="0"){rtText='[<span style="color:#ff0000;">'+lang("noReturn")+"</span>]"}break;case 1:rtText='[<span style="color:#0000ff;">'+lang("hasReturn1")+"</span>]";break}return(Ext.isEmpty(s)?"----":s)+"<br />"+t+rtText},e=function(u,v,r){var t=r.data;var s='<a href="javascript:void(0)" class="gridview" onclick="CNOA_odoc_files_borrow.viewFlow('+u+')">'+lang("viewProcess")+"</a>";var q=parseInt(t.status);if(q==1&&t.returned!=1&&t.fileid!="0"){s+='<br /><a href="javascript:void(0)" class="gridview" onclick="CNOA_odoc_files_borrow.viewFile('+t.fileid+')">'+lang("viewProfile")+"</a>"}var p="";if(q!=1){return s}else{if(parseInt(t.returned)==0&&t.fileid!="0"){p='&nbsp;&nbsp;&nbsp;&nbsp;<a class="gridview3" href="javascript:void(0);" onclick="CNOA_odoc_files_borrow.returnFile('+t.fileid+')">'+lang("restitution")+"</a>"}return s+p}},k=function(s,t,p){var r=p.data;var q=s+'<br /><span style="color:#808080;">'+r.postdept+"</span>";return q},b=function(s,t,p){var r=p.data;var q=s+"<br />"+r.etime;return q},n=new Ext.grid.ColumnModel({defaults:{width:100,sortable:true,menuDisabled:true},columns:[new Ext.grid.RowNumberer(),c,{header:lang("opt"),dataIndex:"uFlowId",renderer:e,width:90},{header:lang("fileTitle")+"/"+lang("approvalStatus"),dataIndex:"title",renderer:j,width:117},{header:lang("initiator")+"/"+lang("deptToPost"),dataIndex:"postname",renderer:k,width:150},{header:lang("appTime"),dataIndex:"posttime",width:115},{header:lang("borrowDate")+"/"+lang("returnTime"),renderer:b,dataIndex:"stime",width:120},{header:lang("borrowReason"),dataIndex:"reason",width:180},{header:lang("approvalor"),dataIndex:"approvename"},{header:lang("approvalTime"),dataIndex:"approvetime",width:115}]});var d=new Ext.PagingToolbar({displayInfo:true,emptyMsg:lang("pagingToolbarEmptyMsg"),displayMsg:lang("showDataTotal2"),store:this.store,pageSize:15,listeners:{beforechange:function(p,q){Ext.apply(q,m)}}});var g=new Ext.form.TextField({width:100});var a=new Ext.grid.GridPanel({stripeRows:true,region:"center",border:false,store:this.store,loadMask:{msg:lang("loading")},cm:n,sm:c,hideBorders:true,tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(p,q){i.store.reload()}},{text:lang("borrowApply"),iconCls:"icon-utils-s-add",cls:"btn-blue4",handler:function(q,p){getFlowId4Engine("filesBorrow",function(r){r()})}},{pressed:i.from=="unpass"?true:false,iconCls:"icon-doc-list",cls:"btn-red1",enableToggle:true,pressed:true,allowDepress:false,toggleGroup:"odoc_borrow_check",tooltip:lang("displayAllDocument"),text:lang("allDocumentList"),handler:function(p,q){f("all")}},{iconCls:"icon-waiting",enableToggle:true,cls:"btn-yellow1",allowDepress:false,toggleGroup:"odoc_borrow_check",tooltip:lang("displayPendingBorrow"),text:lang("beingModerate"),handler:function(p,q){f("waiting")}},{iconCls:"icon-pass",enableToggle:true,allowDepress:false,cls:"btn-blue3",toggleGroup:"odoc_borrow_check",tooltip:lang("displayDocumentApproved"),text:lang("approvalThrough"),handler:function(p,q){f("pass")}},{iconCls:"icon-noPass",enableToggle:true,allowDepress:false,toggleGroup:"odoc_borrow_check",tooltip:lang("displayWithoutApp"),text:lang("approvalNotThrough"),cls:"btn-blue3",handler:function(p,q){f("unpass")}},{iconCls:"icon-back",enableToggle:true,allowDepress:false,toggleGroup:"odoc_borrow_check",tooltip:lang("displayReturnBorrow"),cls:"btn-blue3",text:lang("hasReturn1"),handler:function(p,q){f("return")}},{iconCls:"icon-noReturn",enableToggle:true,allowDepress:false,toggleGroup:"odoc_borrow_check",cls:"btn-gray1",tooltip:lang("displayUnreturn"),text:lang("noReturn"),handler:function(p,q){f("unreturn")}},lang("title")+"：",g,{xtype:"button",text:lang("search"),style:"margin-left:5px",handler:function(){o.titleValue=g.getValue();i.store.reload()}},{xtype:"button",text:lang("clear"),handler:function(){g.setValue();o.titleValue="";i.store.reload()}},"->",{xtype:"cnoa_helpBtn",helpid:4002}],bbar:d});var f=function(p){m.storeType=p;i.store.load({params:m})};this.mainPanel=a},viewFlow:function(a){getFlowId4Engine("filesBorrow",function(c,b){b(a)})},viewFile:function(a){CNOA_odoc_viewFiles=new CNOA_odoc_viewFilesClass(a,this.baseUrl)},returnFile:function(a){var b=this;CNOA.msg.cf(lang("doYouReturnFile"),function(c){if(c=="yes"){Ext.Ajax.request({url:b.baseUrl+"&task=returnFile",method:"POST",params:{fileId:a},success:function(e){var d=Ext.decode(e.responseText);if(d.success===true){b.store.reload()}CNOA.msg.notice2(d.msg)}})}})}};var CNOA_odoc_files_brwchk,CNOA_odoc_files_brwchkClass;CNOA_odoc_files_brwchkClass=CNOA.Class.create();CNOA_odoc_files_brwchkClass.prototype={init:function(){var h=this;var b=Ext.id();var a=Ext.id();var f=Ext.id();var c=Ext.id();var d=Ext.id();var g=Ext.id();var e=Ext.id();this.baseUrl="index.php?app=odoc&func=files&action=brwchk";this.storeBar={storeType:"waiting",title:"",number:"",type:"",level:"",hurry:""};this.fields=[{name:"id"},{name:"fileid"},{name:"title"},{name:"status"},{name:"number"},{name:"type"},{name:"type1"},{name:"level"},{name:"wenzhong"},{name:"danganshi"},{name:"anjuan"},{name:"anjuandate"},{name:"filesnum"},{name:"page"},{name:"reader"},{name:"stime"},{name:"etime"},{name:"deptment"},{name:"posttime"},{name:"senddate"},{name:"reason"}];this.store=new Ext.data.Store({autoLoad:true,proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getJsonData",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields}),listeners:{exception:function(o,n,p,m,k,j){var i=Ext.decode(k.responseText);if(i.failure){CNOA.msg.alert(i.msg)}}}});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.pagingBar=new Ext.PagingToolbar({displayInfo:true,emptyMsg:lang("pagingToolbarEmptyMsg"),displayMsg:lang("showDataTotal2"),store:this.store,pageSize:15,listeners:{beforechange:function(i,j){Ext.apply(j,h.storeBar)}}});this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),this.sm,{header:"id",dataIndex:"id",hidden:true},{header:lang("opt"),dataIndex:"fileid",width:80,sortable:true,menuDisabled:true,renderer:this.operate.createDelegate(this)},{header:lang("type"),dataIndex:"type",width:80,sortable:true,menuDisabled:true},{header:lang("encryptionLevel"),dataIndex:"level",width:80,sortable:true,menuDisabled:true},{header:lang("docketTitle"),dataIndex:"title",width:120,sortable:true,menuDisabled:true},{header:lang("jieYueDept"),dataIndex:"deptment",width:140,sortable:true,menuDisabled:true},{header:lang("people1"),dataIndex:"reader",width:80,sortable:true,menuDisabled:true},{header:lang("submitTime"),dataIndex:"posttime",width:100,sortable:true,menuDisabled:true},{header:lang("documenDate"),dataIndex:"senddate",width:100,sortable:true,menuDisabled:true},{header:lang("startTime"),dataIndex:"stime",width:100,sortable:true,menuDisabled:true},{header:lang("endTime"),dataIndex:"etime",width:100,sortable:true,menuDisabled:true},{header:lang("fileRoom"),dataIndex:"danganshi",width:100,sortable:true,menuDisabled:true},{header:lang("category"),dataIndex:"type1",width:100,sortable:true,menuDisabled:true},{header:lang("docket"),dataIndex:"anjuan",width:80,sortable:true,menuDisabled:true},{header:lang("wenType"),dataIndex:"wenzhong",width:80,sortable:true,menuDisabled:true},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.grid=new Ext.grid.GridPanel({stripeRows:true,region:"center",layout:"fit",border:false,trackMouseOver:false,disableSelection:true,autoScroll:true,store:this.store,loadMask:{msg:lang("loading")},cm:this.colModel,sm:this.sm,hideBorders:true,viewConfig:{forceFit:true,enableRowBody:true,showPreview:true,getRowClass:function(i,m,k,j){if(this.showPreview){k.body='<div style="padding-left:45px;" class="cnoa_color_gray"><div style=" width:60px; float:left">借阅原因: </div><div style="width:700px; float:left;">'+i.data.reason+"</div></div>"}}},tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(i,j){h.store.reload()}},{handler:function(i,j){h.storeBar.storeType="waiting";h.store.load({params:h.storeBar});Ext.getCmp(g).show();Ext.getCmp(e).show()}.createDelegate(this),iconCls:"icon-roduction",enableToggle:true,pressed:true,allowDepress:false,toggleGroup:"meeting_room_check",tooltip:lang("displayDocApp"),text:lang("pendingApproval")},{handler:function(i,j){h.storeBar.storeType="pass";h.store.load({params:h.storeBar});Ext.getCmp(g).hide();Ext.getCmp(e).hide()}.createDelegate(this),iconCls:"icon-roduction",enableToggle:true,allowDepress:false,toggleGroup:"meeting_room_check",tooltip:lang("displayAppDoc"),text:lang("hasBeApp")},{handler:function(i,j){var k=h.grid.getSelectionModel().getSelections();if(k.length==0){CNOA.miniMsg.alertShowAt(i,lang("noSelect"))}else{CNOA.miniMsg.cfShowAt(i,lang("sureWantAgree"),function(){if(k){var n="";for(var m=0;m<k.length;m++){n+=k[m].get("id")+","}h.submit(n,"agree")}})}}.createDelegate(this),id:g,iconCls:"icon-dialog-ok-apply",text:lang("agree")},{handler:function(i,j){var k=h.grid.getSelectionModel().getSelections();if(k.length==0){CNOA.miniMsg.alertShowAt(i,lang("noSelect"))}else{CNOA.miniMsg.cfShowAt(i,lang("wantDisagree"),function(){if(k){var n="";for(var m=0;m<k.length;m++){n+=k[m].get("id")+","}h.submit(n,"disagree")}})}}.createDelegate(this),id:e,iconCls:"icon-order-s-close",text:lang("disagree")},"->",{xtype:"cnoa_helpBtn",helpid:4002}],bbar:this.pagingBar});this.mainPanel=new Ext.Panel({collapsible:false,hideBorders:true,border:false,layout:"border",autoScroll:false,items:[this.grid]})},submit:function(b,a){var c=this;Ext.Ajax.request({url:c.baseUrl+"&task=submit",params:{ids:b,from:a},method:"POST",success:function(f,e){var d=Ext.decode(f.responseText);if(d.success===true){c.store.reload()}else{CNOA.msg.alert(d.msg,function(){c.store.reload()})}},failure:function(d,e){CNOA.msg.alert(result.msg,function(){c.store.reload()})}})},operate:function(d){var f=this;var c=f.baseUrl;var b=(screen.availWidth-850);var e=(screen.availHeight-600);var a='window.open("'+c+"&task=view&act=getHtml&id="+d+'", "", "width=890,height=500,left='+b+",top="+e+',scrollbars=yes,resizable=yes,status=no");';return"<a href='javascript:void(0)' onclick='"+a+"'>"+lang("viewProfile")+"</a>"}};var CNOA_odoc_files_clean,CNOA_odoc_files_cleanClass;CNOA_odoc_files_cleanClass=CNOA.Class.create();CNOA_odoc_files_cleanClass.prototype={init:function(){var a=this;this.ID_anJuan=Ext.id();this.baseUrl="index.php?app=odoc&func=files&action=clean";Ext.Ajax.request({url:a.baseUrl+"&task=loadColumn",method:"POST",success:function(c){var b=Ext.decode(c.responseText);if(b.success===true){a.layoutPanel(b)}else{CNOA.msg.alert(b.msg,function(){})}}})},layoutPanel:function(i){var e=this;var c=Ext.id();var a=Ext.id();var b=Ext.id();var d=Ext.id();var f=Ext.id();var g=Ext.id();var h=Ext.id();this.select={room:"",year:""};this.storeBar={storeType:"send",title:"",number:"",type:"",level:"",stime:"",etime:""};this.smSend=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.cmSend=[new Ext.grid.RowNumberer(),this.smSend,{header:lang("opt"),sortable:true,dataIndex:"id",width:140,menuDisabled:true,renderer:function(m,o,k){var n=k.data;var j="";j+='<a href="javascript:void(0)" class="gridview" onclick="CNOA_odoc_files_clean.viewFlow('+n.uFlowId+')">'+lang("viewProcess")+"</a>";return j}},{header:lang("addTime"),sortable:true,dataIndex:"posttime",width:100,menuDisabled:true}];this.fieldSend=[{name:"id"},{name:"posttime"},{name:"status"},{name:"uFlowId"}];Ext.each(i.column.send,function(j,k){e.fieldSend.push({name:"field_"+j.field});e.cmSend.push({header:j.title,sortable:true,dataIndex:"field_"+j.field,width:j.width,menuDisabled:true})});this.typeListStore=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:e.baseUrl+"&task=getTypeList"}),reader:new Ext.data.JsonReader({root:"data",fields:[{name:"tid"},{name:"title"}]})});this.typeListStore.load();this.levelListStore=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:e.baseUrl+"&task=getLevelList"}),reader:new Ext.data.JsonReader({root:"data",fields:[{name:"tid"},{name:"title"}]})});this.levelListStore.load();this.roomListStore=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:e.baseUrl+"&task=getRoomList"}),reader:new Ext.data.JsonReader({root:"data",fields:[{name:"id"},{name:"title"}]})});this.roomListStore.load();this.anJuanListStore=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:e.baseUrl+"&task=getAnjuanList"}),reader:new Ext.data.JsonReader({root:"data",fields:[{name:"id"},{name:"title"}]})});this.wenzhongListStore=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:e.baseUrl+"&task=getWenzhongList"}),reader:new Ext.data.JsonReader({root:"data",fields:[{name:"id"},{name:"title"}]})});this.wenzhongListStore.load();this.storeSend=new Ext.data.Store({autoLoad:true,proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getJsonData&from=send",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fieldSend})});this.storeSend.load({params:{from:"send"}});this.pagingBar=new Ext.PagingToolbar({displayInfo:true,emptyMsg:lang("pagingToolbarEmptyMsg"),displayMsg:lang("showDataTotal2"),store:this.storeSend,pageSize:15,listeners:{beforechange:function(j,k){Ext.apply(k,e.storeBar)}}});this.gridSend=new Ext.grid.GridPanel({stripeRows:true,region:"center",border:false,store:this.storeSend,loadMask:{msg:lang("loading")},columns:this.cmSend,sm:this.smSend,hideBorders:true,bbar:this.pagingBar});this.smReceive=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.cmReceive=[new Ext.grid.RowNumberer(),this.smReceive,{header:lang("opt"),sortable:true,dataIndex:"id",width:140,menuDisabled:true,renderer:function(m,o,k){var n=k.data;var j="";j+='<a href="javascript:void(0)" class="gridview" onclick="CNOA_odoc_files_clean.viewFlow('+n.uFlowId+')">'+lang("viewProcess")+"</a>";return j}},{header:lang("addTime"),sortable:true,dataIndex:"posttime",width:100,menuDisabled:true},{header:lang("agency"),sortable:true,dataIndex:"deptment",width:100,menuDisabled:true},{header:lang("title1"),sortable:true,dataIndex:"title",width:100,menuDisabled:true},{header:lang("number1"),sortable:true,dataIndex:"number",width:100,menuDisabled:true}];this.fieldSend=[{name:"id"},{name:"posttime"},{name:"status"},{name:"uFlowId"},{name:"deptment"},{name:"title"},{name:"number"}];Ext.each(i.column.receive,function(j,k){e.fieldSend.push({name:"field_"+j.field});e.cmReceive.push({header:j.title,sortable:true,dataIndex:"field_"+j.field,width:j.width,menuDisabled:true})});this.storeReceive=new Ext.data.Store({autoLoad:true,proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getJsonData&from=receive",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fieldSend})});this.storeReceive.load({params:{from:"receive"}});this.gridReceive=new Ext.grid.GridPanel({stripeRows:true,region:"center",border:false,store:this.storeReceive,loadMask:{msg:lang("loading")},columns:this.cmReceive,sm:this.smReceive,hideBorders:true,bbar:this.pagingBar});this.secondPanel=new Ext.Panel({collapsible:false,hideBorders:true,border:false,region:"center",layout:"card",autoScroll:false,activeItem:0,items:[this.gridSend,this.gridReceive],tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(j,k){e.storeReceive.reload();e.storeSend.reload()}},{handler:function(j,k){e.add("add",0)}.createDelegate(this),iconCls:"icon-record2",cls:"btn-red1",text:lang("recording")},{handler:function(k,n){if(e.storeBar.storeType=="receive"){var o=e.gridReceive.getSelectionModel().getSelections()}else{var o=e.gridSend.getSelectionModel().getSelections()}if(o.length==0){CNOA.miniMsg.alertShowAt(k,lang("notSelectArchived"))}else{var m="";for(var j=0;j<o.length;j++){m+=o[j].get("id")+","}e.collect(m)}}.createDelegate(this),cls:"btn-yellow1",iconCls:"icon-folder--plus",text:lang("archive")},{handler:function(j,k){e.deleteList(j,e.storeBar.storeType)}.createDelegate(this),iconCls:"icon-utils-s-delete",text:lang("del")},{handler:function(j,k){e.storeBar.storeType="send";e.secondPanel.layout.setActiveItem(0)}.createDelegate(this),iconCls:"icon-doc-list",pressed:true,enableToggle:true,allowDepress:false,toggleGroup:"meeting_room_check",tooltip:lang("displayDocList"),cls:"btn-blue4",text:lang("issuedDocList")},{handler:function(j,k){e.storeBar.storeType="receive";e.secondPanel.layout.setActiveItem(1)}.createDelegate(this),iconCls:"icon-doc-list",enableToggle:true,allowDepress:false,toggleGroup:"meeting_room_check",tooltip:lang("displayListReceipt"),cls:"btn-blue3",text:lang("receiptList")}]});this.mainPanel=new Ext.Panel({collapsible:false,hideBorders:true,border:false,layout:"border",autoScroll:false,items:[this.secondPanel],tbar:[lang("title")+":",{xtype:"textfield",width:100,id:c},lang("wenhao")+":",{xtype:"textfield",width:100,id:a},lang("sort")+":",new Ext.form.ComboBox({name:"title",store:e.typeListStore,width:100,id:d,hiddenName:"tid",valueField:"tid",displayField:"title",mode:"local",triggerAction:"all",forceSelection:true,editable:false}),lang("encryptionLevel")+": ",new Ext.form.ComboBox({name:"title",store:e.levelListStore,width:100,id:f,hiddenName:"tid",valueField:"tid",displayField:"title",mode:"local",triggerAction:"all",forceSelection:true,editable:false}),lang("startDate"),{xtype:"datefield",format:"Y-m-d",id:g,width:100},lang("endDate"),{xtype:"datefield",format:"Y-m-d",id:h,width:100},{xtype:"button",text:lang("search"),style:"margin-left:5px",handler:function(){e.storeBar.title=Ext.getCmp(c).getValue();e.storeBar.number=Ext.getCmp(a).getValue();e.storeBar.type=Ext.getCmp(d).getValue();e.storeBar.level=Ext.getCmp(f).getValue();e.storeBar.stime=Ext.getCmp(g).getRawValue();e.storeBar.etime=Ext.getCmp(h).getRawValue();e.storeSend.load({params:e.storeBar})}},{xtype:"button",text:lang("clear"),handler:function(){Ext.getCmp(c).setValue("");Ext.getCmp(a).setValue("");Ext.getCmp(d).setValue("");Ext.getCmp(f).setValue("");Ext.getCmp(g).setValue("");Ext.getCmp(h).setValue("");e.storeBar.title="";e.storeBar.number="";e.storeBar.type="";e.storeBar.level="";e.storeBar.stime="";e.storeBar.etime="";e.storeSend.load({params:e.storeBar})}}]});Ext.getCmp(CNOA.odoc.files.clean.parentID).add(this.mainPanel);Ext.getCmp(CNOA.odoc.files.clean.parentID).doLayout()},deleteList:function(a,b){var d=this;var c=d.gridSend.getSelectionModel().getSelections();if(c.length==0){CNOA.miniMsg.alertShowAt(a,lang("mustSelectOneRow"))}else{CNOA.msg.cf(lang("confirmToDelete"),function(f){if(f=="yes"){if(c){var g="";var h="";for(var e=0;e<c.length;e++){var h=c[e];var j=parseInt(h.get("id"));g+=j+","}d.deleteData(g,b)}}})}},deleteData:function(a,b){var c=this;Ext.Ajax.request({url:c.baseUrl+"&task=delete",method:"POST",params:{ids:a,fromType:b},success:function(e){var d=Ext.decode(e.responseText);if(d.success===true){CNOA.msg.notice(d.msg,lang("docMgr"));c.storeSend.reload();c.storeReceive.reload()}else{CNOA.msg.alert(d.msg)}}})},viewFlow:function(a){mainPanel.closeTab("CNOA_MENU_WF_USE_OPENFLOW");mainPanel.loadClass(this.baseUrl+"&task=loadpage&from=viewflow&uFlowId="+a,"CNOA_MENU_WF_USE_OPENFLOW",lang("viewFlow"),"icon-flow")},add:function(b,h){var g=this;var f=function(){c.getForm().load({url:g.baseUrl+"&task=loadFileFormData",params:{id:h},method:"POST",waitTitle:lang("waiting"),success:function(i,j){g.anjuanid=j.result.data.anjuan;g.anJuanListStore.load({params:j.result.data.year})},failure:function(i,j){CNOA.msg.alert(j.result.msg,function(){})}})};var d=function(){if(c.getForm().isValid()){c.getForm().submit({url:g.baseUrl+"&task=add",waitTitle:lang("waiting"),method:"POST",params:{storeType:g.storeBar.storeType,id:h},waitMsg:lang("loading"),success:function(i,j){CNOA.msg.notice(j.result.msg,"公文管理");e.close();g.storeSend.reload();g.storeReceive.reload()},failure:function(i,j){CNOA.msg.alert(j.result.msg,function(){})}.createDelegate(this)})}};var a=[{xtype:"fieldset",title:lang("recordInformation"),autoHeight:true,defaults:{border:false,style:"margin-bottom : 5px"},items:[{xtype:"panel",layout:"table",column:2,defaults:{border:false},items:[{xtype:"panel",layout:"form",items:[{xtype:"textfield",fieldLabel:lang("fileTitle"),width:150,name:"title",allowBlank:false}]},{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({fieldLabel:lang("encryptionLevel")+"2",name:"level",store:g.levelListStore,width:150,allowBlank:false,hiddenName:"level",valueField:"tid",displayField:"title",mode:"local",triggerAction:"all",forceSelection:true,editable:false})]}]},{xtype:"panel",layout:"table",column:2,defaults:{border:false},items:[{xtype:"panel",layout:"form",items:[{xtype:"textfield",fieldLabel:lang("partNo"),width:150,name:"filesnum",allowBlank:false}]},{xtype:"panel",layout:"form",items:[{xtype:"textfield",fieldLabel:lang("fileSize"),name:"number",width:150,allowBlank:false}]}]},{xtype:"panel",layout:"table",column:2,defaults:{border:false},items:[{xtype:"panel",layout:"form",items:[{xtype:"datefield",fieldLabel:lang("documenDate"),name:"senddate",format:"Y-m-d",width:150,allowBlank:false}]},{xtype:"panel",layout:"form",items:[{xtype:"textfield",fieldLabel:lang("responsible"),width:150,name:"respon",value:CNOA_USER_TRUENAME}]}]},{xtype:"panel",layout:"table",column:2,defaults:{border:false},items:[{xtype:"panel",layout:"form",items:[{xtype:"textfield",fieldLabel:lang("pageNum"),name:"page",width:150}]},{xtype:"panel",layout:"form",items:[{xtype:"datefield",fieldLabel:lang("filingDate"),name:"collectdate",format:"Y-m-d",width:150,allowBlank:false}]}]},{xtype:"panel",layout:"table",column:2,defaults:{border:false},items:[{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({name:"room",store:g.roomListStore,width:150,fieldLabel:lang("fileRoom"),hiddenName:"room",valueField:"id",displayField:"title",mode:"local",triggerAction:"all",forceSelection:true,editable:false,allowBlank:false,listeners:{select:function(k,i,j){c.getForm().findField("anjuan").setValue("");g.select.room=i.id;g.anJuanListStore.load({params:g.select.room})}}})]},{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({name:"wenzhong",store:g.wenzhongListStore,width:150,fieldLabel:lang("wenType"),hiddenName:"wenzhong",valueField:"id",displayField:"title",mode:"local",triggerAction:"all",forceSelection:true,editable:false,allowBlank:false})]}]},{xtype:"panel",layout:"table",column:2,defaults:{border:false},items:[{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({fieldLabel:lang("year1"),name:"year",store:new Ext.data.SimpleStore({fields:["value","year"],data:(function(){var m=new Date().getFullYear()+1;var j=[];for(var k=0;k<20;k++){j[k]=[m,m];m--}return j})()}),width:150,hiddenName:"year",valueField:"value",displayField:"year",mode:"local",triggerAction:"all",forceSelection:true,editable:false,regex:/^\+?[1-9][0-9]*$/i,regexText:lang("mustBeInt"),allowBlank:false,listeners:{select:function(k,i,j){c.getForm().findField("anjuan").setValue("");g.select.year=i.data.value;g.anJuanListStore.load({params:g.select.year})}}})]},{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({id:g.ID_anJuan,name:"anjuan",store:g.anJuanListStore,width:150,fieldLabel:lang("docket"),hiddenName:"anjuan",valueField:"id",displayField:"title",mode:"local",triggerAction:"all",forceSelection:true,editable:false,allowBlank:false})]}]},{xtype:"flashfile",fieldLabel:lang("addAttach"),style:"margin-top:5px;",inputPre:"filesUpload",name:"attach"},{xtype:"textarea",fieldLabel:lang("remark"),width:385,height:50,name:"note"}]}];var c=new Ext.form.FormPanel({border:false,labelWidth:80,labelAlign:"right",region:"center",layout:"fit",waitMsgTarget:true,items:[{xtype:"panel",border:false,bodyStyle:"padding:10px",layout:"form",region:"center",autoScroll:true,items:a}]});var e=new Ext.Window({title:lang("recordWindow"),layout:"border",width:550,height:makeWindowHeight(440),resizable:false,modal:true,items:[c],buttons:[{text:lang("submit"),handler:function(){d()}},{text:lang("cancel"),handler:function(){e.close()}}]}).show();if(b=="edit"){f()}},collect:function(b){var g=this;var d=function(h){if(c.getForm().isValid()){c.getForm().submit({url:g.baseUrl+"&task=collect",waitTitle:lang("waiting"),params:{ids:h,storeType:g.storeBar.storeType},method:"POST",waitMsg:lang("loading"),success:function(i,j){CNOA.msg.notice(j.result.msg,lang("docMgr"));e.close();g.storeSend.reload();g.storeReceive.reload()},failure:function(i,j){CNOA.msg.alert(j.result.msg,function(){})}.createDelegate(this)})}};var f=function(i,h){c.getForm().load({url:g.baseUrl+"&task=loadFormData",params:{ids:i,storeType:h},method:"POST",waitTitle:lang("waiting"),success:function(j,k){},failure:function(j,k){CNOA.msg.alert(k.result.msg,function(){})}})};var a=[{xtype:"fieldset",title:lang("archivedInformation"),autoHeight:true,defaults:{border:false,style:"margin-bottom : 5px"},items:[{xtype:"panel",layout:"table",column:2,defaults:{border:false},items:[{xtype:"panel",layout:"form",items:[{xtype:"textfield",fieldLabel:lang("fileTitle"),width:150,name:"title"}]},{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({fieldLabel:lang("filetype"),store:new Ext.data.SimpleStore({fields:["value","text"],data:[["0",lang("other")],["1",lang("docSend")],["2",lang("receiveDoc")]]}),width:150,valueField:"value",displayField:"text",mode:"local",triggerAction:"all",forceSelection:true,editable:false,hiddenName:"type",name:"name"})]}]},{xtype:"panel",layout:"table",column:2,defaults:{border:false},items:[{xtype:"panel",layout:"form",items:[{xtype:"textfield",fieldLabel:lang("documenDate"),name:"senddate",width:150}]},{xtype:"panel",layout:"form",items:[{xtype:"textfield",fieldLabel:lang("fileSize"),width:150,name:"number"}]}]},{xtype:"panel",layout:"table",column:2,defaults:{border:false},items:[{xtype:"panel",layout:"form",items:[{xtype:"textfield",fieldLabel:lang("filingDate"),width:150,name:"guidangdate"}]},{xtype:"panel",layout:"form",items:[{xtype:"textfield",fieldLabel:lang("responsible"),width:150,name:"respon",value:CNOA_USER_TRUENAME}]}]},{xtype:"panel",layout:"table",column:2,defaults:{border:false},items:[{xtype:"panel",layout:"form",items:[{xtype:"textfield",fieldLabel:lang("pageNum"),width:150,name:"page"}]},{xtype:"panel",layout:"form",items:[{xtype:"textfield",fieldLabel:lang("partNo"),name:"filesnum",width:150}]}]},{xtype:"panel",layout:"table",column:2,defaults:{border:false},items:[{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({name:"room",store:g.roomListStore,width:150,fieldLabel:lang("fileRoom"),hiddenName:"room",valueField:"id",displayField:"title",mode:"local",triggerAction:"all",forceSelection:true,editable:false,allowBlank:false,listeners:{select:function(j,h,i){c.getForm().findField("anjuan").setValue("");g.select.room=h.id;g.anJuanListStore.load({params:g.select.room})}}})]},{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({name:"wenzhong",store:g.wenzhongListStore,width:150,fieldLabel:lang("wenType"),hiddenName:"wenzhong",valueField:"id",displayField:"title",mode:"local",triggerAction:"all",forceSelection:true,editable:false,allowBlank:false})]}]},{xtype:"panel",layout:"table",column:2,defaults:{border:false},items:[{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({fieldLabel:lang("year1"),name:"anjuandate",store:new Ext.data.SimpleStore({fields:["value","anjuandate"],data:(function(){var k=new Date().getFullYear()+1;var h=[];for(var j=0;j<20;j++){h[j]=[k,k];k--}return h})()}),width:150,hiddenName:"anjuandate",valueField:"value",displayField:"anjuandate",mode:"local",triggerAction:"all",forceSelection:true,editable:false,allowBlank:false,listeners:{select:function(j,h,i){c.getForm().findField("anjuan").setValue("");g.select.year=h.data.value;g.anJuanListStore.load({params:g.select})}}})]},{xtype:"panel",layout:"form",items:[new Ext.form.ComboBox({name:"anjuan",store:g.anJuanListStore,width:150,fieldLabel:lang("docket"),hiddenName:"anjuan",valueField:"id",displayField:"title",mode:"local",triggerAction:"all",forceSelection:true,editable:false,allowBlank:false})]}]},new Ext.BoxComponent({autoEl:{tag:"div",style:"margin-left:80px;margin-top:5px;margin-bottom:5px;color:#676767;",html:lang("noteTheDocket")}})]}];var c=new Ext.form.FormPanel({border:false,labelWidth:80,labelAlign:"right",region:"center",layout:"fit",waitMsgTarget:true,items:[{xtype:"panel",border:false,bodyStyle:"padding:10px",layout:"form",region:"center",autoScroll:true,items:a}]});var e=new Ext.Window({title:lang("archiveWin"),layout:"border",width:550,height:380,resizable:false,modal:true,items:c,buttons:[{text:lang("confirm"),handler:function(){d(b)}},{text:lang("cancel"),handler:function(){e.close()}}]}).show();f(b,g.storeBar.storeType)},viewFlow:function(a){mainPanel.closeTab("CNOA_MENU_WF_USE_OPENFLOW");mainPanel.loadClass(this.baseUrl+"&task=loadpage&from=viewflow&uFlowId="+a,"CNOA_MENU_WF_USE_OPENFLOW",lang("viewFlow"),"icon-flow")}};var CNOA_odoc_files_dananmgr,CNOA_odoc_files_dananmgrClass;CNOA_odoc_files_dananmgrClass=CNOA.Class.create();CNOA_odoc_files_dananmgrClass.prototype={init:function(){var f=this;var d=Ext.id();var b=Ext.id();var c=Ext.id();var e=Ext.id();var g=Ext.id();var h=Ext.id();var i=Ext.id();var a=Ext.id();this.ID_BTN_SAVE=Ext.id();this.baseUrl="index.php?app=odoc&func=files&action=dananmgr";this.storeBar={storeType:"all",title:"",number:"",sort:"",type:"",level:"",stime:"",etime:""};this.fields=[{name:"id"},{name:"title"},{name:"number"},{name:"type"},{name:"level"},{name:"hurry"},{name:"from"},{name:"senddate"},{name:"danganshi"},{name:"anjuan"},{name:"fileid"}];this.roomStore=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:f.baseUrl+"&task=roomList"}),reader:new Ext.data.JsonReader({root:"data",fields:[{name:"id"},{name:"title"}]})});this.roomStore.load();this.anjuanStore=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:f.baseUrl+"&task=anjuanList"}),reader:new Ext.data.JsonReader({root:"data",fields:[{name:"id"},{name:"title"}]})});this.store=new Ext.data.Store({autoLoad:true,proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getJsonData",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields}),listeners:{exception:function(p,o,q,n,m,k){var j=Ext.decode(m.responseText);if(j.failure){CNOA.msg.alert(j.msg)}}}});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.pagingBar=new Ext.PagingToolbar({displayInfo:true,emptyMsg:lang("pagingToolbarEmptyMsg"),displayMsg:lang("showDataTotal2"),store:this.store,pageSize:15,listeners:{beforechange:function(j,k){Ext.apply(k,f.storeBar)}}});this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),this.sm,{header:"id",dataIndex:"id",hidden:true},{header:lang("filetype"),dataIndex:"from",width:80,sortable:true,menuDisabled:true},{header:lang("title"),dataIndex:"title",width:150,sortable:true,menuDisabled:true},{header:lang("fileSize"),dataIndex:"number",width:100,sortable:true,menuDisabled:true},{header:lang("documenDate"),dataIndex:"senddate",width:80,sortable:true,menuDisabled:true},{header:lang("whereFileRoom"),dataIndex:"danganshi",width:80,sortable:true,menuDisabled:true},{header:lang("whereDocket"),dataIndex:"anjuan",width:80,sortable:true,menuDisabled:true},{header:lang("opt"),dataIndex:"fileid",width:120,sortable:true,menuDisabled:true,renderer:this.operate.createDelegate(this)},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.grid=new Ext.grid.GridPanel({stripeRows:true,region:"center",border:false,store:this.store,loadMask:{msg:lang("loading")},cm:this.colModel,sm:this.sm,hideBorders:true,bbar:this.pagingBar});this.mainPanel=new Ext.Panel({collapsible:false,hideBorders:true,border:false,layout:"border",autoScroll:false,items:[this.grid],tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(j,k){f.store.reload()}},lang("title")+": ",{xtype:"textfield",width:100,id:d},lang("wenhao")+": ",{xtype:"textfield",width:100,id:b},lang("type")+": ",new Ext.form.ComboBox({name:"sort",store:new Ext.data.SimpleStore({fields:["value","title"],data:[["1",lang("docSend")],["2",lang("receiveDoc")],["3","录著"]]}),width:60,hiddenName:"sort",id:c,valueField:"value",displayField:"title",mode:"local",triggerAction:"all",forceSelection:true,editable:false,listeners:{}}),lang("fileRoom")+": ",new Ext.form.ComboBox({name:"title",store:f.roomStore,width:100,id:e,hiddenName:"id",valueField:"id",displayField:"title",mode:"local",triggerAction:"all",forceSelection:true,editable:false,listeners:{select:function(m,j,k){Ext.getCmp(g).setValue("");f.anjuanStore.load({params:{id:j.id}})}}}),lang("docket")+": ",new Ext.form.ComboBox({name:"title",store:f.anjuanStore,width:100,id:g,hiddenName:"id",valueField:"id",displayField:"title",mode:"local",triggerAction:"all",forceSelection:true,editable:false}),lang("startDate"),{xtype:"datefield",format:"Y-m-d",id:h,width:100},lang("endDate"),{xtype:"datefield",format:"Y-m-d",id:i,width:100},{xtype:"button",text:lang("search"),style:"margin-left:5px",handler:function(){f.storeBar.title=Ext.getCmp(d).getValue();f.storeBar.number=Ext.getCmp(b).getValue();f.storeBar.sort=Ext.getCmp(c).getValue();f.storeBar.type=Ext.getCmp(e).getValue();f.storeBar.level=Ext.getCmp(g).getValue();f.storeBar.stime=Ext.getCmp(h).getRawValue();f.storeBar.etime=Ext.getCmp(i).getRawValue();f.store.load({params:f.storeBar})}},{xtype:"button",text:lang("clear"),handler:function(){Ext.getCmp(d).setValue("");Ext.getCmp(b).setValue("");Ext.getCmp(c).setValue("");Ext.getCmp(e).setValue("");Ext.getCmp(g).setValue("");Ext.getCmp(h).setValue("");Ext.getCmp(i).setValue("");f.storeBar.title="";f.storeBar.number="";f.storeBar.sort="";f.storeBar.type="";f.storeBar.level="";f.storeBar.stime="";f.storeBar.etime="";f.store.load({params:f.storeBar})}}]})},operate:function(e,c,a,h,b,d){var g=this;if(g.storeBar.storeType=="history"){return"<a class='gridview' href='javascript:void(0)' onclick='CNOA_odoc_files_dananmgr.newSplit("+e+', "view")\'>'+lang("viewSentSeparately")+"</a>"}else{var f=a.data.id;return"<a class='gridview' href='javascript:void(0)' onclick='CNOA_odoc_files_dananmgr.viewOdocFiles("+f+");'>"+lang("viewProfile")+"</a>"}},viewOdocFiles:function(a){CNOA_odoc_viewFiles=new CNOA_odoc_viewFilesClass(a,this.baseUrl)}};var CNOA_odoc_files_setting,CNOA_odoc_files_settingClass;CNOA_odoc_files_settingClass=CNOA.Class.create();CNOA_odoc_files_settingClass.prototype={init:function(){var b=this;var a=Ext.id();this.baseUrl="index.php?app=odoc&func=files&action=setting";this.storeBar={from:"room"};this.dsc=Ext.data.Record.create([{name:"title",type:"string"}]);this.fields=[{name:"id"},{name:"title"},{name:"postname"},{name:"order"}];this.store=new Ext.data.GroupingStore({autoLoad:true,proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getJsonData"}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields}),listeners:{update:function(f,c,e){var d=c.data;if(e==Ext.data.Record.EDIT){d.from=b.storeBar.from;b.submit(d)}}}});this.pagingBar=new Ext.PagingToolbar({displayInfo:true,emptyMsg:lang("pagingToolbarEmptyMsg"),displayMsg:lang("showDataTotal2"),store:this.store,pageSize:15,listeners:{beforechange:function(c,d){Ext.apply(d,b.storeBar)}}});this.editor=new Ext.ux.grid.RowEditor({cancelText:lang("cancel"),saveText:lang("update"),errorSummary:false});this.sm=new Ext.grid.CheckboxSelectionModel({});this.cm=[new Ext.grid.RowNumberer(),this.sm,{header:"",dataIndex:"id",hidden:true},{header:lang("fileRoomName"),dataIndex:"title",width:300,sortable:false,editor:{xtype:"textfield",allowBlank:false}},{header:lang("order"),dataIndex:"order",width:100,sortable:false,editor:{xtype:"textfield",allowBlank:true,regex:/^\+?[1-9][0-9]*$/i,regexText:lang("mustBeInt")}},{header:lang("posters"),dataIndex:"postname",width:80,sortable:false}];this.grid=new Ext.grid.GridPanel({stripeRows:true,store:this.store,plain:false,loadMask:{msg:lang("loading")},region:"center",border:false,autoScroll:true,plugins:[this.editor],columns:this.cm,sm:this.sm,view:new Ext.grid.GroupingView({markDirty:false}),listeners:{cellclick:function(c,g,f,d){if(f==1){return false}}},tbar:[{handler:function(c,d){b.store.reload()}.createDelegate(this),iconCls:"icon-system-refresh",text:lang("refresh")},{handler:function(c,d){var f=new b.dsc({name:""});b.editor.stopEditing();b.store.insert(0,f);b.grid.getView().refresh();b.grid.getSelectionModel().selectRow(0);b.editor.startEditing(0)}.createDelegate(this),iconCls:"icon-utils-s-add",cls:"btn-blue4",text:lang("add")},{text:lang("del"),iconCls:"icon-utils-s-delete",handler:function(c,d){var e=b.grid.getSelectionModel().getSelections();if(e.length==0){CNOA.miniMsg.alertShowAt(c,lang("mustSelectOneRow"))}else{CNOA.miniMsg.cfShowAt(c,lang("wantDelRecord"),function(){if(e){var g="";for(var f=0;f<e.length;f++){g+=e[f].get("id")+","}b.deleteData(g)}})}}},"<span class='cnoa_color_gray'>"+lang("doubleClickEdit")+"</span>","->",{xtype:"cnoa_helpBtn",helpid:5002}],bbar:this.pagingBar});this.mainPanel=new Ext.Panel({collapsible:false,hideBorders:true,border:false,layout:"border",autoScroll:false,items:[this.grid],tbar:[{text:lang("listFileRoom"),iconCls:"icon-fileRoom-list",enableToggle:true,toggleGroup:"odoc_files_set_types",cls:"btn-red1",pressed:true,allowDepress:false,handler:function(){b.storeBar.from="room";b.grid.getColumnModel().setColumnHeader(3,lang("fileRoomName"));b.grid.getColumnModel().setColumnHeader(4,lang("order"));b.store.load({params:b.storeBar})}},{text:lang("directory"),iconCls:"icon-file-directory",cls:"btn-blue3",enableToggle:true,toggleGroup:"odoc_files_set_types",allowDepress:false,handler:function(){b.storeBar.from="type";b.grid.getColumnModel().setColumnHeader(3,lang("nameProject"));b.grid.getColumnModel().setColumnHeader(4,lang("order"));b.store.load({params:b.storeBar})}},{text:lang("wenType"),iconCls:"icon-wenType",cls:"btn-blue3",enableToggle:true,toggleGroup:"odoc_files_set_types",allowDepress:false,handler:function(){b.storeBar.from="wenzhong";b.grid.getColumnModel().setColumnHeader(3,lang("languageName1"));b.grid.getColumnModel().setColumnHeader(4,lang("order"));b.store.load({params:b.storeBar})}},{text:lang("retentionPeriod"),iconCls:"icon-retention-period",cls:"btn-blue3",enableToggle:true,toggleGroup:"odoc_files_set_types",allowDepress:false,handler:function(){b.storeBar.from="savetime";b.grid.getColumnModel().setColumnHeader(3,lang("retentionPeriod"));b.grid.getColumnModel().setColumnHeader(4,lang("order"));b.store.load({params:b.storeBar})}}]})},submit:function(a){var b=this;Ext.Ajax.request({url:b.baseUrl+"&task=add",params:a,method:"POST",success:function(e,d){var c=Ext.decode(e.responseText);if(c.success===true){b.store.reload()}else{CNOA.msg.alert(c.msg,function(){b.store.reload()})}},failure:function(c,d){CNOA.msg.alert(result.msg,function(){b.store.reload()})}})},deleteData:function(a){var b=this;Ext.Ajax.request({url:b.baseUrl+"&task=delete",params:{ids:a,from:b.storeBar.from},method:"POST",success:function(e,d){var c=Ext.decode(e.responseText);if(c.success===true){b.store.reload()}else{CNOA.msg.alert(c.msg,function(){b.store.reload()})}},failure:function(c,d){CNOA.msg.alert(result.msg,function(){b.store.reload()})}})}};var CNOA_odoc_read_file,CNOA_odoc_read_fileClass;CNOA_odoc_read_fileClass=CNOA.Class.create();CNOA_odoc_read_fileClass.prototype={init:function(){var f=this;var b=Ext.id();var a=Ext.id();var e=Ext.id();var c=Ext.id();var d=Ext.id();this.baseUrl="index.php?app=odoc&func=read&action=file";this.storeBar={storeType:"waiting",title:"",number:"",type:"",level:"",hurry:""};this.fields=[{name:"id"},{name:"title"},{name:"number"},{name:"type"},{name:"type1"},{name:"level"},{name:"wenzhong"},{name:"danganshi"},{name:"anjuan"},{name:"anjuandate"},{name:"filesnum"},{name:"page"},{name:"reader"},{name:"stime"},{name:"etime"},{name:"fileid"}];this.store=new Ext.data.Store({autoLoad:true,proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getJsonData",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:this.fields}),listeners:{exception:function(m,k,n,j,i,h){var g=Ext.decode(i.responseText);if(g.failure){CNOA.msg.alert(g.msg)}}}});this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:false});this.pagingBar=new Ext.PagingToolbar({displayInfo:true,emptyMsg:lang("pagingToolbarEmptyMsg"),displayMsg:lang("showDataTotal2"),store:this.store,pageSize:15,listeners:{beforechange:function(g,h){Ext.apply(h,f.storeBar)}}});this.colModel=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),this.sm,{header:"id",dataIndex:"id",hidden:true},{header:lang("type"),dataIndex:"type",width:80,sortable:true,menuDisabled:true},{header:lang("startTime"),dataIndex:"stime",width:100,sortable:true,menuDisabled:true},{header:lang("endTime"),dataIndex:"etime",width:100,sortable:true,menuDisabled:true},{header:lang("fileRoom"),dataIndex:"danganshi",width:100,sortable:true,menuDisabled:true},{header:lang("docket"),dataIndex:"anjuan",width:80,sortable:true,menuDisabled:true},{header:lang("fileTitle"),dataIndex:"title",width:120,sortable:true,menuDisabled:true},{header:lang("wenType"),dataIndex:"wenzhong",width:80,sortable:true,menuDisabled:true},{header:lang("opt"),dataIndex:"fileid",width:120,sortable:true,menuDisabled:true,renderer:this.operate.createDelegate(this)},{header:"",dataIndex:"noIndex",width:1,menuDisabled:true,resizable:false}]);this.grid=new Ext.grid.GridPanel({stripeRows:true,region:"center",border:false,store:this.store,loadMask:{msg:lang("loading")},cm:this.colModel,sm:this.sm,hideBorders:true,tbar:[{text:lang("refresh"),iconCls:"icon-system-refresh",handler:function(g,h){f.store.reload()}},{handler:function(g,h){f.storeBar.storeType="waiting";f.store.load({params:f.storeBar})}.createDelegate(this),iconCls:"icon-roduction",enableToggle:true,pressed:true,allowDepress:false,toggleGroup:"meeting_room_check",tooltip:lang("displayDocRead"),text:lang("waitRead")},{handler:function(g,h){f.storeBar.storeType="readed";f.store.load({params:f.storeBar})}.createDelegate(this),iconCls:"icon-roduction",enableToggle:true,allowDepress:false,toggleGroup:"meeting_room_check",tooltip:lang("displayHasBeenRead"),text:lang("haveRead")},"->",{xtype:"cnoa_helpBtn",helpid:4002}],bbar:this.pagingBar});this.mainPanel=new Ext.Panel({collapsible:false,hideBorders:true,border:false,layout:"border",autoScroll:false,items:[this.grid],tbar:[lang("title")+": ",{xtype:"textfield",width:100,id:b},lang("wenhao")+": ",{xtype:"textfield",width:100,id:a},lang("type")+": ",new Ext.form.ComboBox({name:"title",store:f.typeListStore,width:100,id:e,hiddenName:"tid",valueField:"tid",displayField:"title",mode:"local",triggerAction:"all",forceSelection:true,editable:false}),lang("encryptionLevel")+": ",new Ext.form.ComboBox({name:"title",store:f.levelListStore,width:100,id:c,hiddenName:"tid",valueField:"tid",displayField:"title",mode:"local",triggerAction:"all",forceSelection:true,editable:false}),lang("preOther")+": ",new Ext.form.ComboBox({name:"title",store:f.hurryListStore,width:100,id:d,hiddenName:"tid",valueField:"tid",displayField:"title",mode:"local",triggerAction:"all",forceSelection:true,editable:false}),{xtype:"button",text:lang("search"),style:"margin-left:5px",handler:function(){f.storeBar.title=Ext.getCmp(b).getValue();f.storeBar.number=Ext.getCmp(a).getValue();f.storeBar.type=Ext.getCmp(e).getValue();f.storeBar.level=Ext.getCmp(c).getValue();f.storeBar.hurry=Ext.getCmp(d).getValue();f.store.load({params:f.storeBar})}},{xtype:"button",text:lang("clear"),handler:function(){Ext.getCmp(b).setValue("");Ext.getCmp(a).setValue("");Ext.getCmp(e).setValue("");Ext.getCmp(c).setValue("");Ext.getCmp(d).setValue("");f.storeBar.title="";f.storeBar.number="";f.storeBar.type="";f.storeBar.level="";f.storeBar.hurry="";f.store.load({params:f.storeBar})}}]})},operate:function(d,f,a){var e=this;var b=a.data;return"<a href='javascript:void(0)' class='gridview' onclick='CNOA_odoc_read_file.viewFlow("+d+","+b.id+")'>"+lang("read")+"</a>"},viewFlow:function(a,b){mainPanel.closeTab("CNOA_MENU_WF_USE_OPENFLOW");mainPanel.loadClass(this.baseUrl+"&task=loadpage&from=viewflow&fileid="+a+"&id="+b,"CNOA_MENU_WF_USE_OPENFLOW",lang("viewFlow"),"icon-flow")}};var CNOA_odoc_read_receive,CNOA_odoc_read_receiveClass;CNOA_odoc_read_receiveClass=CNOA.Class.create();CNOA_odoc_read_receiveClass.prototype={init:function(){var a=this;this.baseUrl="index.php?app=odoc&func=read&action=receive";Ext.Ajax.request({url:a.baseUrl+"&task=loadColumn",method:"POST",success:function(c){var b=Ext.decode(c.responseText);if(b.success===true){a.layoutPanel(b)}else{CNOA.msg.alert(b.msg,function(){})}}})},layoutPanel:function(b){var d=this;this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:true});this.cm=[new Ext.grid.RowNumberer(),this.sm,{header:lang("opt"),sortable:true,dataIndex:"id",width:55,menuDisabled:true,renderer:function(f,h,e){var g=e.data;l='<a href="javascript:void(0)" class="gridview" onclick="CNOA_odoc_read_receive.viewAttach('+f+')">'+lang("view")+"</a>";return l}},{header:lang("addTime"),sortable:true,dataIndex:"posttime",width:110,menuDisabled:true},{header:lang("agency"),sortable:true,dataIndex:"deptment",width:100,menuDisabled:true},{header:lang("title1"),sortable:true,dataIndex:"title",width:100,menuDisabled:true}];var a=[{name:"id"},{name:"posttime"},{name:"status"},{name:"uFlowId"},{name:"deptment"},{name:"title"}];Ext.each(b.column,function(e,f){a.push({name:"field_"+e.field});d.cm.push({header:e.title,sortable:true,dataIndex:"field_"+e.field,width:e.width,menuDisabled:true})});this.store=new Ext.data.Store({autoLoad:true,proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getJsonList"}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:a})});this.grid=new Ext.grid.GridPanel({store:this.store,width:600,plain:false,stripeRows:true,loadMask:{msg:lang("waiting")},region:"center",border:false,autoScroll:true,sm:this.sm,columns:this.cm,tbar:[{handler:function(e,f){d.store.reload()}.createDelegate(this),iconCls:"icon-system-refresh",text:lang("refresh")},"<span class='cnoa_color_gray'>"+lang("doubleClickEdit")+"</span>"],bbar:new Ext.PagingToolbar({displayInfo:true,store:this.store,pageSize:30})});this.treeStore=new Ext.data.Store({autoLoad:true,proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getSearchList",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:[{name:"field"},{name:"title"}]})});this.searchPanel=new Ext.form.FormPanel({region:"north",height:100,border:false,hidden:true,defaults:{border:false},padding:5,items:[{xtype:"panel",defaults:{border:false},items:[{xtype:"hidden",name:"id"},{xtype:"panel",layout:"table",layoutConfig:{columns:6},defaults:{style:"margin-left:5px;"},height:30,items:[new Ext.form.ComboBox({store:d.treeStore,name:"kong1",hiddenName:"kong1",valueField:"field",displayField:"title",mode:"local",width:150,triggerAction:"all",forceSelection:true,editable:false,listeners:{select:function(g,e,f){}}}),new Ext.form.ComboBox({store:new Ext.data.SimpleStore({fields:["value","name"],data:[["equal",lang("equal")],["noEqual",lang("notEqual")],["contain",lang("contains")],["dayu",lang("greaterThan")],["xiaoyu",lang("lessThan")],["dayuEqual",lang("greaterOrEqual")],["xiaoyuEqual",lang("lessOrEqual")]]}),width:100,value:"equal",valueField:"value",displayField:"name",name:"condition1",hiddenName:"condition1",mode:"local",triggerAction:"all",forceSelection:true,editable:false}),{xtype:"textfield",width:200,name:"value1"},{xtype:"button",text:lang("reset"),handler:function(){c.findField("kong1").setValue("");c.findField("condition1").setValue("equal");c.findField("value1").setValue("")}}]},{xtype:"panel",layout:"table",layoutConfig:{columns:4},defaults:{style:"margin-left:5px;"},height:30,items:[new Ext.form.ComboBox({store:d.treeStore,name:"kong2",hiddenName:"kong2",valueField:"field",displayField:"title",mode:"local",width:150,triggerAction:"all",forceSelection:true,editable:false,listeners:{select:function(g,e,f){}}}),new Ext.form.ComboBox({store:new Ext.data.SimpleStore({fields:["value","name"],data:[["equal",lang("equal")],["noEqual",lang("notEqual")],["contain",lang("contains")],["dayu",lang("greaterThan")],["xiaoyu",lang("lessThan")],["dayuEqual",lang("greaterOrEqual")],["xiaoyuEqual",lang("lessOrEqual")]]}),width:100,value:"equal",valueField:"value",displayField:"name",name:"condition2",hiddenName:"condition2",mode:"local",triggerAction:"all",forceSelection:true,editable:false}),{xtype:"textfield",width:200,name:"value2"},{xtype:"button",text:lang("reset"),handler:function(){c.findField("kong2").setValue("");c.findField("condition2").setValue("equal");c.findField("value2").setValue("")}}]},{xtype:"panel",layout:"table",layoutConfig:{columns:4},defaults:{style:"margin-left:5px;"},height:30,items:[new Ext.form.ComboBox({store:d.treeStore,name:"kong3",hiddenName:"kong3",valueField:"field",displayField:"title",mode:"local",width:150,triggerAction:"all",forceSelection:true,editable:false,listeners:{select:function(g,e,f){}}}),new Ext.form.ComboBox({store:new Ext.data.SimpleStore({fields:["value","name"],data:[["equal",lang("equal")],["noEqual",lang("notEqual")],["contain",lang("contains")],["dayu",lang("greaterThan")],["xiaoyu",lang("lessThan")],["dayuEqual",lang("greaterOrEqual")],["xiaoyuEqual",lang("lessOrEqual")]]}),width:100,value:"equal",valueField:"value",displayField:"name",name:"condition3",hiddenName:"condition3",mode:"local",triggerAction:"all",forceSelection:true,editable:false}),{xtype:"textfield",width:200,name:"value3"},{xtype:"button",text:lang("reset"),handler:function(){c.findField("kong3").setValue("");c.findField("condition3").setValue("equal");c.findField("value3").setValue("")}}]}]}]});var c=d.searchPanel.getForm();this.mainPanel=new Ext.Panel({collapsible:false,hideBorders:true,border:false,layout:"border",autoScroll:false,items:[this.searchPanel,this.grid]});Ext.getCmp(CNOA.odoc.read.receive.parentID).add(this.mainPanel);Ext.getCmp(CNOA.odoc.read.receive.parentID).doLayout()},viewAttach:function(g){var f=this;var a=Ext.id();var b=Ext.id();var e=Ext.id();var c=function(){Ext.Ajax.request({url:f.baseUrl+"&task=loadAttachList",method:"POST",params:{id:g},success:function(i){var h=Ext.decode(i.responseText);if(h.success===true){if(h.data.word){Ext.getCmp(a).show();Ext.getCmp(a).body.update(h.data.word)}if(h.data.attach){Ext.getCmp(b).show();Ext.getCmp(b).body.update(h.data.attach)}if(h.data.form){Ext.getCmp(e).show();Ext.getCmp(e).body.update(h.data.form)}}else{}}})};var d=new Ext.Window({title:lang("viewPostContent"),width:800,height:makeWindowHeight(Ext.getBody().getBox().height-40),modal:true,bodyStyle:"background-color:#FFF;padding:10px;",autoScroll:true,maximizable:true,border:false,items:[{xtype:"fieldset",title:lang("fileView"),hidden:true,id:a},{xtype:"fieldset",title:lang("formView"),hidden:true,id:e},{xtype:"fieldset",title:lang("attachmentView"),hidden:true,id:b}],listeners:{afterrender:function(){c()}},buttons:[{text:lang("close"),handler:function(h){d.close()}}]}).show()}};var CNOA_odoc_read_send,CNOA_odoc_read_sendClass;CNOA_odoc_read_sendClass=CNOA.Class.create();CNOA_odoc_read_sendClass.prototype={init:function(){var a=this;this.baseUrl="index.php?app=odoc&func=read&action=send";Ext.Ajax.request({url:a.baseUrl+"&task=loadColumn",method:"POST",success:function(c){var b=Ext.decode(c.responseText);if(b.success===true){a.layoutPanel(b)}else{CNOA.msg.alert(b.msg,function(){})}}})},layoutPanel:function(b){var d=this;this.sm=new Ext.grid.CheckboxSelectionModel({singleSelect:true});this.cm=[new Ext.grid.RowNumberer(),this.sm,{header:lang("opt"),sortable:true,dataIndex:"id",width:55,menuDisabled:true,renderer:function(f,h,e){var g=e.data;l='<a href="javascript:void(0)" class="gridview" onclick="CNOA_odoc_read_send.viewAttach('+f+')">'+lang("view")+"</a>";return l}},{header:lang("addTime"),sortable:true,dataIndex:"posttime",width:110,menuDisabled:true}];var a=[{name:"id"},{name:"posttime"},{name:"status"},{name:"uFlowId"},{name:"activeAccount"}];Ext.each(b.column,function(e,f){a.push({name:"field_"+e.field});d.cm.push({header:e.title,sortable:true,dataIndex:"field_"+e.field,width:e.width,menuDisabled:true})});this.store=new Ext.data.Store({autoLoad:true,proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getJsonList"}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:a})});this.grid=new Ext.grid.GridPanel({store:this.store,width:600,plain:false,stripeRows:true,loadMask:{msg:lang("waiting")},region:"center",border:false,autoScroll:true,sm:this.sm,columns:this.cm,tbar:[{handler:function(e,f){d.store.reload()}.createDelegate(this),iconCls:"icon-system-refresh",text:lang("refresh")},"<span class='cnoa_color_gray'>"+lang("doubleClickEdit")+"</span>"],bbar:new Ext.PagingToolbar({displayInfo:true,store:this.store,pageSize:30})});this.treeStore=new Ext.data.Store({autoLoad:true,proxy:new Ext.data.HttpProxy({url:this.baseUrl+"&task=getSearchList",disableCaching:true}),reader:new Ext.data.JsonReader({totalProperty:"total",root:"data",fields:[{name:"field"},{name:"title"}]})});this.searchPanel=new Ext.form.FormPanel({region:"north",height:100,border:false,hidden:true,defaults:{border:false},padding:5,items:[{xtype:"panel",defaults:{border:false},items:[{xtype:"hidden",name:"id"},{xtype:"panel",layout:"table",layoutConfig:{columns:6},defaults:{style:"margin-left:5px;"},height:30,items:[new Ext.form.ComboBox({store:d.treeStore,name:"kong1",hiddenName:"kong1",valueField:"field",displayField:"title",mode:"local",width:150,triggerAction:"all",forceSelection:true,editable:false,listeners:{select:function(g,e,f){}}}),new Ext.form.ComboBox({store:new Ext.data.SimpleStore({fields:["value","name"],data:[["equal",lang("equal")],["noEqual",lang("notEqual")],["contain",lang("contains")],["dayu",lang("greaterThan")],["xiaoyu",lang("lessThan")],["dayuEqual",lang("greaterOrEqual")],["xiaoyuEqual",lang("lessOrEqual")]]}),width:100,value:"equal",valueField:"value",displayField:"name",name:"condition1",hiddenName:"condition1",mode:"local",triggerAction:"all",forceSelection:true,editable:false}),{xtype:"textfield",width:200,name:"value1"},{xtype:"button",text:lang("reset"),handler:function(){c.findField("kong1").setValue("");c.findField("condition1").setValue("equal");c.findField("value1").setValue("")}}]},{xtype:"panel",layout:"table",layoutConfig:{columns:4},defaults:{style:"margin-left:5px;"},height:30,items:[new Ext.form.ComboBox({store:d.treeStore,name:"kong2",hiddenName:"kong2",valueField:"field",displayField:"title",mode:"local",width:150,triggerAction:"all",forceSelection:true,editable:false,listeners:{select:function(g,e,f){}}}),new Ext.form.ComboBox({store:new Ext.data.SimpleStore({fields:["value","name"],data:[["equal",lang("equal")],["noEqual",lang("notEqual")],["contain",lang("contains")],["dayu",lang("greaterThan")],["xiaoyu",lang("lessThan")],["dayuEqual",lang("greaterOrEqual")],["xiaoyuEqual",lang("lessOrEqual")]]}),width:100,value:"equal",valueField:"value",displayField:"name",name:"condition2",hiddenName:"condition2",mode:"local",triggerAction:"all",forceSelection:true,editable:false}),{xtype:"textfield",width:200,name:"value2"},{xtype:"button",text:lang("reset"),handler:function(){c.findField("kong2").setValue("");c.findField("condition2").setValue("equal");c.findField("value2").setValue("")}}]},{xtype:"panel",layout:"table",layoutConfig:{columns:4},defaults:{style:"margin-left:5px;"},height:30,items:[new Ext.form.ComboBox({store:d.treeStore,name:"kong3",hiddenName:"kong3",valueField:"field",displayField:"title",mode:"local",width:150,triggerAction:"all",forceSelection:true,editable:false}),new Ext.form.ComboBox({store:new Ext.data.SimpleStore({fields:["value","name"],data:[["equal",lang("equal")],["noEqual",lang("notEqual")],["contain",lang("contains")],["dayu",lang("greaterThan")],["xiaoyu",lang("lessThan")],["dayuEqual",lang("greaterOrEqual")],["xiaoyuEqual",lang("lessOrEqual")]]}),width:100,value:"equal",valueField:"value",displayField:"name",name:"condition3",hiddenName:"condition3",mode:"local",triggerAction:"all",forceSelection:true,editable:false}),{xtype:"textfield",width:200,name:"value3"},{xtype:"button",text:lang("reset"),handler:function(){c.findField("kong3").setValue("");c.findField("condition3").setValue("equal");c.findField("value3").setValue("")}}]}]}]});var c=d.searchPanel.getForm();this.mainPanel=new Ext.Panel({collapsible:false,hideBorders:true,border:false,layout:"border",autoScroll:false,items:[this.searchPanel,this.grid]});Ext.getCmp(CNOA.odoc.read.send.parentID).add(this.mainPanel);Ext.getCmp(CNOA.odoc.read.send.parentID).doLayout()},viewAttach:function(g){var f=this;var a=Ext.id();var b=Ext.id();var e=Ext.id();var c=function(){Ext.Ajax.request({url:f.baseUrl+"&task=loadAttachList",method:"POST",params:{id:g},success:function(i){var h=Ext.decode(i.responseText);if(h.success===true){if(h.data.word){Ext.getCmp(a).show();Ext.getCmp(a).body.update(h.data.word)}if(h.data.attach){Ext.getCmp(b).show();Ext.getCmp(b).body.update(h.data.attach)}if(h.data.form){Ext.getCmp(e).show();Ext.getCmp(e).body.update(h.data.form)}}else{}}})};var d=new Ext.Window({title:lang("viewPostContent"),width:800,height:makeWindowHeight(Ext.getBody().getBox().height-40),modal:true,bodyStyle:"background-color:#FFF;padding:10px;",autoScroll:true,maximizable:true,border:false,items:[{xtype:"fieldset",title:lang("fileView"),id:a},{xtype:"fieldset",title:lang("formView"),id:e},{xtype:"fieldset",title:lang("attachmentView"),id:b}],listeners:{afterrender:function(){c()}},buttons:[{text:lang("close"),handler:function(h){d.close()}}]}).show()}};var sm_odoc_odoc=1;