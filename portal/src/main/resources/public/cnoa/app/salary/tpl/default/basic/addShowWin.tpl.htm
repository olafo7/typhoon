<!DOCTYPE html>
<html>

<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="cache-control" content="no-cache">
<meta http-equiv="expires" content="0">
<link rel="shortcut icon" href="/static/favicon.ico" type="image/x-icon">
<meta http-equiv="X-UA-Compatible" content="IE=8">
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8">
<link rel="stylesheet" type="text/css" href="/cnoa/extjs/3.4.0/resources/css/ext-all.css?v=v 3.0.39">
<link rel="stylesheet" type="text/css" href="/cnoa/resources/css/cnoa.all.css?v=v 3.0.39">
<script type="text/javascript" src="/cnoa/scripts/extjs.3.4.0.js?v=v 3.0.39"></script>
<script type="text/javascript" src="/cnoa/file/language/cn.js?v=v 3.0.39"></script>
<script type="text/javascript" src="/cnoa/scripts/cnoa.common.js?v=v 3.0.39"></script>
<script type="text/javascript" src="/cnoa/scripts/jquery/1.4.2.min.js?v=v 3.0.39"></script>
<script type="text/javascript" src="/cnoa/scripts/cnoa.extra.js?v=v 3.0.39"></script>

<style type="text/css">
	.table-block{
	   margin-top: 15px;
	   border:1px #cccccc solid;
	   line-height:20px;
	   font-size:9pt;
	   border-collapse:collapse;
	}

	.table-block .table-header td,
	.table-block td.table-header{
	   height:30px;
	   background:#c4de83;
	   border:1px #9cb269 solid;
	   font-weight:bold;
	   color:#383838;
	   line-height:23px;
	   padding:0px;
	   padding-left:5px;
	}

	.table-block .table-data td,
	.table-block td.table-data{
	   background: #FFFFFF;
	   border-bottom: 1px #cccccc solid;
	   border-right: 1px #cccccc solid;
	   padding: 3px;
	   height: 30px;
	}

	.table-block .table-content td,
	.table-block td.table-content{
	   background: #f2f2f2;
	   border-bottom: 1px #cccccc solid;
	   border-right: 1px #cccccc solid;
	   padding: 3px;
	   height: 30px;
	}

	.table-block .table-button td,
	.table-block td.table-button{
	   background: #FFFFFF;
	   border: 1px #cccccc solid;
	   padding: 3px;
	   height: 30px;
	}

	.table-block .table-header td table td,
	.table-block .table-data td table td,
	.table-block .table-left td table td,
	.table-block .table-content td table td,

	.table-block .table-left td,
	.table-block td.table-left{
	   background: #c4de83;
	   border-bottom: 1px #a7bd74 solid;
	   padding: 3px;
	   height: 30px;
	}

	.big-button {
		width: 100px;
		height: 40px;
	}
</style>
</head>
<body>
<table class="table-block" width="80%" align="center" id='submitTable'>
	<tbody>
		<tr>
			<td class="table-content" >名称: <input type="text" id='insureName' name="insureName" value="<?php echo $data['name'] ? $data['name'] : '' ?>">
		</tr>
		<tr>
			<td class="table-content">养老保险：</td>
		</tr>
		<tr>
			<td class="table-data" style="padding-left:10px;">
				个人支付：
				<input type="text" name="yanglao_p_pay_m" onblur="checkAddMoney(this)" value="<?php echo $data['yanglao_p_pay_m'] ? $data['yanglao_p_pay_m'] : '0.00'?>" style="text-align: right;"
				>
			</td>
		</tr>
		<tr>
			<td class="table-data" style="padding-left:10px;">
				单位支付：
				<input type="text" name="yanglao_u_pay_m" onblur="checkAddMoney(this)" value="<?php echo $data['yanglao_u_pay_m'] ? $data['yanglao_u_pay_m'] : '0.00'?>" style="text-align: right;">
			</td>
		</tr>
		<tr>
			<td class="table-content">医疗保险：</td>
		</tr>
		<tr>
			<td class="table-data" style="padding-left:10px;">
				个人支付：
				<input type="text" name="yiliao_p_pay_m" onblur="checkAddMoney(this)" value="<?php echo $data['yiliao_p_pay_m'] ? $data['yiliao_p_pay_m'] : '0.00'?>" style="text-align: right;">
			</td>
		</tr>
		<tr>
			<td class="table-data" style="padding-left:10px;">
				单位支付：
				<input type="text" name="yiliao_u_pay_m" onblur="checkAddMoney(this)" value="<?php echo $data['yiliao_u_pay_m'] ? $data['yiliao_u_pay_m'] : '0.00'?>" style="text-align: right;">
			</td>
		</tr>

		<tr>
			<td class="table-content">重大疾病医疗补助：</td>
		</tr>
		<tr>
			<td class="table-data" style="padding-left:10px;">
				个人支付：
				<input type="text" name="bigYiliao_p_pay_m" onblur="checkAddMoney(this)" value="<?php echo $data['bigYiliao_p_pay_m'] ? $data['bigYiliao_p_pay_m'] : '0.00'?>" style="text-align: right;">
			</td>
		</tr>
		<tr>
			<td class="table-data" style="padding-left:10px;">
				单位支付：
				<input type="text" name="bigYiliao_u_pay_m" onblur="checkAddMoney(this)" value="<?php echo $data['bigYiliao_u_pay_m'] ? $data['bigYiliao_u_pay_m'] : '0.00'?>" style="text-align: right;">
			</td>
		</tr>

		<tr>
			<td class="table-content">失业保险：</td>
		</tr>
		<tr>
			<td class="table-data" style="padding-left:10px;">
				个人支付：
				<input type="text" name="shiye_p_pay_m" onblur="checkAddMoney(this)" value="<?php echo $data['shiye_p_pay_m'] ? $data['shiye_p_pay_m'] : '0.00'?>" style="text-align: right;">
			</td>
		</tr>
		<tr>
			<td class="table-data" style="padding-left:10px;">
				单位支付：
				<input type="text" name="shiye_u_pay_m" onblur="checkAddMoney(this)" value="<?php echo $data['shiye_u_pay_m'] ? $data['shiye_u_pay_m'] : '0.00'?>" style="text-align: right;">
			</td>
		</tr>
		<tr>
			<td class="table-content">工伤保险：</td>
		</tr>
		<tr>
			<td class="table-data" style="padding-left:10px;">
				单位支付：
				<input type="text" name="gshang_u_pay_m" onblur="checkAddMoney(this)" value="<?php echo $data['gshang_u_pay_m'] ? $data['gshang_u_pay_m'] : '0.00'?>" style="text-align: right;">
			</td>
		</tr>
		<tr>
			<td class="table-content">生育保险：</td>
		</tr>
		<tr>
			<td class="table-data" style="padding-left:10px;">
				单位支付：
				<input type="text" name="shengyu_u_pay_m" onblur="checkAddMoney(this)" value="<?php echo $data['shengyu_u_pay_m'] ? $data['shengyu_u_pay_m'] : '0.00'?>" style="text-align: right;">
			</td>
		</tr>
		<tr align="right" class="table-button">
			<td colspan="2">
				<input type="submit" value="保存" name='save' onclick="JavaScript:save(<?php echo $sid;?>)" class="big-button">
			</td>
		</tr>
	</tbody>
</table>
</body>
</html>

<script language="javascript">
	function save(sid){
		var data = {}, name = $('#insureName').val();
		data['sid'] = sid;

		if ( name == null ) {
			alert('名称不能为空');
			return;
		}

		$('#submitTable').find('input').each(function(t,th){
			if (th.name != 'save' && th.name != 'reset') {
				var name = th.name;
				data[name] = th.value;
			}
		})
		
		Ext.Ajax.request({
			url: "index.php?app=salary&func=basic&action=insure&task=addEditInsure",
			params: data,
			success: function(response){
				var responseText = Ext.decode(response.responseText);
				if ( responseText.failure ) {
					alert(responseText.msg);
					return;
				}
				opener.CNOA_salary_basic_insure.store.reload();
				window.close();
			}
		});
	}

	function checkAddMoney(th){
		var value = th.value,
			regex = /^([1-9]\.[0-9]{0,2}$|0\.[0-9]{0,2}$|[1-9][0-9]{1,3}\.[0-9]{0,2}$|10000|0|[1-9][0-9]{1,3}$)$/;
		if (value.match(regex) == null) {
			CNOA.msg.alert('金额必须大于0小于10000且小数点后只保留两位小数,如何疑问请联系相关负责人');
		}
	}
</script>